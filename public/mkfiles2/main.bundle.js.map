{"version":3,"file":"main.bundle.js","mappings":"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","sources":["webpack:///./src/editor-params.ts","webpack:///./src/main.ts","webpack:///./src/mkfinder.ts","webpack:///./src/mkmedia.ts","webpack:///./src/mkquery.ts","webpack:///./src/parser.ts","webpack:///webpack/bootstrap","webpack:///webpack/runtime/chunk loaded","webpack:///webpack/runtime/amd define","webpack:///webpack/runtime/amd options","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/global","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/make namespace object","webpack:///webpack/runtime/node module decorator","webpack:///webpack/runtime/jsonp chunk loading","webpack:///webpack/startup"],"sourcesContent":["export const taskParamSchema = {\n  \"title\": \"MkTurk Task Params\",\n  \"description\": \"Object containing MkTurk task parameters\",\n  \"type\": [\"object\", \"array\"],\n  \"properties\": {\n    \"Agent\": {\n      \"type\": \"string\"\n    },\n    \"CheckRFID\": {\n      \"type\": \"integer\"\n    },\n    \n    \"Automator\": {\n      \"type\": [\n        \"string\",\n        \"integer\"\n      ]\n    },\n    \"AutomatorFilePath\": {\n      \"type\": \"string\",\n      \"examples\": [\n        \"/mkturkfiles/paramterfiles/automators/touch_m2s_objectome.json\"\n      ]\n    },\n    \"CurrentAutomatorStage\": {\n      \"type\": \"integer\"\n    },\n    \"MinPercentCriterion\": {\n      \"type\": \"integer\"\n    },\n    \"MinTrialsCriterion\": {\n      \"type\": \"integer\"\n    },\n\n\n\n    \"DragtoRespond\": {\n      \"type\": \"integer\",\n    },\n    \"CalibrateEye\": {\n      \"type\": \"integer\",\n    },\n    \"NRSVP\": {\n      \"type\": \"integer\",\n    },\n    \"SameDifferent\": {\n      \"type\": \"integer\",\n    },\n    \"SamplingStrategy\": {\n      \"type\": \"string\"\n    },\n    \"NStickyResponse\": {\n      \"type\": \"integer\"\n    },\n    \"NTrialsPerBagBlock\": {\n      \"type\": \"integer\"\n    },\n\n\n    \"NGridPoints\": {\n      \"type\": \"integer\",\n      \"minimum\": 1\n    },\n    \"GridSpacingInches\": {\n      \"type\": \"number\"\n    },\n    \"GridXOffsetInches\": {\n      \"type\": \"number\"\n    },\n    \"GridYOffsetInches\": {\n      \"type\": \"number\"\n    },\n    \"FixationGridIndex\": {\n      \"type\": \"integer\",\n      \"minimum\": -1\n    },\n    \"SampleGridIndex\": {\n      \"type\": \"integer\",\n      \"minimum\": -1\n    },\n    \"ObjectGridIndex\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"integer\",\n        \"minimum\": 0\n      }\n    },\n    \"ChoiceGridIndex\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"integer\",\n        \"minimum\": 0\n      }\n    },\n    \"TestGridIndex\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"integer\",\n        \"minimum\": 0\n      }\n    },\n\n    \n\n    \"NFixations\": {\n      \"type\": \"integer\",\n      \"minimum\": 1\n    },\n    \"FixationUsesSample\": {\n      \"type\": \"integer\",\n    },\n    \"FixationSizeInches\": {\n      \"type\": \"number\"\n    },\n    \"FixationDuration\": {\n      \"type\": \"integer\"\n    },\n    \"FixationTimeOut\": {\n      \"type\": \"integer\"\n    },\n\n\n    \"FixationWindowSizeInches\": {\n      \"type\": \"number\"\n    },\n    \"FixationDotSizeInches\": {\n      \"type\": \"number\"\n    },\n\n\n    \"ImageBagsSample\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"string\"\n      }\n    },\n    \"KeepSampleON\": {\n      \"type\": \"integer\",\n    },\n    \"SamplePRE\": {\n      \"type\": \"integer\",\n      \"minimum\": 0\n    },\n    \"SampleOFF\": {\n      \"type\": \"integer\",\n      \"minimum\": 0\n    },\n\n    \"ImageBagsTest\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"string\"\n      }\n    },\n    \"KeepTestON\": {\n      \"type\": \"integer\",\n    },\n    \"TestOFF\": {\n      \"type\": \"integer\",\n    },\n    \"HideTestDistractors\": {\n      \"type\": \"integer\",\n    },\n\n    \"ChoiceSizeInches\": {\n      \"type\": \"number\",\n      \"minimum\": 0\n    },\n    \"HideChoiceDistractors\": {\n      \"type\": \"integer\",\n    },\n    \"ChoiceTimeOut\": {\n      \"type\": \"integer\",\n      \"minimum\": 0\n    },\n\n\n    \"RewardStage\": {\n      \"type\": \"integer\",\n    },\n    \"RewardPer1000Trials\": {\n      \"type\": \"integer\",\n    },\n    \"NRewardMax\": {\n      \"type\": \"integer\",\n    },\n    \"NConsecutiveHitsforBonus\": {\n      \"type\": \"integer\",\n    },\n    \"PunishTimeOut\": {\n      \"type\": \"integer\",\n      \"minimum\": 0\n    },\n    \"ConsecutiveHitsITI\": {\n      \"type\": \"integer\",\n      \"minimum\": 0\n    },\n\n\n\n\n\n    \"InterTrialInterval\": {\n      \"type\": \"integer\",\n      \"minimum\": 0\n    },\n    \"BackgroundColor2D\": {\n      \"type\": \"string\",\n    },\n    \"Homecage\": {\n      \"type\": \"integer\",\n    },\n    \"Separated\": {\n      \"type\": \"integer\",\n    },\n    \"Species\": {\n      \"type\": \"string\",\n      \"examples\": [\n        \"human\",\n        \"marmoset\",\n        \"model\"\n      ],\n    },\n    \"Liquid\": {\n      \"type\": \"integer\",\n    },\n  }\n};","import { initializeApp } from \"firebase/app\";\nimport { getFirestore, doc, collection, Query } from \"firebase/firestore\";\nimport { getStorage, StorageReference, ref } from \"firebase/storage\";\nimport { getAuth, GoogleAuthProvider, getRedirectResult, signInWithRedirect } from \"firebase/auth\";\nimport { getFunctions, httpsCallable } from \"firebase/functions\";\nimport './mkfiles.css';\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyA0fbv2VqE-AfF6V_nxSSXCEqaTlBlZnTI\",\n  authDomain: \"sandbox-ce2c5.firebaseapp.com\",\n  databaseURL: \"https://sandbox-ce2c5.firebaseio.com\",\n  projectId: \"sandbox-ce2c5\",\n  storageBucket: \"sandbox-ce2c5.appspot.com\",\n  messagingSenderId: \"1003719887944\"\n};\nlet firebaseApp = initializeApp(firebaseConfig);\n\nimport { Mkquery } from \"./mkquery\";\nimport { Mkfinder } from \"./mkfinder\";\n\nconst auth = getAuth(firebaseApp);\n\nconst provider = new GoogleAuthProvider();\nprovider.addScope(\"https://www.googleapis.com/auth/contacts.readonly\");\ngetRedirectResult(auth).then(result => {\n  if (result) {\n    console.log(\"Sign-In Redirect Result, USER:\", result.user.email, \"is signed in\");\n  } else if (auth.currentUser) {\n    console.log(\"Sign-In Redirect Result, USER:\", \"is signed in\");\n  } else {\n    signInWithRedirect(auth, provider)\n  }\n});\n\n\nconst functions = getFunctions(firebaseApp);\nconst db = getFirestore(firebaseApp);\nconst storage = getStorage(firebaseApp);\nconst storageRef = ref(storage); \nconst rootRef = ref(storageRef, 'mkturkfiles');\nlet isRoot = true;\n\nlet mkq = new Mkquery();\nlet mkf = new Mkfinder();\n\nlet bqListDatasets = httpsCallable(functions, 'bqListDatasets');\n\nlet bqDatasetList = bqListDatasets();\nbqDatasetList.then((datasetList: any) => {\n  let bqOptgroup = \n    document.querySelector('#bigquery-optgroup') as HTMLOptGroupElement;\n  datasetList.data.forEach((dataset: any) => {\n    let option = document.createElement('option');\n    option.value = dataset;\n    option.textContent = 'bq/' + dataset;\n    bqOptgroup.appendChild(option);\n  });\n});\n\n\nlet rfidToggle = document.querySelector(\"#rfid-switch\") as HTMLInputElement;\nlet qryLocSelc = document.querySelector(\"#qry-loc-selector\") as HTMLSelectElement;\nlet fieldSelector =\n    document.querySelector(\"#field-selector\") as HTMLSelectElement;\n\n\n/* Quick Links */\nlet homeLink\n  = document.querySelector('#quick-link-home') as HTMLElement;\nlet paramsLink =\n    document.querySelector(\"#quick-link-params\") as HTMLElement;\nlet paramstorageLink\n  = document.querySelector('#quick-link-paramstorage') as HTMLElement;\nlet sceneParamsLink =\n    document.querySelector(\"#quick-link-sceneparams\") as HTMLElement;\nlet dailyDataLink = \n  document.querySelector('#quick-link-dailydata') as HTMLElement;\nlet marmosetsLink = \n    document.querySelector(\"#quick-link-marmosets\") as HTMLElement;\n\n\nwindow.addEventListener('load', (evt: Event) => {\n  evt.preventDefault();\n\n  isRoot = false;\n  qryLocSelc.value = \"mkturkfiles\";\n  qryLocSelc.dispatchEvent(new Event(\"change\"));\n  mkf.listStorageFiles(rootRef);\n});\n\n\nmarmosetsLink.addEventListener(\"click\", (ev: Event) => {\n  ev.preventDefault();\n\n  qryLocSelc.value = \"marmosets\";\n  fieldSelector!.value = \"name\";\n  qryLocSelc!.dispatchEvent(new Event(\"change\"));\n  fieldSelector!.dispatchEvent(new Event(\"change\"));\n\n  let ret = mkq.decodeQuery(collection(db, \"marmosets\"));\n  ret.then(docs => {\n    mkf.listFirestoreDocs(docs, \"marmosets\");\n  });\n\n});\n\nparamsLink.addEventListener(\"click\" || \"pointerup\", (ev: Event) => {\n  ev.preventDefault();\n\n  isRoot = false;\n  qryLocSelc.value = \"mkturkfiles\";\n  qryLocSelc.dispatchEvent(new Event(\"change\"));\n  mkf.listStorageFiles(ref(storageRef, 'mkturkfiles/parameterfiles/subjects'));\n\n});\n\nparamstorageLink.addEventListener('click' || 'pointerup', (ev: Event) => {\n  ev.preventDefault();\n\n  isRoot = false;\n  qryLocSelc.value = 'mkturkfiles';\n  qryLocSelc.dispatchEvent(new Event('change'));\n  mkf.listStorageFiles(ref(storageRef, 'mkturkfiles/parameterfiles/params_storage'));\n});\n\nhomeLink.addEventListener(\"click\" || \"pointerup\", (ev: Event) => {\n  ev.preventDefault();\n\n  isRoot = false;\n  qryLocSelc.value = \"mkturkfiles\";\n  qryLocSelc.dispatchEvent(new Event(\"change\"));\n  // mkf.listStorageFiles(storageRef.child(\"mkturkfiles\"));\n  mkf.listStorageFiles(rootRef);\n\n});\n\nsceneParamsLink.addEventListener(\"click\" || \"pointerup\", (ev: Event) => {\n  ev.preventDefault();\n\n  isRoot = false;\n  qryLocSelc.value = \"mkturkfiles\";\n  qryLocSelc.dispatchEvent(new Event(\"change\"));\n  // mkf.listStorageFiles(storageRef.child(\"mkturkfiles/scenebags/objectome3d\"));\n  mkf.listStorageFiles(ref(rootRef, 'scenebags/objectome3d'));\n\n});\n\ndailyDataLink.addEventListener('click' || 'pointerup', (ev: Event) => {\n  ev.preventDefault();\n  isRoot = false;\n  qryLocSelc.value = \"mkturkfiles\";\n  qryLocSelc.dispatchEvent(new Event('change'));\n  // mkf.listStorageFiles(storageRef.child('mkturkfiles/mkdailydata'));\n  mkf.listStorageFiles(ref(rootRef, 'mkdailydata'));\n});\n\nqryLocSelc!.addEventListener(\"change\", ev => {\n\n  let fs = document.querySelector(\"#field-selector\") as HTMLSelectElement;\n  let ki0 = document.querySelector(\"#keyword-input-0\") as HTMLInputElement;\n  let ki1 = document.querySelector(\"#keyword-input-1\") as HTMLInputElement;\n  let ki2 = document.querySelector(\"#keyword-input-2\") as HTMLInputElement;\n  let goBtn = document.querySelector(\"#go-btn\") as HTMLButtonElement;\n  let plotX = document.querySelector(\"#quick-plot-x\") as HTMLSelectElement;\n  let plotY = document.querySelector(\"#quick-plot-y\") as HTMLSelectElement;\n  let plotBtn = document.querySelector(\"#plot-btn\") as HTMLButtonElement;\n  let queryResult: Promise<any[]>;\n  \n  switch(qryLocSelc.value) {\n    case \"marmosets\":\n      \n      fs.style.visibility = \"visible\";\n      ki0.style.visibility = \"visible\";\n      ki1.style.visibility = \"hidden\";\n      ki2.style.visibility = \"hidden\";\n      goBtn.style.visibility = \"visible\";\n\n      resetPlaceholder();\n      removeElementsByClassName(\"field-options\");\n\n      let nameMarmosets = document.createElement(\"option\");\n      nameMarmosets.setAttribute(\"class\", \"field-options\");\n      nameMarmosets.setAttribute(\"value\", \"name\");\n      nameMarmosets.setAttribute(\"selected\", \"true\");\n      nameMarmosets.textContent = \"name\";\n\n      let sexMarmosets = document.createElement(\"option\");\n      sexMarmosets.setAttribute(\"class\", \"field-options\");\n      sexMarmosets.setAttribute(\"value\", \"sex\");\n      sexMarmosets.textContent = \"sex\";\n\n      let rfidMarmosets = document.createElement(\"option\");\n      rfidMarmosets.setAttribute(\"class\", \"field-options\");\n      rfidMarmosets.setAttribute(\"value\", \"rfid\");\n      rfidMarmosets.textContent = \"RFID\";\n\n      let breedingMarmosets = document.createElement(\"option\");\n      breedingMarmosets.setAttribute(\"class\", \"field-options\");\n      breedingMarmosets.setAttribute(\"value\", \"breeding\");\n      breedingMarmosets.textContent = \"breeding\";\n\n      let birthdateMarmosets = document.createElement(\"option\");\n      birthdateMarmosets.setAttribute(\"class\", \"field-options\");\n      birthdateMarmosets.setAttribute(\"value\", \"birthdate\");\n      birthdateMarmosets.textContent = \"birthdate\";\n\n      let fieldSelectorMarmosets\n        = document.querySelector(\"#field-selector\") as HTMLSelectElement;\n      fieldSelectorMarmosets.appendChild(nameMarmosets);\n      fieldSelectorMarmosets.appendChild(sexMarmosets);\n      fieldSelectorMarmosets.appendChild(rfidMarmosets);\n      fieldSelectorMarmosets.appendChild(breedingMarmosets);\n      fieldSelectorMarmosets.appendChild(birthdateMarmosets);\n      fieldSelectorMarmosets.dispatchEvent(new Event(\"change\"));\n  \n      break;\n\n    case \"mkturkdata\":\n      fs.style.visibility = \"visible\";\n      ki0.style.visibility = \"visible\";\n      ki1.style.visibility = \"visible\";\n      ki2.style.visibility = \"visible\";\n      goBtn.style.visibility = \"visible\";\n      plotX.style.visibility = \"hidden\";\n      plotY.style.visibility = \"hidden\";\n      plotBtn.style.visibility = \"hidden\";\n\n      resetPlaceholder();\n      removeElementsByClassName(\"field-options\");\n\n      let agentTypeCurDate = document.createElement(\"option\");\n      agentTypeCurDate.setAttribute(\"class\", \"field-options\");\n      agentTypeCurDate.setAttribute(\"value\", \"agentTypeCurDate\");\n      agentTypeCurDate.setAttribute(\"selected\", \"true\");\n      agentTypeCurDate.textContent = \"Agent & Doctype & CurrentDate\";\n\n      let fieldSelectorMkturk \n        = document.querySelector(\"#field-selector\") as HTMLSelectElement;\n      fieldSelectorMkturk.appendChild(agentTypeCurDate);\n      fieldSelectorMkturk.dispatchEvent(new Event(\"change\"));\n\n      break;\n\n    case \"objects\":\n      fs.style.visibility = \"visible\";\n      ki0.style.visibility = \"visible\";\n      ki1.style.visibility = \"hidden\";\n      ki2.style.visibility = \"hidden\";\n      goBtn.style.visibility = \"visible\";\n      plotX.style.visibility = \"hidden\";\n      plotY.style.visibility = \"hidden\";\n      plotBtn.style.visibility = \"hidden\";\n\n      resetPlaceholder();\n      removeElementsByClassName(\"field-options\");\n\n      let identityObjects = document.createElement(\"option\");\n      identityObjects.setAttribute(\"class\", \"field-options\");\n      identityObjects.setAttribute(\"value\", \"identity\");\n      identityObjects.setAttribute(\"selected\", \"true\");\n      identityObjects.textContent = \"identity\";\n\n      let meshObjects = document.createElement(\"option\");\n      meshObjects.setAttribute(\"class\", \"field-options\");\n      meshObjects.setAttribute(\"value\", \"mesh\");\n      meshObjects.textContent = \"mesh\";\n\n      let nounObjects = document.createElement(\"option\");\n      nounObjects.setAttribute(\"class\", \"field-options\");\n      nounObjects.setAttribute(\"value\", \"noun\");\n      nounObjects.textContent = \"noun\";\n\n      let fieldSelectorObjects\n        = document.querySelector(\"#field-selector\") as HTMLSelectElement;\n      fieldSelectorObjects.appendChild(identityObjects);\n      fieldSelectorObjects.appendChild(meshObjects);\n      fieldSelectorObjects.appendChild(nounObjects);\n      fieldSelectorObjects.dispatchEvent(new Event(\"change\"));\n\n      break;\n\n    case \"mkdailydata\":\n      // let ret = mkq.decodeQuery(db.collection('mkdailydata'));\n      let ret = mkq.decodeQuery(collection(db, 'mkdailydata'));\n      ret.then(docs => {\n        mkf.listFirestoreDocs(docs, 'mkdailydata');\n      });\n\n      break;\n\n    // case \"mkdailydatatest\":\n    //   let retTest = mkq.decodeQuery(db.collection('mkdailydatatest'));\n    //   retTest.then(docs => {\n    //     mkf.listFirestoreDocs(docs, 'mkdailydatatest');\n    //   });\n\n    //   break;\n\n    case \"mkturkfiles\":\n      fs.style.visibility = \"hidden\";\n      ki0.style.visibility = \"hidden\";\n      ki1.style.visibility = \"hidden\";\n      ki2.style.visibility = \"hidden\";\n      goBtn.style.visibility = \"hidden\";\n      plotX.style.visibility = \"hidden\";\n      plotY.style.visibility = \"hidden\";\n      plotBtn.style.visibility = \"hidden\";\n\n      removeElementsByClassName(\"field-options\");\n      if (isRoot) {\n        mkf.listStorageFiles(rootRef);\n      }\n      break;\n\n    case \"devices\":\n      fs.style.visibility = \"hidden\";\n      ki0.style.visibility = \"hidden\";\n      ki1.style.visibility = \"hidden\";\n      ki2.style.visibility = \"hidden\";\n      goBtn.style.visibility = \"hidden\";\n      plotX.style.visibility = \"hidden\";\n      plotY.style.visibility = \"hidden\";\n      plotBtn.style.visibility = \"hidden\";\n\n      resetPlaceholder();\n      removeElementsByClassName(\"field-options\");\n\n      // queryResult = mkq.decodeQuery(db.collection(\"devices\"));\n      queryResult = mkq.decodeQuery(collection(db, 'devices'));\n      queryResult.then(docs => {\n        mkf.listFirestoreDocs(docs, \"devices\");\n      });\n\n      break;\n\n    case \"eyecalibrations\":\n      console.log('eye');\n      fs.style.visibility = \"hidden\";\n      ki0.style.visibility = \"hidden\";\n      ki1.style.visibility = \"hidden\";\n      ki2.style.visibility = \"hidden\";\n      goBtn.style.visibility = \"hidden\";\n      plotX.style.visibility = \"hidden\";\n      plotY.style.visibility = \"hidden\";\n      plotBtn.style.visibility = \"hidden\";\n\n      resetPlaceholder();\n      removeElementsByClassName(\"field-options\");\n\n      // queryResult = mkq.decodeQuery(db.collection(\"eyecalibrations\"));\n      queryResult = mkq.decodeQuery(collection(db, 'eyecalibrations'));\n      queryResult.then(docs => {\n        mkf.listFirestoreDocs(docs, \"eyecalibrations\");\n      });\n\n      break;\n\n    case \"mkscale\":\n      fs.style.visibility = \"visible\";\n      ki0.style.visibility = \"visible\";\n      ki1.style.visibility = \"visible\";\n      ki2.style.visibility = \"hidden\";\n      goBtn.style.visibility = \"visible\";\n      plotX.style.visibility = \"visible\";\n      plotY.style.visibility = \"visible\";\n      plotBtn.style.visibility = \"visible\";\n\n      resetPlaceholder();\n      removeElementsByClassName(\"field-options\");\n\n      let nameCurDate = document.createElement(\"option\");\n      nameCurDate.setAttribute(\"class\", \"field-options\");\n      nameCurDate.setAttribute(\"value\", \"nameCurDate\");\n      nameCurDate.setAttribute(\"selected\", \"true\");\n      nameCurDate.textContent = \"Name & CurrentDate\";\n\n      fs.appendChild(nameCurDate);\n      fs.dispatchEvent(new Event(\"change\"));\n\n      break;\n\n    case \"eyedata\":\n      fs.style.visibility = \"visible\";\n      ki0.style.visibility = \"visible\";\n      ki1.style.visibility = \"visible\";\n      ki2.style.visibility = \"hidden\";\n      goBtn.style.visibility = \"visible\";\n      plotX.style.visibility = \"visible\";\n      plotY.style.visibility = \"visible\";\n      plotBtn.style.visibility = \"visible\";\n\n      resetPlaceholder();\n      removeElementsByClassName(\"field-options\");\n\n      let bqAgentDate = document.createElement(\"option\");\n      bqAgentDate.setAttribute(\"class\", \"field-options\");\n      bqAgentDate.setAttribute(\"value\", \"nameCurDate\");\n      bqAgentDate.setAttribute(\"selected\", \"true\");\n      bqAgentDate.textContent = \"Name & CurrentDate\";\n\n      fs.appendChild(bqAgentDate);\n      fs.dispatchEvent(new Event(\"change\"));\n      break;\n  }\n});\n\n\nfieldSelector?.addEventListener(\"change\", ev => {\n  let field = fieldSelector?.value;\n  let ki0 = document.querySelector(\"#keyword-input-0\") as HTMLInputElement;\n  let ki1 = document.querySelector(\"#keyword-input-1\") as HTMLInputElement;\n  let ki2 = document.querySelector(\"#keyword-input-2\") as HTMLInputElement;\n  let plotX = document.querySelector(\"#quick-plot-x\") as HTMLSelectElement;\n  let plotY = document.querySelector(\"#quick-plot-y\") as HTMLSelectElement;\n  let plotBtn = document.querySelector(\"#plot-btn\") as HTMLButtonElement;\n\n\n  switch (field) {\n    case \"name\":\n      resetPlaceholder();\n      ki0.setAttribute(\"placeholder\", \"name\");\n      plotX.style.visibility = \"visible\";\n      plotY.style.visibility = \"visible\";\n      plotBtn.style.visibility = \"visible\";\n      break;\n\n    case \"sex\":\n      resetPlaceholder();\n      ki0.setAttribute(\"placeholder\", \"sex\");\n      plotX.style.visibility = \"hidden\";\n      plotY.style.visibility = \"hidden\";\n      plotBtn.style.visibility = \"hidden\";\n      break;\n\n    case \"rfid\":\n      resetPlaceholder();\n      ki0.setAttribute(\"placeholder\", \"RFID\");\n      plotX.style.visibility = \"visible\";\n      plotY.style.visibility = \"visible\";\n      plotBtn.style.visibility = \"visible\";\n      break;\n\n    case \"breeding\":\n      resetPlaceholder();\n      ki0.setAttribute(\"placeholder\", \"breeding\");\n      plotX.style.visibility = \"hidden\";\n      plotY.style.visibility = \"hidden\";\n      plotBtn.style.visibility = \"hidden\";\n      break;\n\n    case \"birthdate\":\n      resetPlaceholder();\n      ki0.setAttribute(\n        \"placeholder\", \"birthdate (e.g. 04/17/2019; +-7)\"\n      );\n      plotX.style.visibility = \"hidden\";\n      plotY.style.visibility = \"hidden\";\n      plotBtn.style.visibility = \"hidden\";\n      break;\n\n    case \"agentTypeCurDate\":\n      ki0.setAttribute(\"placeholder\", \"Agent\");\n      ki1.setAttribute(\"placeholder\", \"Doctype\");\n      ki2.setAttribute(\n        \"placeholder\", \"CurrentDate (e.g. 04/17/2019; +-7)\"\n      );\n      plotX.style.visibility = \"hidden\";\n      plotY.style.visibility = \"hidden\";\n      plotBtn.style.visibility = \"hidden\";\n      break;\n\n    case \"nameCurDate\":\n      ki0.setAttribute(\"placeholder\", \"Name\");\n      ki1.setAttribute(\n        \"placeholder\", \"CurrentDate (e.g. 04/17/2019; +-7)\"\n      );\n      break;\n    \n    case \"eyedata\":\n      ki0.setAttribute(\"placeholder\", \"Agent\");\n      ki1.setAttribute(\n        \"Placeholder\", \"Date (e.g. 04/17/2019)\"\n      );\n      break;\n  }\n});\n\nlet queryForm = document.querySelector<HTMLFormElement>(\"#mkquery-form\");\nqueryForm?.addEventListener(\"submit\", async ev => {\n  ev.preventDefault();\n  console.log(\"test weird\");\n  let qryLoc = qryLocSelc?.value;\n  let field = fieldSelector?.value;\n  let k0 = document.querySelector<HTMLInputElement>(\"#keyword-input-0\")?.value;\n  let k1 = document.querySelector<HTMLInputElement>(\"#keyword-input-1\")?.value;\n  let k2 = document.querySelector<HTMLInputElement>(\"#keyword-input-2\")?.value;\n\n  let queryParam: { field: string, keyword: string}[] = [];\n  let queryStr: string = \"\";\n  let query: Query;\n\n\n  switch(qryLoc) {\n    case \"marmosets\":\n      if (k0) {\n        queryParam.push({ field: field, keyword: k0 });\n      } else {\n        console.error(\"No query arguments!\");\n        alert(\"No query arguments!\");\n      }\n      queryStr = \"db.collection('marmosets')\" + mkq.mkquery(queryParam);\n      break;\n\n    case \"mkturkdata\":\n      if (k0) {\n        queryParam.push({ field: \"Agent\", keyword: k0});\n      }\n      if (k1) {\n        queryParam.push({ field: \"Doctype\", keyword: k1 });\n      }\n      if (k2) {\n        queryParam.push({ field: \"CurrentDate\", keyword: k2 });\n      }\n\n      if (queryParam.length > 0) {\n        queryStr = \"db.collection('mkturkdata')\" + mkq.mkquery(queryParam);\n      } else {\n        console.error(\"No query arguments!\");\n        alert(\"No query arguments!\");\n      }\n      break;\n\n    case \"objects\":\n      if (k0) {\n        queryParam.push({ field: field, keyword: k0 });\n      } else {\n        console.error(\"No query arguments!\");\n        alert(\"No query arguments!\");\n      }\n      queryStr = \"db.collection('objects')\" + mkq.mkquery(queryParam);\n      break;\n\n    case \"mkscale\":\n      if (k0) {\n        queryParam.push({ field: \"Name\", keyword: k0 });\n      }\n      if (k1) {\n        queryParam.push({ field: \"CurrentDate\", keyword: k1 });\n      }\n      \n      if (queryParam.length > 0) {\n        queryStr = \"db.collection('mkscale')\" + mkq.mkquery(queryParam);\n      } else {\n        console.error(\"No query arguments!\");\n        alert(\"No query arguments!\");\n      }\n      break;\n\n    case \"eyedata\":\n      if (k0 && k1) {\n        queryStr = mkq.mkbquery(\"eyedata\", k0, k1);\n      } else {\n        console.error(\"Incorrect query: Need two query arguments!\");\n        alert(\"Incorrect query: Need two query arguments!\");\n      }\n      break;\n  }\n  \n\n  if (queryStr.startsWith('db.collection')) {\n    query = eval(queryStr);\n    let ret = mkq.decodeQuery(query);\n    ret.then(docs => {\n      mkf.listFirestoreDocs(docs, qryLoc!);\n      if (rfidToggle.checked) {\n        mkf.finder.selectRow();\n        mkf.mke.displayFirebaseTextFile(mkf.finder.getData()[0], \"marmosets\");\n      }\n    });\n  }\n\n  else if (queryStr.startsWith('SELECT *')) {\n    let test = mkq.decodeBigQuery(queryStr);\n    console.log(test);\n    test.then((data: any) => {\n      if (Array.isArray(data.data)) {\n        mkf.listBigQueryTable(data.data, qryLoc, k0!);\n      }\n      // mkf.listBigQueryTable(data.data, qryLoc, k0!);\n    })\n  }\n  \n});\n\nfunction resetPlaceholder() {\n  let keywordInputs = \n    [...document.querySelectorAll<HTMLInputElement>(\".keyword-input\")];\n\n  for (let i = 0; i < keywordInputs.length; i++) {\n    keywordInputs[i].placeholder = \"\";\n    keywordInputs[i].value = \"\";\n  }\n}\n\nfunction removeElementsByClassName(cName: string) {\n  let elements = document.getElementsByClassName(cName);\n  while (elements.length > 0) {\n    elements[0].parentNode?.removeChild(elements[0]);\n  }\n}","import { getApp } from \"firebase/app\";\nimport { getFirestore, Timestamp } from \"firebase/firestore\";\n// type Timestamp = firebase.firestore.Timestamp;\nimport { Mkeditor, Mkthree, Mkimage, Mkchart } from \"./mkmedia\";\nimport FileSaver from \"file-saver\";\nimport { FirebaseStorage, StorageReference, getStorage, ref, listAll, getDownloadURL, getMetadata } from \"firebase/storage\";\n\nconst db = getFirestore();\n\nexport class Mkfinder {\n  finder: Tabulator;\n  mke: Mkeditor;\n  previousPath: string;\n  storage: FirebaseStorage;\n  storageRef: StorageReference;\n  backBtn: HTMLButtonElement;\n  downloadBtn: HTMLButtonElement;\n  mkt: Mkthree;\n  mki: Mkimage;\n  mkc: Mkchart;\n  numImgSlider: HTMLInputElement;\n  showImagesBtn: HTMLButtonElement;\n  selectedImages: any[];\n  pathName: HTMLParagraphElement;\n\n\n  constructor() {\n    this.finder = new Tabulator(\"#finder\");\n    this.previousPath = \"\";\n    this.storage = getStorage(getApp());\n    this.storageRef = ref(this.storage);\n    this.selectedImages = [];\n\n    this.backBtn = document.querySelector(\"#back-btn\") as HTMLButtonElement;\n    this.showImagesBtn = \n    document.querySelector(\"#show-images-btn\") as HTMLButtonElement;\n    this.numImgSlider = \n    document.querySelector(\"#num-image-slider\") as HTMLInputElement;\n    this.downloadBtn =\n    document.querySelector(\"#download-file\") as HTMLButtonElement;\n    this.pathName = \n    document.querySelector(\"#path-name-span\") as HTMLParagraphElement;\n    \n    this.backBtnAction();\n    this.showImagesBtnAction();\n    this.numImgSliderAction();\n    this.downloadBtnAction();\n    this.refreshStorageTable();\n\n    this.mkt = new Mkthree();\n    this.mki = new Mkimage();\n    this.mke = new Mkeditor();\n    this.mkc = new Mkchart();\n\n\n  }\n\n  public listFirestoreDocs(dataArr: any[], database: string) {\n    this.displayFirestoreTable(dataArr, database);\n  }\n\n  private displayFirestoreTable(dataArr: any[], database: string) {\n    \n    dataArr = this.timestampToDate(dataArr);\n    this.mke.makeActiveBtn.style.display = \"none\";\n    this.mke.storeParamBtn.style.display = 'none';\n    \n\n    if (database == \"marmosets\") {\n      this.finder.destroy();\n      this.pathName.innerText = \"marmosets\";\n      this.finder = new Tabulator(\"#finder\", {\n        data: dataArr,\n        index: \"name\",\n        layout: \"fitColumns\",\n        initialSort: [\n          {column: \"name\", dir: \"asc\"}\n        ],\n        columns: [\n          {title: \"<input id='select-all' type='checkbox'/>\", width: 15, headerSort: false},\n          {title: \"Name\", field: \"name\"},\n          {title: \"Sex\", field: \"sex\"},\n          {title: \"DOB\", field: \"birthdate\"},\n          {title: \"RFID\", field: \"rfid\"},\n        ],\n        selectable: true,\n        selectableRangeMode: \"click\",\n        rowClick: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n          this.mkc.removeElementsByClassName(\"axis-options\");\n          this.mkc.populateAxisFields(row.getData());\n\n        },\n        rowTap: (event, row) => {\n          event.stopPropagation();\n\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n          this.mkc.removeElementsByClassName(\"axis-options\");\n          this.mkc.populateAxisFields(row.getData());\n\n        },\n        tableBuilt: () => {\n          /* selectAllBox function */\n          let selectAllBox \n            = document.querySelector(\"#select-all\") as HTMLInputElement;\n          selectAllBox.addEventListener(\"change\", ev => {\n            if (selectAllBox.checked == true) {\n              this.finder.selectRow();\n            } else {\n              this.finder.deselectRow();\n            }\n          });\n        }\n      });\n    }\n    else if (database == \"mkturkdata\") {\n      this.finder.destroy();\n      this.pathName.innerText = \"mkturkdata\";\n      this.finder = new Tabulator(\"#finder\", {\n        data: dataArr,\n        index: \"index\",\n        layout: \"fitColumns\",\n        initialSort: [\n          {column: \"Agent\", dir: \"asc\"}\n        ],\n        columns: [\n          {title: \"<input id='select-all' type='checkbox'/>\", width: 15, headerSort: false},\n          {title: \"Agent\", field: \"Agent\"},\n          {title: \"Doctype\", field: \"Doctype\"},\n          {title: \"CurrentDate\", field: \"CurrentDate\"},\n          {title: \"FirestoreDocRoot\", field: \"FirestoreDocRoot\", visible: false},\n        ],\n        selectable: true,\n        selectableRangeMode: \"click\",\n        rowClick: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n          \n        },\n        rowTap: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n        },\n        tableBuilt: () => {          \n          /* selectAllBox function */\n          let selectAllBox \n            = document.querySelector(\"#select-all\") as HTMLInputElement;\n          selectAllBox.addEventListener(\"change\", ev => {\n            if (selectAllBox.checked == true) {\n              this.finder.selectRow();\n            } else {\n              this.finder.deselectRow();\n            }\n          });\n        }\n      });\n    }\n\n    else if (database == \"mkdailydata\") {\n      this.finder.destroy();\n      this.pathName.innerText = \"mkdailydata\";\n      this.finder = new Tabulator(\"#finder\", {\n        data: dataArr,\n        index: \"index\",\n        layout: \"fitColumns\",\n        initialSort: [\n          {column: \"agent\", dir: \"asc\"}\n        ],\n        columns: [\n          {title: \"<input id='select-all' type='checkbox'/>\", width: 15, headerSort: false},\n          {title: \"Agent\", field: \"agent\"},\n        ],\n        selectable: true,\n        selectableRangeMode: \"click\",\n        rowClick: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n          \n        },\n        rowTap: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n        },\n        tableBuilt: () => {          \n          /* selectAllBox function */\n          let selectAllBox \n            = document.querySelector(\"#select-all\") as HTMLInputElement;\n          selectAllBox.addEventListener(\"change\", ev => {\n            if (selectAllBox.checked == true) {\n              this.finder.selectRow();\n            } else {\n              this.finder.deselectRow();\n            }\n          });\n        }\n      });\n    }\n\n    else if (database == \"mkdailydatatest\") {\n      this.finder.destroy();\n      this.pathName.innerText = \"mkdailydatatest\";\n      this.finder = new Tabulator(\"#finder\", {\n        data: dataArr,\n        index: \"index\",\n        layout: \"fitColumns\",\n        initialSort: [\n          {column: \"agent\", dir: \"asc\"}\n        ],\n        columns: [\n          {title: \"<input id='select-all' type='checkbox'/>\", width: 15, headerSort: false},\n          {title: \"Agent\", field: \"agent\"},\n        ],\n        selectable: true,\n        selectableRangeMode: \"click\",\n        rowClick: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n          \n        },\n        rowTap: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n        },\n        tableBuilt: () => {          \n          /* selectAllBox function */\n          let selectAllBox \n            = document.querySelector(\"#select-all\") as HTMLInputElement;\n          selectAllBox.addEventListener(\"change\", ev => {\n            if (selectAllBox.checked == true) {\n              this.finder.selectRow();\n            } else {\n              this.finder.deselectRow();\n            }\n          });\n        }\n      });\n    }\n\n    else if (database == \"objects\") {\n      this.finder.destroy();\n      this.pathName.innerText = \"objects\";\n      this.finder = new Tabulator(\"#finder\", {\n        data: dataArr,\n        index: \"docname\",\n        layout: \"fitColumns\",\n        initialSort: [\n          {column: \"identity\", dir: \"asc\"}\n        ],\n        columns: [\n          {title: \"<input id='select-all' type='checkbox'/>\", width: 15, headerSort: false},\n          {title: \"Identity\", field: \"identity\"},\n          {title: \"Mesh\", field: \"mesh\"},\n          {title: \"Noun\", field: \"noun\"},\n          {title: \"Meshfile\", field: \"meshfile\"},\n          {title: \"MeshfilePath\", field: \"meshfilepath\"},\n        ],\n        selectable: true,\n        selectableRangeMode: \"click\",\n        rowClick: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n          \n        },\n        rowTap: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n        },\n        tableBuilt: () => {          \n          /* selectAllBox function */\n          let selectAllBox \n            = document.querySelector(\"#select-all\") as HTMLInputElement;\n          selectAllBox.addEventListener(\"change\", ev => {\n            if (selectAllBox.checked == true) {\n              this.finder.selectRow();\n            } else {\n              this.finder.deselectRow();\n            }\n          });\n        }\n      });\n    }\n\n    else if (database == \"devices\") {\n      this.finder.destroy();\n      this.pathName.innerText = \"devices\";\n      this.finder = new Tabulator(\"#finder\", {\n        data: dataArr,\n        index: \"docname\",\n        layout: \"fitColumns\",\n        initialSort: [\n          {column: \"model\", dir: \"asc\"}\n        ],\n        columns: [\n          {title: \"<input id='select-all' type='checkbox'/>\", width: 15, headerSort: false},\n          {title: \"Model\", field: \"model\"},\n          {title: \"Brand\", field: \"brand\"},\n          {title: \"Type\", field: \"type\"},\n          {title: \"PPI\", field: \"ppi\"},\n        ],\n        selectable: true,\n        selectableRangeMode: \"click\",\n        rowClick: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n          \n        },\n        rowTap: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n        },\n        tableBuilt: () => {          \n          /* selectAllBox function */\n          let selectAllBox \n            = document.querySelector(\"#select-all\") as HTMLInputElement;\n          selectAllBox.addEventListener(\"change\", ev => {\n            if (selectAllBox.checked == true) {\n              this.finder.selectRow();\n            } else {\n              this.finder.deselectRow();\n            }\n          });\n        }\n      });\n    }\n\n    else if (database == \"eyecalibrations\") {\n      this.finder.destroy();\n      this.pathName.innerText = \"eyecalibrations\";\n      this.finder = new Tabulator(\"#finder\", {\n        data: dataArr,\n        index: \"Taskdoc\",\n        layout: \"fitColumns\",\n        initialSort: [\n          {column: \"Agent\", dir: \"asc\"}\n        ],\n        columns: [\n          {title: \"<input id='select-all' type='checkbox'/>\", width: 15, headerSort: false},\n          {title: \"Agent\", field: \"Agent\"},\n          {title: \"CurrentDate\", field: \"CurrentDate\"},\n        ],\n        selectable: true,\n        selectableRangeMode: \"click\",\n        rowClick: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n          \n        },\n        rowTap: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n        },\n        tableBuilt: () => {          \n          /* selectAllBox function */\n          let selectAllBox \n            = document.querySelector(\"#select-all\") as HTMLInputElement;\n          selectAllBox.addEventListener(\"change\", ev => {\n            if (selectAllBox.checked == true) {\n              this.finder.selectRow();\n            } else {\n              this.finder.deselectRow();\n            }\n          });\n        }\n      });\n    }\n\n    else if (database == \"mkscale\") {\n      this.finder.destroy();\n      this.pathName.innerText = \"mkscale\";\n      this.finder = new Tabulator(\"#finder\", {\n        data: dataArr,\n        index: \"Docname\",\n        layout: \"fitColumns\",\n        initialSort: [\n          {column: \"CurrentDate\", dir: \"asc\"}\n        ],\n        columns: [\n          {title: \"<input id='select-all' type='checkbox'/>\", width: 15, headerSort: false},\n          {title: \"Name\", field: \"Name\"},\n          {title: \"CurrentDate\", field: \"CurrentDate\"},\n        ],\n        selectable: true,\n        selectableRangeMode: \"click\",\n        rowClick: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n          this.mkc.populateAxisFields(row.getData());\n          \n        },\n        rowTap: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n          this.mkc.populateAxisFields(row.getData());\n        },\n        tableBuilt: () => {          \n          /* selectAllBox function */\n          let selectAllBox \n            = document.querySelector(\"#select-all\") as HTMLInputElement;\n          selectAllBox.addEventListener(\"change\", ev => {\n            if (selectAllBox.checked == true) {\n              this.finder.selectRow();\n            } else {\n              this.finder.deselectRow();\n            }\n          });\n        }\n      });\n    }\n\n    else {\n      console.error(\"Wrong or Invalid database trying to be tabularized\");\n    }\n  }\n  \n  private timestampToDate(dataArr: any[]) {\n    function _timestampToDate(element: Timestamp, idx: number, arr: any[]) {\n      try {\n        arr[idx] = element.toDate().toJSON();\n      } catch {\n\n      }\n    }\n\n    console.time(\"Timestamp Conversion\");\n    dataArr.forEach(data => {\n      for (let key of Object.keys(data)) {\n        if (Array.isArray(data[key])) {\n          data[key].forEach(_timestampToDate);\n        }\n  \n        else if (this.isDict(data[key])) {\n          try {\n            data[key] = data[key].toDate().toJSON();\n            continue;\n          } catch (e) {\n            // console.log(e);\n          }\n  \n          for (let key2 of Object.keys(data[key])) {\n            try {\n              data[key][key2] = data[key][key2].toDate().toJSON();\n            } catch {\n              // console.log(\"Not Timestamp Object\");\n            }\n          }\n        }\n        else if (!this.isString(data[key]) && !this.isNumber(data[key])) {\n          try {\n            data[key] = data[key].toDate().toJSON();\n          } catch {\n            // console.log(\"Not Timestamp Object\");\n          }\n        }\n      }\n    });\n    console.timeEnd(\"Timestamp Conversion\");\n\n    return dataArr;\n  }\n\n  private isDict(val: any) {\n    return val && typeof val === \"object\" && val.constructor === Object;\n  }\n\n  private isString(val: any) {\n    return typeof val === \"string\" || val.constructor === String;\n  }\n\n  private isNumber(val: any) {\n    return typeof val === \"number\" && isFinite(val);\n  }\n\n  public async listStorageFiles(fileRef: StorageReference) {\n\n    function formatFileSize(size: number) {\n      let threshold = 1000;\n      if (Math.abs(size) < threshold) {\n        return size + \" B\";\n      }\n\n      let units = [\"kB\", \"MB\", \"GB\", \"TB\"];\n      let u = -1;\n\n      do {\n        size /= threshold;\n        ++u;\n      } while (Math.abs(size) >= threshold && u < units.length -1);\n      return size.toFixed(1) + \" \" + units[u]; \n    }\n    \n    async function loadMetadata(fileArr: any) {\n\n      await getMetadata(fileArr).then((md: any) => {\n        mdArr.push({\n          name: md.name,\n          contentType: md.contentType,\n          fullPath: md.fullPath,\n          size: formatFileSize(md.size),\n          timeCreated: md.timeCreated\n        });\n      });\n\n\n      // await fileArr.getMetadata().then((md: any) => {\n      //   mdArr.push({\n      //     name: md.name,\n      //     contentType: md.contentType,\n      //     fullPath: md.fullPath,\n      //     size: formatFileSize(md.size),\n      //     timeCreated: md.timeCreated\n      //   });\n      // });\n    }\n\n    this.backBtn.disabled = (fileRef.fullPath == \"mkturkfiles\") ? true: false;\n\n    if (fileRef.fullPath == \"mkturkfiles/parameterfiles/params_storage\") {\n      this.mke.storeParamBtn.style.display = 'none';\n      // this.mke.genBtn.style.display = 'none';\n      this.mke.paramGenBtnBox.style.display = 'none';\n      // this.mke.genSceneParamBtn.style.display = 'none';\n      this.mke.svSceneBtn.style.display = 'none';\n      this.mke.makeActiveBtn.style.display = 'inline-block';\n      this.mke.updateBtn.style.display = 'inline-block';\n      this.mke.btnBoxDiv.style.gridTemplateAreas = '\"update-btn active-btn\"';\n    } else if (fileRef.fullPath == 'mkturkfiles/parameterfiles/subjects') {\n      this.mke.makeActiveBtn.style.display = 'none';\n      // this.mke.genBtn.style.display = 'none';\n      this.mke.paramGenBtnBox.style.display = 'none';\n      this.mke.svSceneBtn.style.display = 'none';\n      this.mke.updateBtn.style.display = 'inline-block';\n      this.mke.storeParamBtn.style.display = 'inline-block';\n      this.mke.btnBoxDiv.style.gridTemplateAreas = '\"update-btn store-param-btn\"';\n    } else if (fileRef.fullPath == 'mkturkfiles/scenebags/objectome3d/templates') {\n      this.mke.makeActiveBtn.style.display = 'none';\n      this.mke.storeParamBtn.style.display = 'none';\n      this.mke.svSceneBtn.style.display = 'none';\n      // this.mke.genBtn.style.display = 'inline-block';\n      this.mke.paramGenBtnBox.style.display = 'inline-block';\n      this.mke.updateBtn.style.display = 'inline-block';\n      this.mke.btnBoxDiv.style.gridTemplateAreas = '\"param-gen-btn-box update-btn\"';\n    } else {\n      this.mke.makeActiveBtn.style.display = 'none';\n      this.mke.storeParamBtn.style.display = 'none';\n      // this.mke.genBtn.style.display = 'none';\n      this.mke.paramGenBtnBox.style.display = 'none';\n      this.mke.svSceneBtn.style.display = 'none';\n      this.mke.updateBtn.style.display = 'inline-block';\n      this.mke.btnBoxDiv.style.gridTemplateAreas = '\"update-btn update-btn\"';\n    }\n\n    this.pathName.innerText = fileRef.fullPath;\n\n    let pathArr: string[] = fileRef.fullPath.split(\"/\");\n    let mdArr = new Array();\n    let fileList = await listAll(fileRef);\n    let filePromise: any;\n\n    /* Resolve previous path */\n    this.previousPath = \"\";\n    for (let i = 0; i < pathArr.length -1; i++) {\n      this.previousPath += pathArr[i] + \"/\";\n    }\n\n    /* Resolve metadata of all folders */\n    fileList.prefixes.forEach(folder => {\n      mdArr.push({\n        name: folder.name,\n        contentType: \"folder\",\n        fullPath: folder.fullPath,\n        size: \"N/A\"\n      });\n    });\n\n    /* Resolve metadata of all files */\n    filePromise = fileList.items.map(loadMetadata);\n    await Promise.all(filePromise);\n\n    this.displayStorageTable(mdArr);\n  }\n\n  private refreshStorageTable() {\n    document.addEventListener('storageFileChanged', (ev: Event) => {\n      let folderRef = this.mke.getActiveFile().id as StorageReference;\n      this.listStorageFiles(folderRef.parent!);\n    });\n  }\n\n  private displayStorageTable(metadataArr: any[]) {\n    this.finder.destroy();\n    this.finder = new Tabulator(\"#finder\", {\n      data: metadataArr,\n      index: \"name\",\n      responsiveLayout: true,\n      layout: \"fitColumns\",\n      resizableColumns: true,\n      initialSort: [\n        { column: \"name\", dir: \"asc\" }\n      ],\n      columns: [\n        { title: \"<input id='select-all' type='checkbox'/>\", width: 15, headerSort: false },\n        { title: \"Name\", field: \"name\", widthGrow: 3 },\n        { title: \"Type\", field: \"contentType\" },\n        { title: \"Path\", field: \"fullPath\" },\n        { title: \"Size\", field: \"size\" },\n      ],\n      selectable: true,\n      selectableRangeMode: \"click\",\n      rowDblClick: (ev, row) => {\n        ev.preventDefault();\n        ev.stopPropagation();\n        if (row.getData().contentType === \"folder\") {\n          console.log(\"rowDblClick\", row.getData().fullPath);\n          // this.listStorageFiles(this.storageRef.child(row.getData().fullPath));\n          this.listStorageFiles(ref(this.storageRef, row.getData().fullPath));\n        }\n      },\n      rowDblTap: (ev, row) => {\n        ev.preventDefault();\n        ev.stopPropagation();\n        if (row.getData().contentType === \"folder\") {\n          console.log(row.getData().fullPath);\n          // this.listStorageFiles(this.storageRef.child(row.getData().fullPath));\n          this.listStorageFiles(ref(this.storageRef, row.getData().fullPath));\n        }\n      },\n      rowClick: async (ev, row) => {\n        ev.stopPropagation();\n        if (row.getData().contentType === \"folder\") {\n          console.log(\"rowClick\", row.getData().fullPath);\n        }\n\n        else if (row.getData().contentType.includes(\"text\") ||\n                 row.getData().contentType.includes(\"json\")) {\n\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n\n          // let fileRef = this.storageRef.child(row.getData().fullPath);\n          let fileRef = ref(this.storageRef, row.getData().fullPath);\n          this.mke.displayStorageTextFile(fileRef);\n        }\n\n        else if (row.getData().contentType.includes(\"image\")) {\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mki.imgCanvasDiv.style.zIndex = \"3\";\n          this.mke.editorDivElement.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n\n          // let imgRef = this.storageRef.child(row.getData().fullPath);\n          let imgRef = ref(this.storageRef, row.getData().fullPath);\n          let imgName = row.getData().name;\n          this.mki.displayImage(imgRef, imgName);\n        }\n\n        else if (row.getData().contentType === \"application/octet-stream\" && row.getData().name.includes(\".glb\")) {\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mkt.canvas.style.zIndex = \"3\";\n          this.mke.editorDivElement.style.zIndex = \"2\";\n          this.mki.imgCanvasDiv.style.zIndex = \"1\";\n\n          // let meshRef = this.storageRef.child(row.getData().fullPath);\n          let meshRef = ref(this.storageRef, row.getData().fullPath);\n          this.mkt.displayMesh(meshRef);\n        }\n      },\n      rowSelectionChanged: (data, rows) => {\n        this.showImagesBtn.disabled = !this.imageTypeTest(data);\n        if (this.imageTypeTest(data)) {\n          this.selectedImages = data;\n        }\n      },\n\n      tableBuilt: () => {\n        let selectAllBox = \n          document.querySelector('#select-all') as HTMLInputElement;\n        selectAllBox.addEventListener('change', ev => {\n          if (selectAllBox.checked == true) {\n            this.finder.selectRow();\n          } else {\n            this.finder.deselectRow();\n          }\n        });\n      }\n    });\n  }\n\n  public listBigQueryTable(dataArr: any[], dataset: string, agent: string) {\n    this.displayBigqueryTable(dataArr);\n    this.pathName.innerText = `${dataset}.${agent}`;\n  }\n\n  private displayBigqueryTable(dataArr: any[]) {\n    this.finder.destroy();\n    this.finder = new Tabulator(\"#finder\", {\n      data: dataArr,\n      index: \"timestamp.value\",\n      responsiveLayout: true,\n      layout: \"fitColumns\",\n      resizableColumns: true,\n      initialSort: [\n        { column: \"timestamp.value\", dir: \"asc\" }\n      ],\n      columns: [\n        { title: \"<input id='select-all' type='checkbox'/>\", width: 15, headerSort: false },\n        { title: \"Timestamp\", field: \"timestamp.value\" },\n      ],\n      selectable: true,\n      selectableRangeMode: \"click\",\n      rowClick: async (ev, row) => {\n        ev.stopPropagation();\n        this.mke.displayBigQueryTableRow(row.getData());\n      },\n      rowTap: (ev, row) => {\n        ev.stopPropagation();\n        this.mke.displayBigQueryTableRow(row.getData());\n      },\n      dataLoaded: (data) => {\n        console.log(\"table data\", data);\n        this.mkc.removeElementsByClassName('axis-options');\n        this.mkc.bqPopulateAxisFields(data, 'eyedata');\n      }\n    });\n  }\n\n  /* Mkfinder controls */\n  private backBtnAction() {\n    this.backBtn.addEventListener(\"click\" || \"pointerup\", (ev: Event) => {\n      ev.preventDefault();\n      ev.stopPropagation();\n      console.log(\"[backBtn Pressed]: previousPath:\", this.previousPath);\n      // this.listStorageFiles(this.storageRef.child(this.previousPath));\n      this.listStorageFiles(ref(this.storageRef, this.previousPath));\n    });\n  }\n\n  private numImgSliderAction() {\n    this.numImgSlider.addEventListener(\"change\", (ev: Event) => {\n      console.log(this.numImgSlider.value);\n      this.mki.imgCanvas.style.gridTemplateColumns =\n      \"repeat(\" + String(this.numImgSlider.value) + \", minmax(0,1fr))\";\n    });\n  }\n\n  private showImagesBtnAction() {\n    this.showImagesBtn.addEventListener(\"click\" || \"pointerup\", async (ev: Event) => {\n      this.mkt.destroy();\n      this.mki.removeImages();\n\n      this.mki.imgCanvasDiv.style.zIndex = \"3\";\n      this.mke.editorDivElement.style.zIndex = \"2\";\n      this.mkt.canvas.style.zIndex = \"1\";\n\n      for (let i = 0; i < this.selectedImages.length; i++) {\n        // let imgRef = this.storageRef.child(this.selectedImages[i].fullPath);\n        let imgRef = ref(this.storageRef, this.selectedImages[i].fullPath);\n        let imgName = this.selectedImages[i].name;\n        await this.mki.displayImage(imgRef, imgName);\n      }\n    });\n  }\n\n  private imageTypeTest(data: any[]) {\n    if (data.length == 0 || data.length == 1) {\n      return false;\n    } else {\n      for (var i = 0; i < data.length; i++) {\n        if (!data[i].contentType.includes(\"image\")) {\n          return false;\n        }\n      }\n      return true;\n    }\n  }\n\n  private downloadBtnAction() {\n    this.downloadBtn.addEventListener(\"click\" || \"pointerup\", \n    async (ev: Event) => {\n      let row = this.finder.getSelectedRows();\n      let qryLoc = \n      document.querySelector(\"#qry-loc-selector\") as HTMLSelectElement;\n\n      if (qryLoc.value == \"mkturkfiles\" && \n          !row[0].getData().contentType.includes(\"folder\")) {\n        for (let i = 0; i < row.length; i++) {\n          // this.storageRef.child(row[i].getData().fullPath).getDownloadURL()\n          // .then(async (url: string) => {\n          //   let file = await (await fetch(url)).blob();\n          //   FileSaver.saveAs(file, row[i].getData().name);\n          // });\n\n          getDownloadURL(ref(this.storageRef, row[i].getData().fullPath))\n            .then(async (url: string) => {\n              let file = await (await fetch(url)).blob();\n              FileSaver.saveAs(file, row[i].getData().name);\n            });\n        }\n      }\n\n      else if (qryLoc.value == \"marmosets\") {\n        for (let i = 0; i < row.length; i++) {\n          let file = row[i].getData();\n          let blob = new Blob(\n            [ JSON.stringify(file, null, 1) ],\n            { type: \"application/json; charset=utf-8\" }\n          );\n          FileSaver.saveAs(blob, file.name + \".json\");\n        }\n      }\n\n      else if (qryLoc.value == \"mkdailydatatest\") {\n        for (let i = 0; i < row.length; i++) {\n          let file = row[i].getData();\n          let blob = new Blob(\n            [ JSON.stringify(file, null, 1) ],\n            { type: \"application/json; charset=utf-8\" }\n          );\n          FileSaver.saveAs(blob, file.agent + \".json\");\n        }\n      }\n\n      else if (qryLoc.value == \"mkdailydata\") {\n        for (let i = 0; i < row.length; i++) {\n          let file = row[i].getData();\n          let blob = new Blob(\n            [ JSON.stringify(file, null, 1) ],\n            { type: \"application/json; charset=utf-8\" }\n          );\n          FileSaver.saveAs(blob, file.agent + \".json\");\n        }\n      }\n\n      else if (qryLoc.value == \"mkturkdata\") {\n        for (let i = 0; i < row.length; i++) {\n          let docName = row[i].getData().FirestoreDocRoot + \"_\" +\n              row[i].getData().Doctype;\n          let file = row[i].getData();\n          let blob = new Blob(\n            [ JSON.stringify(file, null, 1) ],\n            { type: \"application/json; charset=utf-8\" }\n          );\n          FileSaver.saveAs(blob, docName + \".json\");\n        }\n      }\n\n      else if (qryLoc.value == \"devices\") {\n        for (let i = 0; i < row.length; i++) {\n          let file = row[i].getData();\n          let blob = new Blob(\n            [ JSON.stringify(file, null, 1) ],\n            { type: \"application/json; charset=utf-8\" }\n          );\n          FileSaver.saveAs(blob, file.docname + \".json\");\n        }\n      }\n\n      else if (qryLoc.value == \"eyecalibration\") {\n        for (let i = 0; i < row.length; i++) {\n          let file = row[i].getData();\n          let blob = new Blob(\n            [ JSON.stringify(file, null, 1) ],\n            { type: \"application/json; charset=utf-8\" }\n          );\n          FileSaver.saveAs(blob, file.Docname + \".json\");\n        }\n      }\n\n      else if (qryLoc.value == \"mkscale\") {\n        for (let i = 0; i < row.length; i++) {\n          let file = row[i].getData();\n          let blob = new Blob(\n            [ JSON.stringify(file, null, 1) ],\n            { type: \"application/json; charset=utf-8\" }\n          );\n          FileSaver.saveAs(blob, file.Docname + \".json\");\n        }\n      }\n\n      else if (qryLoc.value == \"objects\") {\n        for (let i = 0; i < row.length; i++) {\n          let file = row[i].getData();\n          let blob = new Blob(\n            [ JSON.stringify(file, null, 1) ],\n            { type: \"application/json; charset=utf-8\" }\n          );\n          FileSaver.saveAs(blob, file.docname + \".json\");\n        }\n      }\n    });\n  }\n\n\n}","import { getApp } from \"firebase/app\";\nimport { getFirestore, doc, collection, setDoc, Timestamp } from \"firebase/firestore\";\nimport { getStorage, StorageReference, getDownloadURL, ref, uploadBytes, deleteObject } from \"firebase/storage\";\nimport JSONEditor from \"jsoneditor\";\nimport Viewer from \"viewerjs\";\nimport * as EditorParams from \"./editor-params\";\n\nimport * as THREE from \"three\";\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls\";\nimport { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader\";\nimport { BufferGeometryLoader } from \"three\";\nimport {ParseEngine} from './parser'\n\n\ntype FileRef = StorageReference;\nconst db = getFirestore(getApp());\nconst storage = getStorage(getApp());\n\nexport class Mkeditor {\n  public editorDivElement: HTMLDivElement;\n  private editorElement: HTMLDivElement;\n  private editor: JSONEditor;\n  public updateBtn: HTMLButtonElement;\n  public btnBoxDiv: HTMLDivElement;\n  public makeActiveBtn: HTMLButtonElement;\n  public storeParamBtn: HTMLButtonElement;\n  private activeFile: \n    { loc: string, id: string | FileRef };\n  \n  public fileNameInput: HTMLInputElement;\n  private fileRenameBtn: HTMLButtonElement;\n  private fileDupBtn: HTMLButtonElement;\n  private fileDupModal: HTMLDialogElement;\n  // public genSceneParamBtn: HTMLButtonElement;\n  // private genSceneParamModal: HTMLDivElement;\n  public genBtn: HTMLButtonElement;\n  public paramGenBtnBox: HTMLDivElement;\n\n  public expandBtn: HTMLButtonElement;\n  public svSceneBtn: HTMLButtonElement;\n  private pe: ParseEngine;\n  private userEditedSceneParam: Object;\n  private generatedSceneParam: Object;\n\n\n  constructor() {\n    this.editorDivElement \n      = document.querySelector(\"#editor-div\") as HTMLDivElement;\n    this.editorElement = document.querySelector(\"#editor\") as HTMLDivElement;\n    this.editor = new JSONEditor(this.editorElement);\n    this.updateBtn = document.querySelector(\"#update-btn\") as HTMLButtonElement;\n    this.btnBoxDiv = document.querySelector(\"#button-box\") as HTMLDivElement;\n    this.paramGenBtnBox = document.querySelector('#param-gen-btn-box') as HTMLDivElement;\n    this.makeActiveBtn = document.querySelector(\"#active-btn\") as HTMLButtonElement;\n    this.storeParamBtn \n      = document.querySelector('#store-param-btn') as HTMLButtonElement;\n    this.activeFile = { loc: \"\", id: \"\" };\n    this.updateBtnAction();\n    this.makeActiveBtnAction();\n    this.storeParamBtnAction();\n    this.fileNameInput\n      = document.querySelector(\"#file-name-input\") as HTMLInputElement;\n    this.fileRenameBtn\n      = document.querySelector('#file-rename-btn') as HTMLButtonElement;\n    this.fileDupBtn\n      = document.querySelector('#file-dup-btn') as HTMLButtonElement;\n    this.fileDupModal\n      = document.querySelector('#file-dup-modal') as HTMLDialogElement;\n    this.renameBtnAction();\n    this.renameTextFieldAction();\n    this.getActiveFile();\n    this.fileDupBtnAction();\n\n\n    // this.genSceneParamBtn\n    //   = document.querySelector('#gen-scene-param-btn') as HTMLButtonElement;\n    // this.genSceneParamModal\n    //   = document.querySelector('#gen-scene-param-modal') as HTMLDivElement;\n    // this.generateSceneParamModalAction()\n    \n    \n    this.genBtn = document.querySelector('#generate-btn') as HTMLButtonElement;\n    this.expandBtn = document.querySelector('#expand-btn') as HTMLButtonElement;\n    this.svSceneBtn = document.querySelector('#save-scene-param-btn') as HTMLButtonElement;\n    this.genBtnAction();\n    this.svSceneBtnAction();\n    \n    this.pe = new ParseEngine();\n    this.userEditedSceneParam = {};\n    this.generatedSceneParam = {};\n\n  }\n\n  public getActiveFile() {\n    return this.activeFile;\n  }\n\n  public displayFirebaseTextFile(file: Object, loc: string) {\n    this.fileRenameBtn.style.display = 'none';\n    this.fileDupBtn.style.display = 'none';\n    // this.genSceneParamBtn.style.display = 'none';\n    this.storeParamBtn.style.display = 'none';\n    this.updateBtn.style.display = 'inline-block';\n    this.btnBoxDiv.style.gridTemplateAreas = '\"update-btn update-btn\"'\n    this.fileNameInput.value = '';\n    this.fileNameInput.disabled = true;\n\n    try {\n      let options = {\n        modes: ['tree' as 'tree', 'code' as 'code'],\n        sortObjectKeys: true,\n      };\n      this.editor.destroy();\n      this.editor = new JSONEditor(this.editorElement, options, file);\n      this.trackFirebaseActiveFile(loc, file);\n    } catch (error) {\n      console.error(\"JSONEditor Error:\", error);\n    }\n  }\n\n  public displayBigQueryTableRow(data: any) {\n    this.btnBoxDiv.style.display = 'none';\n    try {\n      this.editor.destroy();\n      let options = {\n        modes: ['tree' as 'tree', 'code' as 'code']\n      };\n      this.editor = new JSONEditor(this.editorElement, options, data);\n      this.fileNameInput.placeholder = data.timestamp.value;\n      // console.log(\"displayBigQueryTableRow\", data);\n    } catch (error) {\n      console.error(\"JSONEditor Error:\", error);\n    }\n  }\n\n  private trackFirebaseActiveFile(loc: string, file: any) {\n\n    if (loc === \"marmosets\") {\n      this.activeFile = { loc: loc, id: file.name };\n      this.fileNameInput.placeholder = String(this.activeFile.id);\n    }\n\n    else if (loc === \"mkturkdata\") {\n      if (file.Doctype === \"task\") {\n        this.activeFile = { loc: loc, id: file.Taskdoc };\n        this.fileNameInput.placeholder = String(this.activeFile.id);\n      } else if (file.Doctype === \"images\") {\n        this.activeFile = { loc: loc, id: file.Imagesdoc};\n        this.fileNameInput.placeholder = String(this.activeFile.id);\n      }\n    }\n\n    else if (loc === 'mkdailydata') {\n      this.activeFile = { loc: loc, id: file.agent };\n      this.fileNameInput.placeholder = String(this.activeFile.id);\n    }\n\n    else if (loc === 'mkdailydatatest') {\n      this.activeFile = { loc: loc, id: file.agent };\n      this.fileNameInput.placeholder = String(this.activeFile.id);\n    }\n\n    else if (loc === \"objects\") {\n      this.activeFile = { loc: loc, id: file.docname };\n      this.fileNameInput.placeholder = String(this.activeFile.id);\n    }\n\n    else if (loc === \"eyecalibrations\") {\n      this.activeFile = { loc: loc, id: file.Docname };\n      this.fileNameInput.placeholder = String(this.activeFile.id);\n    }\n\n    else if (loc === \"devices\") {\n      this.activeFile = { loc: loc, id: file.docname };\n      this.fileNameInput.placeholder = String(this.activeFile.id);\n    }\n\n    else if (loc === \"mkscale\") {\n      this.activeFile = { loc: loc, id: file.Docname };\n      this.fileNameInput.placeholder = String(this.activeFile.id);\n    }\n\n    console.log(\"activeFile\", this.activeFile);\n  }\n\n  public async displayStorageTextFile(fileRef: FileRef) {\n    console.log('diplayStorageTextFile FILEREF', fileRef);\n    this.fileNameInput.disabled = false;\n    this.fileRenameBtn.style.display = 'inline-block';\n    this.fileNameInput.value = '';\n\n    const sceneParamPath = 'mkturkfiles/scenebags/objectome3d';\n    const taskParamPath = 'mkturkfiles/parameterfiles';\n\n    function onClassName(classNameParams: {path: ReadonlyArray<string>; field: string; value: string;}) {\n      console.log(`onClassName path=${classNameParams.path}, field=${classNameParams.field}, value=${classNameParams.value}`);\n\n      const bioKeys = ['Agent', 'CheckRFID'];\n      const automatorKeys = [\n        'Automator', 'AutomatorFilePath', 'CurrentAutomatorStage',\n        'MinPercentCriterion', 'MinTrialsCriterion'\n      ];\n      const generalKeys = [\n        'DragtoRespond', 'CalibrateEye', 'NRSVP', 'NRSVPMax', 'SameDifferent',\n        'SamplingStrategy', 'NStickyResponse', 'NTrialsPerBagBlock'\n      ];\n      const gridKeys = [\n        'NGridPoints', 'GridSpacingInches', 'GridXOffsetInches',\n        'GridYOffsetInches', 'FixationGridIndex', 'SampleGridIndex',\n        'ObjectGridIndex', 'ChoiceGridIndex', 'TestGridIndex',\n      ];\n      const fixationKeys = [\n        'NFixations', 'FixationUsesSample', 'FixationSizeInches',\n        'FixationDuration', 'FixationTimeOut',\n      ];\n      const fixationConfigKeys = [\n        'FixationWindowSizeInches',\n        'FixationDotSizeInches',\n      ];\n      const sampleKeys = [\n        'ImageBagsSample', 'KeepSampleON',\n        'SamplePRE', 'SampleOFF',\n      ];\n      const testKeys = [\n        'ImageBagsTest', 'KeepTestON',\n        'TestOFF', 'HideTestDistractors',\n      ];\n      const choiceKeys = [\n        'ChoiceSizeInches', 'HideChoiceDistractors',\n        'ChoiceTimeOut',\n      ];\n      const rewardKeys = [\n        'RewardStage', 'RewardPer1000Trials',\n        'NRewardMax', 'NConsecutiveHitsforBonus',\n        'PunishTimeOut', 'ConsecutiveHitsITI',\n      ];\n      \n      if (bioKeys.includes(classNameParams.field)) {\n        return 'color-node-bio';\n      } else if (automatorKeys.includes(classNameParams.field)) {\n        return 'color-node-automator';\n      } else if (generalKeys.includes(classNameParams.field)) {\n        return 'color-node-general';\n      } else if (gridKeys.includes(classNameParams.field)) {\n        return 'color-node-grid';\n      } else if (fixationKeys.includes(classNameParams.field)) {\n        return 'color-node-fixation';\n      } else if (fixationConfigKeys.includes(classNameParams.field)) {\n        return 'color-node-fixation-config';\n      } else if (sampleKeys.includes(classNameParams.field)) {\n        return 'color-node-sample';\n      } else if (testKeys.includes(classNameParams.field)) {\n        return 'color-node-test';\n      } else if (choiceKeys.includes(classNameParams.field)) {\n        return 'color-node-choice';\n      } else if (rewardKeys.includes(classNameParams.field)) {\n        return 'color-node-reward';\n      } else {\n        return 'color-node-nuisance';\n      }\n    }\n\n    let sceneTemplateOptions = {\n      modes: ['tree' as 'tree', 'code' as 'code'],\n      templates: [\n        {\n          text: 'Camera',\n          title: 'Insert a Camera node',\n          field: 'CameraTemplate',\n          value: {\n            type: 'PerspectiveCamera',\n            fieldOfView: 45,\n            near: 0.1,\n            far: 2000,\n            position: {\n              x: [0],\n              y: [0],\n              z: [0]\n            },\n            targetInches: {\n              x: [0],\n              y: [0],\n              z: [0]\n            },\n            visible: [1]\n          }\n        },\n        {\n          text: 'Light',\n          title: 'Insert a Light node',\n          field: 'LightTemplate',\n          value: {\n            type: 'DirectionalLight',\n            color: '0xffffff',\n            intensity: [5],\n            position: {\n              x: [0],\n              y: [0],\n              z: [0]\n            },\n            visible: [1]\n          }\n        },\n        {\n          text: 'Object',\n          title: 'Insert an Object node',\n          field: 'ObjectTemplate',\n          value: {\n            meshpath: '',\n            objectdoc: '',\n            sizeInches: [0.5],\n            positionInches: {\n              x: [0],\n              y: [0],\n              z: [0]\n            },\n            rotationDegrees: {\n              x: [0],\n              y: [0],\n              z: [0]\n            },\n            material: {\n              type: 'MeshPhysicalMaterial',\n              color: '#7F7F7F',\n              metalness: 0.25,\n              roughness: 0.65,\n              reflectivity: 0.5,\n              opacity: [1],\n              transparent: false\n            },\n            visible: [1],\n            morphTarget: []\n          }\n        },\n        {\n          text: 'Background',\n          title: 'Insert a Background node',\n          field: 'ImagesTemplate',\n          value: {\n            imagebag: '',\n            imageidx: []\n          }\n        }\n      ]\n    }\n\n    let options = {\n      modes: ['tree' as 'tree', 'code' as 'code']\n    }\n\n    let taskParamOptions = {\n      modes: ['tree' as 'tree', 'code' as 'code'],\n      onClassName: onClassName,\n      schema: EditorParams.taskParamSchema\n    };\n\n    // let fileUrl = await getDownloadURL(fileRef).catch(e => {\n    //   console.error('Error getting download URL:', e);\n    // });\n\n    // let response;\n    // let file;\n\n    let file = await getDownloadURL(fileRef)\n      .then(async (url: string) => {\n        let response = await fetch(url);\n        return await response.json();\n      }).catch((e: Error) => {\n        console.error('Error getting download URL:', e);\n      });\n\n    // let fileUrl = await fileRef.getDownloadURL().catch(e => {\n    //   console.error(\"Error getting download URL\", e);\n    // });\n    // let response = await fetch(fileUrl);\n    // let file = await response.json();\n\n    if (fileRef.fullPath.includes(sceneParamPath)) {\n      if (fileRef.fullPath.includes('template')) {\n        this.fileDupBtn.style.display = 'inline-block';\n        // this.genSceneParamBtn.style.display = 'inline-block';\n        options = sceneTemplateOptions;\n      } else {\n        this.fileDupBtn.style.display = 'inline-block';\n        // this.genSceneParamBtn.style.display = 'none';\n      }\n    } else if (fileRef.fullPath.includes(taskParamPath)) {\n      console.log('FILEEEE:', file);\n      this.fileDupBtn.style.display = 'inline-block';\n      let taskParamKeys = Object.keys(JSON.parse(JSON.stringify(EditorParams.taskParamSchema, null, 1)).properties);\n      if (Array.isArray(file)) { // CASE: Automator\n        \n        for (let idx in file) {\n          let json = JSON.parse(JSON.stringify(file[idx], taskParamKeys, 1));\n          let json2: any = {};\n          Object.keys(file[idx]).forEach(key => {\n\n            if (!(key in json)) {\n              json2[key] = file[idx][key];\n            }\n          });\n          file[idx] = Object.assign(json, json2);\n          console.log('json:', json, 'json2:', json2);\n        }\n\n        console.log('FILE AFTER PROCESSING:', file);\n\n      } else {\n        let json = JSON.parse(JSON.stringify(file, taskParamKeys, 1));\n        let json2: any = {};\n        Object.keys(file).forEach(key => {\n          if (!(key in json)) {\n            json2[key] = file[key];\n          }\n        });\n        console.log('json:', json, 'json2:', json2);\n        file = Object.assign(json, json2);\n      }\n      options = taskParamOptions;\n      \n      // this.genSceneParamBtn.style.display = 'none';\n    } else {\n      this.fileDupBtn.style.display = 'none';\n      // this.genSceneParamBtn.style.display = 'none';\n    }\n\n    this.editor.destroy();\n    this.editor = new JSONEditor(this.editorElement, options, file);\n    this.activeFile = { loc: \"mkturkfiles\", id: fileRef };\n    console.log(\"activeFile\", this.activeFile);\n    this.fileNameInput.placeholder = fileRef.name;\n  }\n\n  private fileDupBtnAction() {\n    let fileName\n      = this.fileDupModal.querySelector('#dup-file-name') as HTMLInputElement;\n    \n    this.fileDupBtn.addEventListener('click', (ev: Event) => {\n      ev.preventDefault();\n      this.fileDupModal\n      this.fileDupModal.showModal();\n      let activeFileName = this.activeFile.id as FileRef;\n      fileName.value = 'Copy of ' + activeFileName.name;\n      fileName.focus();\n      fileName.select();\n    });\n\n    this.fileDupModal.querySelector('.close')?.addEventListener('click', () => {\n      this.fileDupModal.close();\n    });\n\n    this.fileDupModal.querySelector('.save')?.addEventListener('click', () => {\n      let srcFileRef = this.activeFile.id as FileRef;\n      // let dupFileRef = srcFileRef.parent?.child(fileName.value);\n      let dupFileRef = ref(srcFileRef.parent!, fileName.value)\n      let dupFile = new Blob([JSON.stringify(this.editor.get(), null, 1)]);\n      let md = {\n        contentType: 'application/json'\n      };\n\n      uploadBytes(dupFileRef, dupFile, md).then(async (snapshot) => {\n        console.log('[DOCUMENT DUPLICATED]:', snapshot);\n        alert('Document Duplicated');\n        let fileDupEvent = new Event('storageFileChanged');\n        this.fileNameInput.value = '';\n        this.displayStorageTextFile(dupFileRef);\n        document.dispatchEvent(fileDupEvent);\n      }).catch((e: Error) => {\n        console.error('[DOCUMENT DUPLICATE FAILED]:', e);\n        console.error('srcFile:', srcFileRef, 'destFile:', dupFileRef);\n        alert('Document Duplication Failed');\n      })\n\n      // dupFileRef?.put(dupFile, md).then(async (snapshot) => {\n      //   console.log('[DOCUMENT DUPLICATED]', snapshot);\n      //   alert('Document Duplicated');\n      //   let fileDupEvent = new Event('storageFileChanged');\n      //   this.fileNameInput.value = '';\n      //   this.displayStorageTextFile(dupFileRef!);\n      //   document.dispatchEvent(fileDupEvent);\n      // }).catch(e => {\n      //   console.error('[DOCUMENT DUPLICATE FAILED]:', e);\n      //   console.error('srcFile', srcFileRef, 'dupFile', dupFileRef);\n      //   alert('Document Dup Failed');\n      // });\n\n      this.fileDupModal.close();\n    });\n  }\n\n  private generateSceneParamModalAction() {\n\n    let collapsibles = document.getElementsByClassName('collapsible') as HTMLCollectionOf<HTMLButtonElement>;\n    for (let i = 0; i < collapsibles.length; i++) {\n      let coll = collapsibles[i];\n      coll.addEventListener('click', (ev: Event) => {\n        ev.preventDefault();\n        coll.classList.toggle('active');\n        let content = coll.nextElementSibling as HTMLButtonElement;\n        if (content.style.display === 'block') {\n          content.style.display = 'none';\n        } else {\n          content.style.display = 'block';\n        }\n      })\n    }\n\n    let initDataSize = [\n      {sampling: 'gaussian', params: '0, 1', n: 5}\n    ];\n\n    let rtSize = new Tabulator('#size-inches-table', {\n      data: initDataSize,\n      layout: 'fitColumns',\n      history: true,\n      columns: [\n        {title: 'Sampling', field: 'sampling', editor: 'select', editorParams: {values: ['gaussian', 'uniform', 'range']}},\n        {title: 'Params', field: 'params', editor: 'input', editable: true},\n        {title: 'n || step size', field: 'n', editor: 'input', editable: true}\n      ]\n    });\n\n    let szDiv = document.querySelector('.size-inches') as HTMLDivElement;\n    let addRowSize = szDiv.querySelector('.add-rule-btn') as HTMLButtonElement;\n    let undoSz = szDiv.querySelector('.undo-edit-btn') as HTMLButtonElement\n\n    addRowSize.addEventListener('click', (ev: Event) => {\n      ev.preventDefault();\n      rtSize.addRow({sampling: '', params: '', n: NaN}, false);\n    });\n\n    undoSz.addEventListener('click', (ev: Event) => {\n      rtSize.undo();\n    });\n\n    let initDataPos = [\n      {target: 'x', sampling: 'gaussian', params: '0, 1', n: 5}\n    ];\n\n    let rtPos = new Tabulator('#position-inches-table', {\n      data: initDataPos,\n      layout: 'fitColumns',\n      history: true,\n      columns: [\n        {title: 'Target', field: 'target', editor: 'select', editorParams: {values: ['x', 'y', 'z']}},\n        {title: 'Sampling', field: 'sampling', editor: 'select', editorParams: {values: ['gaussian', 'uniform', 'range']}},\n        {title: 'Params', field: 'params', editor: 'input', editable: true},\n        {title: 'n || step size', field: 'n', editor: 'input', editable: true}\n      ]\n    });\n\n    let posDiv = document.querySelector('.position-inches') as HTMLDivElement;\n    let addRowPos = posDiv.querySelector('.add-rule-btn') as HTMLButtonElement;\n    let undoPos = posDiv.querySelector('.undo-edit-btn') as HTMLButtonElement\n\n    addRowPos.addEventListener('click', (ev: Event) => {\n      ev.preventDefault();\n      rtPos.addRow({target: '', sampling: '', params: '', n: NaN});\n    });\n\n    undoPos.addEventListener('click', (ev: Event) => {\n      rtPos.undo();\n    });\n\n    let initDataDeg = [\n      {target: 'x', sampling: 'gaussian', params: '0, 1', n: 5}\n    ];\n\n    let rtDeg = new Tabulator('#rotation-degrees-table', {\n      data: initDataDeg,\n      layout: 'fitColumns',\n      history: true,\n      columns: [\n        {title: 'Target', field: 'target', editor: 'select', editorParams: {values: ['x', 'y', 'z']}},\n        {title: 'Sampling', field: 'sampling', editor: 'select', editorParams: {values: ['gaussian', 'uniform', 'range']}},\n        {title: 'Params', field: 'params', editor: 'input', editable: true},\n        {title: 'n || step size', field: 'n', editor: 'input', editable: true}\n      ]\n    });\n\n    let degDiv = document.querySelector('.rotation-degrees') as HTMLDivElement;\n    let addRowDeg = degDiv.querySelector('.add-rule-btn') as HTMLButtonElement;\n    let undoDeg = degDiv.querySelector('.undo-edit-btn') as HTMLButtonElement\n\n    addRowDeg.addEventListener('click', (ev: Event) => {\n      ev.preventDefault();\n      rtDeg.addRow({target: '', sampling: '', params: '', n: NaN});\n    });\n\n    undoDeg.addEventListener('click', (ev: Event) => {\n      rtDeg.undo();\n    });\n\n  }\n\n  private renameTextFieldAction() {\n    this.fileNameInput.addEventListener('click', (ev: Event) => {\n      let tmpName = this.activeFile.id as FileRef;\n      let curFileName = tmpName.name;\n      this.fileNameInput.value = curFileName;\n      this.fileNameInput.focus();\n      this.fileNameInput.select();\n    });\n  }\n\n  private renameBtnAction() {\n    this.fileRenameBtn.addEventListener('click', (ev: Event) => {\n      if (this.fileNameInput.value) {\n        let oldFileRef = this.activeFile.id as FileRef;\n        let newFileRef = ref(oldFileRef.parent!, this.fileNameInput.value);\n        // let newFileRef = oldFileRef.parent?.child(this.fileNameInput.value);\n        let newFile = new Blob([JSON.stringify(this.editor.get(), null, 1)]);\n        let md = {\n          contentType: 'application/json'\n        };\n\n        uploadBytes(newFileRef, newFile, md).then(async (snapshot) => {\n          await deleteObject(oldFileRef);\n          console.log('[DOCUMENT RENAMED]:', snapshot);\n          alert('Document Renamed');\n          let renameEvent = new Event('storageFileChanged');\n          this.fileNameInput.value = '';\n          this.displayStorageTextFile(newFileRef!);\n          document.dispatchEvent(renameEvent);\n        }).catch((e: Error) => {\n          console.error('[DOCUMENT RENAME FAILED]:', e);\n          console.error('oldFile', oldFileRef, 'newFile', newFileRef);\n          alert('Document Rename Failed');\n        })\n\n        // newFileRef?.put(newFile, md).then(async (snapshot) => {\n        //   await oldFileRef.delete();\n        //   console.log('[DOCUMENT RENAMED]', snapshot);\n        //   alert('Document Renamed');\n        //   let renameEvent = new Event('storageFileChanged');\n        //   this.fileNameInput.value = '';\n        //   this.displayStorageTextFile(newFileRef!);\n        //   document.dispatchEvent(renameEvent);\n        // }).catch(e => {\n        //   console.error('[DOCUMENT RENAME FAILED]:', e);\n        //   console.error('oldFile', oldFileRef, 'newFile', newFileRef);\n        //   alert('Document Rename Failed');\n        // });\n        \n\n      } else {\n        console.log('file name input field is null');\n      }\n    });\n  }\n\n  private updateBtnAction() {\n    this.updateBtn.addEventListener(\"click\" || \"pointerup\", (ev: Event) => {\n      ev.preventDefault();\n      ev.stopPropagation();\n      let loc = this.activeFile.loc;\n\n      if (loc === \"marmosets\" || loc === \"mkturkdata\" || loc === \"devices\"\n        || loc === \"mkscale\" || loc === \"eyecalibrations\" || loc === 'mkdailydata'\n        || loc === \"mkdailydatatest\") {\n        // handle marmosets && mkturkdata\n        let id = this.activeFile.id as string;\n\n        setDoc(\n          doc(db, loc, id),\n          this.dateToTimestamp(this.editor.get())\n        ).then(() => {\n          console.log(\"[DOCUMENT UPDATED]:\", id);\n          alert(\"Document Updated\");\n        }).catch((e: Error) => {\n          console.error(\"[DOCUMENT UPDATE FAILED]\", \"FILE:\", id, \"ERROR:\", e);\n          alert(\"Document Update Failed\");\n        })\n\n\n        // db.collection(loc).doc(id).set(\n        //   this.dateToTimestamp(this.editor.get())\n        // ).then(() => {\n        //   console.log(\"[DOCUMENT UPDATED]:\", id);\n        //   alert(\"Document Updated\");\n        // }).catch(e => {\n        //   console.error(\"[DOCUMENT UPDATE FAILED]\", \"FILE:\", id, \"ERROR:\", e);\n        //   alert(\"Document Update Failed\");\n        // });\n      }\n\n      else if (this.activeFile.loc === \"mkturkfiles\") {\n        // handle mkturkfiles\n        let id = this.activeFile.id as FileRef;\n        let updatedFile = new Blob([ JSON.stringify(this.editor.get(), null, 1) ]);\n        let metadata = {\n          contentType: \"application/json\"\n        };\n\n        uploadBytes(id, updatedFile, metadata).then(snapshot => {\n          console.log(this.editor.get());\n          console.log(\"[DOCUMENT UPDATED]:\", snapshot.metadata.name);\n          alert(\"Document Updated\");\n          document.dispatchEvent(new Event('storageFileChanged'));\n        }).catch((e: Error) => {\n          console.error(\"[DOCUMENT UPDATE FAILED]\", \"FILE:\", id, \"ERROR:\", e);\n          alert(\"Document Update Failed\");\n        });\n\n\n\n        // id.put(updatedFile, metadata).then(snapshot => {\n        //   console.log(this.editor.get());\n        //   console.log(\"[DOCUMENT UPDATED]:\", snapshot.metadata.name);\n        //   alert(\"Document Updated\");\n        //   document.dispatchEvent(new Event('storageFileChanged'));\n        // }).catch(e => {\n        //   console.error(\"[DOCUMENT UPDATE FAILED]\", \"FILE:\", id, \"ERROR:\", e);\n        //   alert(\"Document Update Failed\");\n        // });\n      }\n\n      else {\n        console.error(\"[DOCUMENT UPDATE FAILED] ERROR: Location Error\");\n      }\n    });\n  }\n\n  private makeActiveBtnAction() {\n    this.makeActiveBtn.addEventListener('click' || 'pointerup', (ev: Event) => {\n      ev.preventDefault();\n      ev.stopPropagation();\n      console.log(this.activeFile);\n      let storageRef = ref(storage);\n      let file = this.editor.get();\n      let fileName = \"mkturkfiles/parameterfiles/subjects/\" + file.Agent + \"_params.json\";\n      // let fileRef = storageRef.child(fileName);\n      let fileRef = ref(storageRef, fileName);\n      file = new Blob([ JSON.stringify(file, null, 1) ]);\n      let metadata = {\n        contentType: \"application/json\"\n      };\n\n      uploadBytes(fileRef, file, metadata).then(snapshot => {\n        console.log(\"[PARAM MADE ACTIVE]:\", snapshot.metadata.name);\n        alert(\"Param Active\");\n      }).catch((e: Error) => {\n        console.error(\"[PARAM ACTIVATION FAILED]\", \"FILE:\", fileRef, \"ERROR\", e);\n        alert(\"Param Activation Failed\");\n      });\n\n\n      // fileRef.put(file, metadata).then(snapshot => {\n      //   console.log(\"[PARAM MADE ACTIVE]:\", snapshot.metadata.name);\n      //   alert(\"Param Active\");\n      // }).catch(e => {\n      //   console.error(\"[PARAM ACTIVATION FAILED]\", \"FILE:\", fileRef, \"ERROR\", e);\n      //   alert(\"Param Activation Failed\");\n      // });\n    });\n  }\n\n  private storeParamBtnAction() {\n    this.storeParamBtn.addEventListener('click' || 'pointerup', (ev: Event) => {\n      ev.preventDefault();\n      ev.stopPropagation();\n      console.log(this.activeFile);\n      // let storageRef = storage.ref();\n      let storageRef = ref(storage);\n      let file = this.editor.get();\n      let date = new Date();\n      let fileName = 'mkturkfiles/parameterfiles/params_storage/'\n        + file.Agent + \"_params_\" + date.toJSON().split('T')[0]\n        + '.json';\n      \n      // let fileRef = storageRef.child(fileName);\n      let fileRef = ref(storageRef, fileName);\n\n      file = new Blob([ JSON.stringify(file, null, 1) ]);\n      let metadata = {\n        contentType: 'application/json'\n      };\n\n      uploadBytes(fileRef, file, metadata).then(snapshot => {\n        console.log('[PARAM STORED]:', snapshot.metadata.name);\n        alert('Param stored');\n      }).catch((e: Error) => {\n        console.error('[PARAM STORAGE FAILED]', 'FILE:', fileRef, 'ERROR', e);\n        alert('Param Storage Failed');\n      })\n\n      // fileRef.put(file, metadata).then(snapshot => {\n      //   console.log('[PARAM STORED]:', snapshot.metadata.name);\n      //   alert('Param stored');\n      // }).catch(e => {\n      //   console.error('[PARAM STORAGE FAILED]', 'FILE:', fileRef, 'ERROR', e);\n      //   alert('Param Storage Failed');\n      // });\n    });\n  }\n\n  private genBtnAction() {\n    this.genBtn.addEventListener('click', (ev: Event) => {\n      if (this.genBtn.value == 'generate') {\n        this.userEditedSceneParam = this.editor.get();\n        this.generatedSceneParam = (\n          this.pe.generateParamObject(this.userEditedSceneParam, 'vectorize')\n        );\n        this.editor.destroy();\n        let options = {\n          modes: ['tree' as 'tree', 'code' as 'code']\n        };\n        this.editor = new JSONEditor(this.editorElement, options, this.generatedSceneParam);\n        this.genBtn.value = 'revert';\n        this.genBtn.textContent = 'Revert';\n        this.updateBtn.style.display = 'none';\n        this.svSceneBtn.style.display = 'inline-block';\n        this.btnBoxDiv.style.gridTemplateAreas = '\"param-gen-btn-box sv-scene-param-btn\"';\n      } else if (this.genBtn.value == 'revert') {\n        this.editor.destroy();\n        this.generatedSceneParam = {};\n        let options = {\n          modes: ['tree' as 'tree', 'code' as 'code']\n        };\n        this.editor = new JSONEditor(this.editorElement, options, this.userEditedSceneParam);\n        this.genBtn.value = 'generate';\n        this.genBtn.textContent = 'Vectorize Param';\n        this.svSceneBtn.style.display = 'none';\n        this.updateBtn.style.display = 'inline-block';\n        this.btnBoxDiv.style.gridTemplateAreas = '\"param-gen-btn-box update-btn\"';\n      }\n    });\n\n    this.expandBtn.addEventListener('click', (ev: Event) => {\n      if (this.expandBtn.value == 'expand') {\n        this.userEditedSceneParam = this.editor.get();\n        this.generatedSceneParam = (\n          this.pe.generateParamObject(this.userEditedSceneParam, 'expand')\n        );\n        this.editor.destroy();\n        let options = {\n          modes: ['tree' as 'tree', 'code' as 'code']\n        };\n        this.editor = new JSONEditor(this.editorElement, options, this.generatedSceneParam);\n        this.expandBtn.value = 'revert';\n        this.expandBtn.textContent = 'Revert';\n        this.updateBtn.style.display = 'none';\n        this.svSceneBtn.style.display = 'inline-block';\n        this.btnBoxDiv.style.gridTemplateAreas = '\"param-gen-btn-box sv-scene-param-btn\"';\n      } else if (this.expandBtn.value == 'revert') {\n        this.editor.destroy();\n        this.generatedSceneParam = {};\n        let options = {\n          modes: ['tree' as 'tree', 'code' as 'code']\n        };\n        this.editor = new JSONEditor(this.editorElement, options, this.userEditedSceneParam);\n        this.expandBtn.value = 'expand';\n        this.expandBtn.textContent = 'Expand Param';\n        this.svSceneBtn.style.display = 'none';\n        this.updateBtn.style.display = 'inline-block';\n        this.btnBoxDiv.style.gridTemplateAreas = '\"param-gen-btn-box update-btn\"';\n      }\n    });\n  }\n\n  private svSceneBtnAction() {\n    let modal = document.querySelector('#filename-modal') as HTMLDialogElement;\n    let modalFilename = modal.querySelector('.filename-input') as HTMLInputElement;\n\n    this.svSceneBtn.addEventListener('click', (ev: Event) => {\n      ev.preventDefault();\n      modal.showModal();\n      let activeFileName = this.activeFile.id as FileRef;\n      let now = new Date();\n      modalFilename.value = now.toLocaleDateString('en-CA') + '_' + activeFileName.name;\n      modalFilename.focus();\n      modalFilename.select();\n    });\n\n    modal.querySelector('.cl')?.addEventListener('click', () => {\n      modal.close();\n    });\n\n    modal.querySelector('.sv')?.addEventListener('click', () => {\n      let srcRef = this.activeFile.id as FileRef;\n      // let destRef = srcRef.parent?.parent?.child('generatedParams').child(modalFilename.value);\n      let destRef = ref(srcRef.parent?.parent!, `generatedParams/${modalFilename.value}`);\n      let sceneSrcFileName = (\n        modalFilename.value.split('.')[0] + '_source.' + modalFilename.value.split('.')[1]\n      ); \n      // let sceneSrcDestRef = srcRef.parent?.parent?.child('generatedParams').child(sceneSrcFileName);\n      let sceneSrcDestRef = ref(srcRef.parent?.parent!, `generatedParams/${sceneSrcFileName}`);\n      let file = new Blob([JSON.stringify(this.generatedSceneParam, null, 1)]);\n      let sceneSrcFile = new Blob([JSON.stringify(this.userEditedSceneParam, null, 1)]);\n      let md = {\n        contentType: 'application/json'\n      };\n\n      uploadBytes(destRef, file, md).then(snapshot => {\n        alert('Generated param file was saved');\n        this.generatedSceneParam = {};\n        this.userEditedSceneParam = {};\n        this.displayStorageTextFile(srcRef);\n      }).catch((e: Error) => {\n        console.error('Param Generation Failed:', e);\n        alert('Generated param file was NOT saved');\n      });\n\n      uploadBytes(sceneSrcDestRef, sceneSrcFile, md);\n      modal.close();\n\n      // destRef?.put(file, md).then(async (sns) => {\n      //   alert('Generated param file was saved');\n      //   this.generatedSceneParam = {};\n      //   this.userEditedSceneParam = {};\n      //   this.displayStorageTextFile(srcRef);\n      // }).catch(e => {\n      //   console.error('Param Generation Failed');\n      //   alert('Generated param file was NOT saved');\n      // });\n      // sceneSrcDestRef?.put(sceneSrcFile, md);\n      // modal.close();\n    });\n  }\n\n  private dateToTimestamp(data: any) {\n    function _dateToTimestamp(element: string, idx: number, arr: any[]) {\n      let dt = new Date(element);\n      if (!isNaN(Number(dt)) && dt instanceof Date && typeof element === \"string\") {\n        arr[idx] = Timestamp.fromDate(dt);\n      }\n    }\n\n    for (let key of Object.keys(data)) {\n      if (Array.isArray(data[key]) \n        && (key.toLowerCase().includes('time') || key.toLowerCase().includes('dates'))) {\n        console.log(\"ARRAY \" + \"data[\" + key + \"]\" + \"=\" + data[key]);\n        data[key].forEach(_dateToTimestamp);\n      }\n\n      else if (this.isDict(data[key])) {\n        for (let key2 of Object.keys(data[key])) {\n          let dt = new Date(data[key][key2]);\n          if (!isNaN(Number(dt)) && dt instanceof Date && this.isString(data[key][key2])) {\n            console.log(\"Dictionary \" + \"data[\" + key + \"]\" + \"=\" + data[key]);\n            data[key][key2] = Timestamp.fromDate(dt);\n          }\n        }\n      }\n\n      else if (this.isString(data[key])\n        && (key.toLowerCase().includes('date') || key.toLowerCase().includes('time'))) {\n        \n        let dt = new Date(data[key]);\n        if (!isNaN(Number(dt)) && dt instanceof Date) {\n          data[key] = Timestamp.fromDate(dt);\n        }\n      }\n    }\n    return data;\n  }\n\n  private isDict(val: any) {\n    return val && typeof val === \"object\" && val.constructor === Object;\n  }\n\n  private isString(val: any) {\n    return typeof val === \"string\" || val.constructor === String;\n  }\n  \n}\n\nexport class Mkthree {\n\n  /* THREE.js member variables */\n  private scene: THREE.Scene | null;\n  private camera: THREE.PerspectiveCamera | null;\n  private cameraPos: THREE.Vector3 | null;\n  private controls: OrbitControls | null;\n  private dirLight: THREE.DirectionalLight | null;\n  private dirLightPos: THREE.Vector3 | null;\n  private light: THREE.AmbientLight | null;\n  private loader: GLTFLoader | null;\n  private renderer: THREE.WebGLRenderer | null;\n  public animationID: number;\n  public active: boolean;\n\n  public canvas: HTMLCanvasElement;\n  \n  /* constructor */\n  constructor() {\n    this.scene = null;\n    this.camera = null;\n    this.cameraPos = null;\n    this.controls = null;\n    this.dirLight = null;\n    this.dirLightPos = null;\n    this.light = null;\n    this.loader = null;\n    this.renderer = null;\n    this.animationID = -1;\n    this.active = false;\n    this.canvas = document.querySelector(\"#three-canvas\") as HTMLCanvasElement;\n    let editorDiv = document.querySelector(\"#editor-div\") as HTMLDivElement;\n    this.canvas.width = editorDiv.offsetWidth;\n    this.canvas.height = editorDiv.offsetHeight;\n    this.canvas.style.width = String(editorDiv.offsetWidth);\n    this.canvas.style.height = String(editorDiv.offsetHeight);\n    this.resizeCanvasAction();\n  }\n\n  /**\n   * Public function to display mesh specified by filepath to a canvas\n   * specified by canvas\n   * \n   * @param {string} filePath\n   * @param {HTMLCanvasElement} canvas\n   * @public\n   */\n  public async displayMesh(meshRef: StorageReference) {\n    console.time(\"displayMesh()\");\n\n    if (this.active) {\n      this.destroy();\n    }\n\n    /* renderer setup */\n    this.renderer = new THREE.WebGLRenderer({ canvas: this.canvas, antialias: true });\n    this.renderer.setClearColor( 0xFFFFFF );\n    this.renderer.physicallyCorrectLights = true;\n    this.renderer.toneMapping = THREE.LinearToneMapping;\n    this.renderer.toneMappingExposure = 10;\n    this.renderer.outputEncoding = THREE.GammaEncoding;\n    this.renderer.gammaFactor = 2.2;\n\n    /* camera setup */\n    this.cameraPos = new THREE.Vector3( 0, 0, 10 );\n    this.camera = \n      new THREE.PerspectiveCamera( 45, this.canvas.width / this.canvas.height, 0.1, 2000 );\n    this.camera.position.set( this.cameraPos.x, this.cameraPos.y, this.cameraPos.z );\n\n    /* light setup */\n    this.dirLightPos = new THREE.Vector3( 0, 2, 0 );\n    this.dirLight = new THREE.DirectionalLight( 0xFFFFFF, 0.5);\n    this.dirLight.position.set( this.dirLightPos.x, this.dirLightPos.y, this.dirLightPos.z )\n    this.light = new THREE.AmbientLight( 0x404040, 0.05 ); // (0x404040, 0.1)\n\n    /* control setup */\n    this.controls = new OrbitControls( this.camera, this.renderer.domElement );\n    this.controls.target = new THREE.Vector3( 0, 0, 0);\n\n    /* scene setup */\n    this.scene = new THREE.Scene();\n    this.scene.add(this.camera);\n    this.scene.add(this.dirLight);\n    this.scene.add(this.light);\n\n    /* load mesh */\n    let objectMesh: any = await this.loadMesh(meshRef);\n\n    /* add loaded mesh to scene */\n    this.scene.add(objectMesh.scene)\n    requestAnimationFrame(this.animate.bind(this));\n    this.renderer.render(this.scene, this.camera);\n    this.active = true;\n\n    console.timeEnd(\"displayMesh()\")\n  }\n\n  /**\n   * Private function to load and return mesh specified by filepath \n   * \n   * @param {string} filePath\n   * @returns {Promise}\n   * @private\n   */\n  private async loadMesh(meshRef: StorageReference) {\n    \n    try {\n\n      let meshUrl = await getDownloadURL(meshRef).catch((e: Error) => {\n        console.error('Error:', e);\n      }) as string;\n\n\n      // let meshUrl = await meshRef.getDownloadURL().catch(e => {\n      //   console.error(\"Error:\", e);\n      // });\n\n      this.loader = new GLTFLoader();\n\n      return new Promise((resolve, reject) => {\n        try {\n          this.loader?.load(meshUrl, function(gltf) {\n            gltf.scene.traverse((child: any) => {\n              if (child.material) {\n                let material = new THREE.MeshPhongMaterial({ color: \"#FFE0BD\" })\n                if (\"morphTargetInfluences\" in child) {\n                  material.morphTargets = true;\n                }\n                child.material = material;\n                child.material.needsUpdate = true;\n              }\n            });\n            resolve(gltf);\n          });\n        } catch (error) {\n          console.error(\"Error:\", error);\n        }\n      });\n    } catch (error) {\n      console.error(\"Error:\", error);\n    }\n  }\n\n  private animate() {\n    this.animationID = requestAnimationFrame(this.animate.bind(this));\n    if (this.scene && this.camera) {\n      this.renderer?.render(this.scene, this.camera);\n    }\n  }\n\n  public destroy() {\n    try {\n      this.scene = null;\n      this.camera = null;\n      this.cameraPos = null;\n      this.controls = null;\n      this.dirLight = null;\n      this.dirLightPos = null;\n      this.light = null;\n      this.loader = null;\n      this.renderer?.clear();\n      this.renderer = null;\n      this.animationID = -1;\n      this.active = false;\n      cancelAnimationFrame(this.animationID);\n    } catch (error) {\n      console.error(\"Error destroying THREE Objects:\", error);\n    }\n  }\n\n  private resizeCanvasAction() {\n    window.addEventListener(\"resize\", (ev: Event) => {\n      let editorDiv = document.querySelector(\"#editor-div\") as HTMLDivElement;\n      this.canvas.width = editorDiv.offsetWidth;\n      this.canvas.height = editorDiv.offsetHeight;\n      this.canvas.style.width = String(editorDiv.offsetWidth);\n      this.canvas.style.height = String(editorDiv.offsetHeight);\n    });\n  }\n}\n\nexport class Mkimage {\n  imgCanvasDiv: HTMLDivElement;\n  imgCanvas: HTMLElement;\n  imgGallery: Viewer;\n\n  constructor() {\n    this.imgCanvasDiv = \n    document.querySelector(\"#image-canvas-div\") as HTMLDivElement;\n\n    this.imgCanvas =\n    document.querySelector(\"#image-canvas\") as HTMLElement;\n\n    this.imgGallery = \n    new Viewer(document.getElementById(\"image-canvas\")!);\n  }\n\n  public async displayImage(fileRef: FileRef, fileName: string) {\n    let li = document.createElement(\"li\");\n    li.setAttribute(\"class\", \"imageList\");\n    let imgDiv = document.createElement(\"div\");\n    let img = document.createElement(\"img\");\n    let imgLabel = document.createElement(\"p\");\n    imgLabel.innerHTML = fileName;\n    // await fileRef.getDownloadURL().then(url => {\n    //   img.src = url;\n    // });\n    await getDownloadURL(fileRef).then(url => {\n      img.src = url;\n    })\n\n    imgDiv.appendChild(img);\n    imgDiv.appendChild(imgLabel);\n    li.appendChild(imgDiv);\n    this.imgCanvas.appendChild(li);\n    this.imgGallery.destroy();\n    this.imgGallery = new Viewer(document.getElementById(\"image-canvas\")!);\n  }\n\n  public removeImages() {\n    let elements = document.getElementsByClassName(\"imageList\");\n    while (elements.length > 0) {\n      elements[0].parentNode?.removeChild(elements[0]);\n    }\n    \n  }\n}\n\nexport class Mkchart {\n  chartDiv: HTMLDivElement;\n  plotX: HTMLSelectElement;\n  plotY: HTMLSelectElement;\n  plotBtn: HTMLButtonElement;\n  finderDiv: HTMLDivElement;\n  chart: any;\n  data: any;\n  isActive: boolean;\n  isBigQuery: boolean;\n\n  constructor() {\n    google.charts.load('current', { packages: ['corechart'] });\n    this.chartDiv = document.querySelector(\"#chart-div\") as HTMLDivElement;\n    this.finderDiv = document.querySelector(\"#finder-div\") as HTMLDivElement;\n    this.plotX = document.querySelector(\"#quick-plot-x\") as HTMLSelectElement;\n    this.plotY = document.querySelector(\"#quick-plot-y\") as HTMLSelectElement;\n    this.plotBtn = document.querySelector(\"#plot-btn\") as HTMLButtonElement;\n    this.isActive = false;\n    this.isBigQuery = false;\n    \n    this.data = null;\n    console.log(this.chartDiv);\n    \n    this.plotBtnAction();\n    \n  }\n\n  public plotBtnAction() {\n    this.plotBtn.addEventListener('click', (ev: Event) => {\n      ev.preventDefault();\n      this.isActive = !this.isActive;\n      if (this.isBigQuery == false) {\n        if (this.isActive) {\n          this.plotBtn.textContent = \"Close Quick Plot\";\n          this.chartDiv.style.zIndex = \"2\";\n          this.finderDiv.style.zIndex = \"1\";\n          let vizData = new google.visualization.DataTable();\n          vizData.addColumn('datetime', this.plotX.value);\n          vizData.addColumn('number', this.plotY.value);\n          \n          for (let i = 0; i < this.data[this.plotX.value].length; i++) {\n            vizData.addRow([ new Date(this.data[this.plotX.value][i]), parseFloat(this.data[this.plotY.value][i]) ]);\n          }\n  \n          console.log(this.chartDiv.clientWidth);\n          let chart = new google.visualization.LineChart(this.chartDiv);\n          let options = {\n            title: this.plotY.value,\n            width: this.chartDiv.offsetWidth,\n            height: this.chartDiv.offsetHeight,\n            legend: 'none' as 'none',\n            pointSize: 10\n          };\n          chart.draw(vizData, options);\n          \n        } else {\n          this.plotBtn.textContent = \"Quick Plot\";\n          this.finderDiv.style.zIndex = \"2\";\n          this.chartDiv.style.zIndex = \"1\";\n        }\n      }\n      else if (this.isBigQuery == true) {\n        if (this.isActive) {\n          this.plotBtn.textContent = \"Close Quick Plot\";\n          this.chartDiv.style.zIndex = \"2\";\n          this.finderDiv.style.zIndex = \"1\";\n\n          let vizData = new google.visualization.DataTable();\n          if (this.plotX.value === 'timestamp') {\n            vizData.addColumn('datetime', this.plotX.value);\n          } else {\n            vizData.addColumn('number', this.plotX.value);\n          }\n\n          if (this.plotY.value === 'timestamp') {\n            vizData.addColumn('datetime', this.plotY.value);\n          } else {\n            vizData.addColumn('number', this.plotY.value);\n          }\n\n          for (let i = 0; i < this.data[this.plotX.value]. length; i++) {\n            vizData.addRow([this.data[this.plotX.value][i], this.data[this.plotY.value][i]]);\n          }\n          let chart = new google.visualization.LineChart(this.chartDiv);\n          let options = {\n            title: this.plotY.value,\n            width: this.chartDiv.offsetWidth,\n            height: this.chartDiv.offsetHeight,\n            legend: 'none' as 'none',\n            pointSize: 10\n          };\n          chart.draw(vizData, options);\n        } else {\n          this.plotBtn.textContent = \"Quick Plot\";\n          this.finderDiv.style.zIndex = \"2\";\n          this.chartDiv.style.zIndex = \"1\";\n        }\n      }\n    });\n\n    \n  }\n\n  public populateAxisFields(data: any) {\n    this.data = data;\n    this.isBigQuery = false;\n    for (let key of Object.keys(data)) {\n      if (Array.isArray(data[key]) \n        && (key.includes(\"_dates\") || key.toLowerCase().includes('times'))) {\n        let option = document.createElement(\"option\");\n        option.setAttribute(\"class\", \"axis-options\");\n        option.setAttribute(\"value\", key);\n        option.textContent = key;\n        this.plotX.appendChild(option);\n      }\n      else if (Array.isArray(data[key]) \n        && (key.includes(\"_values\")) || key.toLowerCase().includes('values')) {\n        let option = document.createElement(\"option\");\n        option.setAttribute(\"class\", \"axis-options\");\n        option.setAttribute(\"value\", key);\n        option.textContent = key;\n        this.plotY.appendChild(option);\n      }\n    }\n  }\n\n  public bqPopulateAxisFields(dataArr: any, dataset: string) {\n    this.isBigQuery = true;\n    if (dataset === \"eyedata\") {\n      let eyedataObj: any = {};\n      //console.log('bqpopulate axis dataArr', dataArr);\n      dataArr.forEach((data: any) => {\n        // console.log('data in dataArr', data);\n        for (let key of Object.keys(data)) {\n          //console.log('key', key);\n          if (key === \"timestamp\") {\n            try {\n              eyedataObj[key].push(new Date(data[key].value));\n            } catch {\n              eyedataObj[key] = [];\n              eyedataObj[key].push(new Date(data[key].value));\n              this.addAxisOption(key);\n            }\n          } else {\n            try {\n              eyedataObj[key].push(parseFloat(data[key]));\n            } catch {\n              eyedataObj[key] = [];\n              eyedataObj[key].push(parseFloat(data[key]));\n              this.addAxisOption(key);\n            }\n          }\n        }\n      });\n      this.data = eyedataObj;\n    }\n\n  }\n\n  private addAxisOption(key: string) {\n    let optionX = document.createElement('option');\n    optionX.setAttribute('class', 'axis-options');\n    optionX.setAttribute('value', key);\n    optionX.textContent = key;\n    let optionY = document.createElement('option');\n    optionY.setAttribute('class', 'axis-options');\n    optionY.setAttribute('value', key);\n    optionY.textContent = key;\n    this.plotX.appendChild(optionX);\n    this.plotY.appendChild(optionY);\n  }\n\n  public removeElementsByClassName(cName: string) {\n    let elements = document.getElementsByClassName(cName);\n    while (elements.length > 0) {\n      elements[0].parentNode?.removeChild(elements[0]);\n    }\n  }\n}","import { getApp } from \"firebase/app\";\nimport { getFunctions, httpsCallable } from \"firebase/functions\";\nimport { Query, doc, getDoc, getDocs } from 'firebase/firestore';\n\nconst functions = getFunctions(getApp());\n// const functions = firebase.functions();\n\n// const listTables = functions.httpsCallable('listTables');\nconst listTables = httpsCallable(functions, 'listTables');\n\n// const bqQuery = functions.httpsCallable('bqQuery');\nconst bqQuery = httpsCallable(functions, 'bqQuery');\n\nexport class Mkquery {\n  public rfidMode: boolean;\n  \n  constructor() {\n    this.rfidMode = false;\n\n  };\n  /**\n   * Connects and returns query strings\n   * \n   * @param {{field: string, keyword: string}[]} queryParams\n   * @returns {string} returns a string of connected query strings\n   */\n  public mkquery(queryParams: {field: string, keyword: string}[]) {\n    let queryString: string;\n    \n    queryString = \"\";\n    queryParams.forEach(queryParam => {\n      queryString += this._mkquery(queryParam.field, queryParam.keyword);\n    });\n\n    return queryString;\n  }\n  \n  /**\n   * Generates and returns individual query string for a given field and keyword\n   * \n   * @param {string} field\n   * @param {string} keyword\n   * @returns {string} returns generated query string\n   * @private\n   */\n  private _mkquery(field: string, keyword: string) {\n    if (field.toLowerCase().includes(\"date\")) {\n      const DAY_TO_MS: number = 86400000;\n      let dateStr: string[];\n      let refDate: Date;\n\n      dateStr = keyword.split(\";\");\n      dateStr.length === 2 ? dateStr[1] = dateStr[1].trim() : dateStr[1] = \"\";\n      refDate = new Date(dateStr[0]);\n\n      if (dateStr[1].includes(\"+-\")) {\n        let upperDate: Date;\n        let lowerDate: Date;\n        let range: number;\n        let queryStr: string;\n\n        range = Number(dateStr[1].substring(2, dateStr[1].length));\n        upperDate = new Date(refDate.getTime() + range * DAY_TO_MS);\n        lowerDate = new Date(refDate.getTime() - range * DAY_TO_MS);\n        queryStr = \".where(\" + `\"${field}\"` + \", '>=', \" + \"new Date(\"\n          + String(lowerDate.getTime()) + \")).where(\" + `\"${field}\"`\n          + \", '<=', \" + \"new Date(\" + String(upperDate.getTime()) + \"))\";\n\n        return queryStr;\n      }\n\n      else if (dateStr[1].includes(\"+\") && !dateStr[1].includes(\"-\")) {\n        let upperDate: Date;\n        let range: number;\n        let queryStr: string;\n\n        range = Number(dateStr[1].substring(1, dateStr[1].length));\n        upperDate = new Date(refDate.getTime() + range * DAY_TO_MS);\n        queryStr = \".where(\" + `\"${field}\"` + \", '>=', \" + \"new Date(\"\n          + String(refDate.getTime()) + \")).where(\" + `\"${field}\"`\n          + \", '<=', \" + \"new Date(\" + String(upperDate.getTime()) + \"))\";\n\n        return queryStr;\n      }\n\n      else if (dateStr[1].includes(\"-\") && !dateStr[1].includes(\"+\")) {\n        let lowerDate: Date;\n        let range: number;\n        let queryStr: string;\n\n        range = Number(dateStr[1].substring(1, dateStr[1].length));\n        lowerDate = new Date(refDate.getTime() + range * DAY_TO_MS);\n        queryStr = \".where(\" + `\"${field}\"` + \", '>=', \" + \"new Date(\"\n          + String(lowerDate.getTime()) + \")).where(\" + `\"${field}\"`\n          + \", '<=', \" + \"new Date(\" + String(refDate.getTime()) + \"))\";\n\n        return queryStr;\n      }\n\n      else if ( !(dateStr[1].includes(\"+\") || dateStr[1].includes(\"-\")) ) {\n        let upperDate: Date;\n        let queryStr: string;\n        \n        upperDate = new Date(refDate.getTime() + DAY_TO_MS);\n        queryStr = \".where(\" + `\"${field}\"` + \", '>=', \" + \"new Date(\"\n          + String(refDate.getTime()) + \")).where(\" + `\"${field}\"` + \", '<=', \"\n          + \"new Date(\" + String(upperDate.getTime()) + \"))\";\n\n        return queryStr;\n      }\n    }\n    else {\n      let queryStr: string;\n\n      queryStr = \".where(\" + `\"${field}\"` + \", '==', \" + `\"${keyword}\"` + \")\";\n\n      return queryStr;\n    }\n  }\n\n\n\n  public async decodeQuery(query: Query) {\n    async function loadData(doc: any, arr: any[]) {\n      await arr.push(doc.data());\n    }\n\n    let arr = new Array();\n\n    await getDocs(query).then(async (querySnapshot) => {\n      if (!querySnapshot.empty) {\n        let promises = querySnapshot.docs.map(doc => loadData(doc, arr));\n        await Promise.all(promises);\n      } else {\n        console.log('Found No Documents');\n        alert('Found No Documents');\n      }\n    }).catch((e: Error) => {\n      console.error('Error Getting Documents:', e);\n    });\n\n    return arr;\n\n    // await query.get().then(async querySnapshot => {\n    //   if (!querySnapshot.empty) {\n    //     let promises = querySnapshot.docs.map(doc => loadData(doc, arr));\n    //     await Promise.all(promises);\n    //   }\n      \n    //   else {\n    //     console.log(\"Found No Documents\");\n    //     alert(\"Found No Documents\");\n    //   }\n    // }).catch(e => {\n    //   console.error(\"Error getting documents:\", e);\n    // });\n\n    // return arr;\n  }\n  \n  public mkbquery(dataset: string, agent: string, date: string) {\n    let queryDateLower: string | Date = new Date(date);\n    let queryDateUpper: string | Date = new Date(date);\n    queryDateUpper.setDate(queryDateUpper.getDate() + 1);\n    queryDateLower = queryDateLower.toJSON().split('T')[0];\n    queryDateUpper = queryDateUpper.toJSON().split('T')[0];\n\n    let str = `SELECT *\n              FROM \\`sandbox-ce2c5.${dataset}.${agent}\\`\n              WHERE timestamp BETWEEN '${queryDateLower}' AND '${queryDateUpper}'\n              ORDER BY timestamp ASC`;\n    console.log(\"querystr\", str);\n    return str;\n  }\n\n  public async decodeBigQuery(queryStr: string) {\n    let test = await bqQuery(queryStr);\n    return test;\n  }\n  \n}","import * as math from 'mathjs';\nimport cloneDeep from 'lodash.clonedeep';\nimport isPlainObject from 'lodash/isPlainObject';\nimport isArray from 'lodash/isArray';\n\nexport class ParseEngine {\n\n  constructor() {\n\n  }\n\n  public generateParamObject(obj: any, scheme: string) {\n    \n    let userObj = cloneDeep(obj);\n    console.log(userObj);\n    let totalLen = 1;\n    let minLen = 1;\n    let maxLen = 1;\n    let path = [\n      'CAMERAS', 'LIGHTS',\n      'OBJECTS', 'IMAGES',\n      'durationMS', 'IMAGEFILTERS',\n      'OBJECTFILTERS'\n    ];\n\n    // Parse and generate based on smart text\n    path.forEach((module, index) => {\n      if (isArray(userObj[module]) && userObj[module].length > 0) {\n        userObj[module] = this.parseAndGenerate2(userObj[module]);\n        totalLen *= userObj[module].length;\n        minLen = (userObj[module].length > minLen) ? minLen : userObj[module].length;\n        maxLen = (maxLen > userObj[module].length) ? maxLen : userObj[module].length;\n      } else if (isPlainObject(userObj[module])) {\n        for (let key in userObj[module]) {\n          if (isArray(userObj[module][key]) && userObj[module][key].length > 0) {\n            userObj[module][key] = this.parseAndGenerate2(userObj[module][key]);\n            totalLen *= userObj[module][key].length;\n            minLen = (userObj[module][key].length > minLen) ? minLen : userObj[module][key].length;\n            maxLen = (maxLen > userObj[module][key].length) ? maxLen : userObj[module][key].length;\n          } else if (isPlainObject(userObj[module][key])) {\n            for (let key2 in userObj[module][key]) {\n              if (isArray(userObj[module][key][key2]) && userObj[module][key][key2].length > 0) {\n                userObj[module][key][key2] = this.parseAndGenerate2(userObj[module][key][key2]);\n                totalLen *= userObj[module][key][key2].length;\n                minLen = (userObj[module][key][key2].length > minLen) ? minLen : userObj[module][key][key2].length;\n                maxLen = (maxLen > userObj[module][key][key2].length) ? maxLen : userObj[module][key][key2].length;\n              } else if (isPlainObject(userObj[module][key][key2])) {\n                for (let key3 in userObj[module][key][key2]) {\n                  if (isArray(userObj[module][key][key2][key3]) && userObj[module][key][key2][key3].length > 0) {\n                    userObj[module][key][key2][key3] = this.parseAndGenerate2(userObj[module][key][key2][key3]);\n                    totalLen *= userObj[module][key][key2][key3].length;\n                    minLen = (userObj[module][key][key2][key3].length > minLen) ? minLen : userObj[module][key][key2][key3].length;\n                    maxLen = (maxLen > userObj[module][key][key2][key3].length) ? maxLen : userObj[module][key][key2][key3].length;\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    });\n\n    if (scheme == 'vectorize') {\n      path.forEach((module, index) => {\n        if (isArray(userObj[module]) && userObj[module].length > 1) {\n          let tmp = [];\n          for (let i = 0; i < totalLen; i++) {\n            tmp.push(userObj[module][i % userObj[module].length]);\n          }\n          userObj[module] = tmp;\n        } else if (isPlainObject(userObj[module])) {\n          for (let key in userObj[module]) {\n            if (isArray(userObj[module][key]) && userObj[module][key].length > 1) {\n              let tmp = [];\n              for (let i = 0; i < totalLen; i++) {\n                tmp.push(userObj[module][key][i % userObj[module][key].length]);\n              }\n              userObj[module][key] = tmp;\n            } else if (isPlainObject(userObj[module][key])) {\n              for (let key2 in userObj[module][key]) {\n                if (isArray(userObj[module][key][key2]) && userObj[module][key][key2].length > 1) {\n                  let tmp = [];\n                  for (let i = 0; i < totalLen; i++) {\n                    tmp.push(userObj[module][key][key2][i % userObj[module][key][key2].length]);\n                  }\n                  userObj[module][key][key2] = tmp;\n                } else if (isPlainObject(userObj[module][key][key2])) {\n                  for (let key3 in userObj[module][key][key2]) {\n                    if (isArray(userObj[module][key][key2][key3]) && userObj[module][key][key2][key3].length > 1) {\n                      let tmp = [];\n                      for (let i = 0; i < totalLen; i++) {\n                        tmp.push(userObj[module][key][key2][key3][i % userObj[module][key][key2][key3].length]);\n                      }\n                      userObj[module][key][key2][key3] = tmp;\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      });  \n    } else if (scheme == 'expand') {\n      path.forEach((module, index) => {\n        if (\n          isArray(userObj[module])\n          && userObj[module].length > 1\n          && userObj[module].length != maxLen\n        ) {\n          let err = new Error(`Length Mismatch: ${module}.length=${userObj[module].length} != maxLen=${maxLen}`);\n          alert(err.message);\n          throw err;\n          \n        } else if (isPlainObject(userObj[module])) {\n          for (let key in userObj[module]) {\n            if (\n              isArray(userObj[module][key])\n              && userObj[module][key].length > 1\n              && userObj[module][key].length != maxLen\n            ) {\n              let err = new Error(`Length Mismatch: ${module}[${key}].length=${userObj[module][key].length} != maxLen=${maxLen}`);\n              alert(err.message);\n              throw err;\n            } else if (isPlainObject(userObj[module][key])) {\n              for (let key2 in userObj[module][key]) {\n                if (\n                  isArray(userObj[module][key][key2])\n                  && userObj[module][key][key2].length > 1\n                  && userObj[module][key][key2].length != maxLen\n                ) {\n                  let err = new Error(`Length Mismatch: ${module}[${key}][${key2}].length=${userObj[module][key][key2].length} != maxLen=${maxLen}`);\n                  alert(err.message);\n                  throw err;\n                } else if (isPlainObject(userObj[module][key][key2])) {\n                  for (let key3 in userObj[module][key][key2]) {\n                    if (\n                      isArray(userObj[module][key][key2][key3])\n                      && userObj[module][key][key2][key3].length > 1\n                      && userObj[module][key][key2][key3].length != maxLen\n                    ) {\n                      let err = new Error(`Length Mismatch: ${module}[${key}][${key2}][${key3}].length=${userObj[module][key][key2][key3].length} != maxLen=${maxLen}`);\n                      alert(err.message);\n                      throw err;\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      });\n    }\n\n    console.log('userObj', userObj, 'totalLen:', totalLen);\n    return userObj;\n  }\n\n  private genParamObj(type: string, obj: any) {\n    \n    if (type == 'CAMERAS') {\n      for (let key in obj) {\n        if (obj.hasOwnProperty(key)) {\n          obj[key].position = this.vectorize(obj[key].position, 'cartesianObj');\n          obj[key].targetInches = this.vectorize(obj[key].targetInches, 'cartesianObj');\n          obj[key].visible = this.vectorize(obj[key].visible, 'array');\n        }\n      }\n    } else if (type == 'LIGHTS') {\n      for (let key in obj) {\n        if (obj.hasOwnProperty(key)) {\n          obj[key].position = this.vectorize(obj[key].position, 'cartesianObj');\n          obj[key].intensity = this.vectorize(obj[key].intensity, 'array');\n          obj[key].visible = this.vectorize(obj[key].visible, 'array');\n        }\n      }\n    } else if (type == 'OBJECTS') {\n      for (let key in obj) {\n        if (obj.hasOwnProperty(key)) {\n          obj[key].positionInches = this.vectorize(obj[key].positionInches, 'cartesianObj');\n          obj[key].rotationDegrees = this.vectorize(obj[key].rotationDegrees, 'cartesianObj');\n          obj[key].sizeInches = this.vectorize(obj[key].sizeInches, 'array');\n          obj[key].material.opacity = this.vectorize(obj[key].material.opacity, 'array');\n          obj[key].visible = this.vectorize(obj[key].visible, 'array');\n        }\n      }\n    } else if (type == 'IMAGES') {\n      obj.imageidx = this.vectorize(obj.imageidx, 'array');\n    }\n  }\n\n  private normal(mu: number, sigma: number, n: number) {\n    let u1 = math.random([n]);\n    let u2 = math.random([n]);\n\n    let R_sq = math.multiply(-2, math.log(u1));\n    let theta = math.multiply(2 * math.pi, u2);\n\n    let z1 = math.dotMultiply(math.sqrt(R_sq as math.Matrix), math.cos(theta as math.Matrix));\n    let sample = math.add(mu, math.multiply(z1, sigma));\n\n    return sample;\n  }\n\n  private parseAndGenerate2 (row: any[]) {\n    let sample: any;\n    \n    if (Object.prototype.toString.call(row[0]) === '[object String]') {\n      let recipe = row[0].split('/');\n      if (recipe[0] == 'normal' || recipe[0] == 'n') {\n        console.log('row:', row);\n        console.log('recipe:', recipe);\n        let mu = Number(recipe[1].split(',')[0]);\n        let sigma = Number (recipe[1].split(',')[1]);\n        let n = Number(recipe[2]);\n        sample = this.normal(mu, sigma, n) as number[];\n        console.log(sample);\n      } else if (recipe[0] == 'uniform' || recipe[0] == 'u') {\n        let min = Number(recipe[1].split(',')[0]);\n        let max = Number(recipe[1].split(',')[1]);\n        let size = [Number(recipe[2])];\n        sample = math.random(size, min, max);\n      } else if (recipe[0] == 'range' || recipe[0] == 'r') {\n        let start = Number(recipe[1].split(',')[0]);\n        let end = Number(recipe[1].split(',')[1]);\n        let step = Number(recipe[2]);\n        let range = math.range(start, end, step);\n        sample = [];\n        range.forEach(value => {\n          sample.push(Number(parseFloat(value).toPrecision(4)));\n        });\n      } else if (recipe[0] == 'linspace' || recipe[0] == 'l') {\n        let start = Number(recipe[1].split(',')[0]);\n        let end = Number(recipe[1].split(',')[1]);\n        let num = Number(recipe[2]);\n        let step = (end - start) / (num - 1);\n        let linspace = math.range(start, end, step, true);\n        sample = [];\n        linspace.forEach(value => {\n          sample.push(Number(parseFloat(value).toPrecision(4)));\n        });\n      } else if (recipe[0] == 'movie' || recipe[0] == 'm') {\n        let list = recipe[1].split(',');\n        let tmp: any[] = [];\n        list.forEach((value: string) => {\n          tmp.push(Number(parseFloat(value).toPrecision(4)));\n        });\n        sample = [];\n        sample.push(tmp);\n      } else {\n        let list = recipe[0].split(',');\n        sample = [];\n        list.forEach((value: string) => {\n          sample.push(Number(parseFloat(value).toPrecision(4)));\n        });\n      }\n    } else {\n      return row;\n    }\n    // else {\n    //   if (isNaN(row[0]) == false) {\n    //     console.log('single number', row);\n    //     sample = [];\n    //     sample.push(row);\n    //   }\n    // }\n\n    return sample;\n  }\n\n  private parseAndGenerate(row: any) {\n    let sample: any;\n    if (Object.prototype.toString.call(row) === '[object String]') {\n      let recipe = row.split('/');\n      if (recipe[0] == 'normal' || recipe[0] == 'n') {\n        console.log('row:', row);\n        let mu = Number(recipe[1].split(',')[0]);\n        let sigma = Number (recipe[1].split(',')[1]);\n        let n = Number(recipe[2]);\n        sample = this.normal(mu, sigma, n) as number[];\n      } else if (recipe[0] == 'uniform' || recipe[0] == 'u') {\n        let min = Number(recipe[1].split(',')[0]);\n        let max = Number(recipe[1].split(',')[1]);\n        let size = [Number(recipe[2])];\n        sample = math.random(size, min, max);\n      } else if (recipe[0] == 'range' || recipe[0] == 'r') {\n        let start = Number(recipe[1].split(',')[0]);\n        let end = Number(recipe[1].split(',')[1]);\n        let step = Number(recipe[2]);\n        let range = math.range(start, end, step);\n        sample = [];\n        range.forEach(value => {\n          sample.push(Number(parseFloat(value).toPrecision(4)));\n        });\n      } else if (recipe[0] == 'linspace' || recipe[0] == 'l') {\n        let start = Number(recipe[1].split(',')[0]);\n        let end = Number(recipe[1].split(',')[1]);\n        let num = Number(recipe[2]);\n        let step = (end - start) / (num - 1);\n        let linspace = math.range(start, end, step, true);\n        sample = [];\n        linspace.forEach(value => {\n          sample.push(Number(parseFloat(value).toPrecision(4)));\n        });\n      } else if (recipe[0] == 'movie' || recipe[0] == 'm') {\n        let list = recipe[1].split(',');\n        let tmp: any[] = [];\n        list.forEach((value: string) => {\n          tmp.push(Number(parseFloat(value).toPrecision(4)));\n        });\n        sample = [];\n        sample.push(tmp);\n      } else {\n        let list = recipe[0].split(',');\n        sample = [];\n        list.forEach((value: string) => {\n          sample.push(Number(parseFloat(value).toPrecision(4)));\n        });\n      }\n    } else {\n      if (isNaN(row) == false) {\n        console.log('single number', row);\n        sample = [];\n        sample.push(row);\n      }\n    }\n\n    return sample;\n  }\n\n  private vectorize(obj: any, type: string) {\n    let tmp: any;\n    if (type == 'array') {\n      tmp = [];\n      obj.forEach((row: any) => {\n        tmp.push(...this.parseAndGenerate(row));\n      });\n    } else if (type == 'cartesianObj') {\n      \n      tmp = {x: [], y: [], z: []};\n\n      let tmp2: any = {x: [], y: [], z: []};\n\n      for (let axis in obj) {\n        if (obj.hasOwnProperty(axis)) {\n          obj[axis].forEach((row: any) => {\n            tmp2[axis].push(...this.parseAndGenerate(row));\n          });\n        }\n      }\n\n      if (!(tmp2.x.length == tmp2.y.length && tmp2.y.length == tmp2.z.length)) {\n        tmp2.x.forEach((x: number) => {\n          tmp2.y.forEach((y: number) => {\n            tmp2.z.forEach((z: number) => {\n              tmp.x.push(x);\n              tmp.y.push(y);\n              tmp.z.push(z);\n            });\n          });\n        });\n      } else {\n        tmp.x = tmp2.x;\n        tmp.y = tmp2.y;\n        tmp.z = tmp2.z;\n      }\n    }\n    return tmp;\n  }\n}\n\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","__webpack_require__.amdD = function () {\n\tthrow new Error('define cannot be used indirect');\n};","__webpack_require__.amdO = {};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t179: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkIds[i]] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkmkfiles\"] = self[\"webpackChunkmkfiles\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [817], () => (__webpack_require__(48519)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["taskParamSchema","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","firebaseApp","initializeApp","auth","getAuth","provider","GoogleAuthProvider","addScope","getRedirectResult","then","result","console","log","user","email","currentUser","signInWithRedirect","functions","getFunctions","db","getFirestore","storage","getStorage","storageRef","ref","rootRef","isRoot","mkq","Mkquery","mkf","Mkfinder","bqListDatasets","httpsCallable","bqDatasetList","datasetList","bqOptgroup","document","querySelector","data","forEach","dataset","option","createElement","value","textContent","appendChild","rfidToggle","qryLocSelc","fieldSelector","homeLink","paramsLink","paramstorageLink","sceneParamsLink","dailyDataLink","marmosetsLink","window","addEventListener","evt","preventDefault","dispatchEvent","Event","listStorageFiles","ev","decodeQuery","collection","docs","listFirestoreDocs","queryResult","fs","ki0","ki1","ki2","goBtn","plotX","plotY","plotBtn","style","visibility","resetPlaceholder","removeElementsByClassName","nameMarmosets","setAttribute","sexMarmosets","rfidMarmosets","breedingMarmosets","birthdateMarmosets","fieldSelectorMarmosets","agentTypeCurDate","fieldSelectorMkturk","identityObjects","meshObjects","nounObjects","fieldSelectorObjects","nameCurDate","bqAgentDate","field","queryForm","keywordInputs","querySelectorAll","i","length","placeholder","cName","elements","getElementsByClassName","parentNode","removeChild","async","qryLoc","k0","k1","k2","queryParam","queryStr","query","push","keyword","error","alert","mkquery","mkbquery","startsWith","eval","ret","checked","finder","selectRow","mke","displayFirebaseTextFile","getData","test","decodeBigQuery","Array","isArray","listBigQueryTable","constructor","this","Tabulator","previousPath","getApp","selectedImages","backBtn","showImagesBtn","numImgSlider","downloadBtn","pathName","backBtnAction","showImagesBtnAction","numImgSliderAction","downloadBtnAction","refreshStorageTable","mkt","Mkthree","mki","Mkimage","Mkeditor","mkc","Mkchart","dataArr","database","displayFirestoreTable","timestampToDate","makeActiveBtn","display","storeParamBtn","destroy","innerText","index","layout","initialSort","column","dir","columns","title","width","headerSort","selectable","selectableRangeMode","rowClick","event","row","stopPropagation","removeImages","editorDivElement","zIndex","imgCanvasDiv","canvas","populateAxisFields","rowTap","tableBuilt","selectAllBox","deselectRow","visible","_timestampToDate","element","idx","arr","toDate","toJSON","time","key","Object","keys","isDict","e","key2","isString","isNumber","timeEnd","val","String","isFinite","fileRef","formatFileSize","size","threshold","Math","abs","units","u","toFixed","disabled","fullPath","paramGenBtnBox","svSceneBtn","updateBtn","btnBoxDiv","gridTemplateAreas","filePromise","pathArr","split","mdArr","fileList","listAll","prefixes","folder","name","contentType","items","map","fileArr","getMetadata","md","timeCreated","Promise","all","displayStorageTable","folderRef","getActiveFile","id","parent","metadataArr","responsiveLayout","resizableColumns","widthGrow","rowDblClick","rowDblTap","includes","displayStorageTextFile","imgRef","imgName","displayImage","meshRef","displayMesh","rowSelectionChanged","rows","imageTypeTest","agent","displayBigqueryTable","displayBigQueryTableRow","dataLoaded","bqPopulateAxisFields","imgCanvas","gridTemplateColumns","getSelectedRows","file","blob","Blob","JSON","stringify","type","saveAs","docName","FirestoreDocRoot","Doctype","docname","Docname","getDownloadURL","url","fetch","editorElement","editor","activeFile","loc","updateBtnAction","makeActiveBtnAction","storeParamBtnAction","fileNameInput","fileRenameBtn","fileDupBtn","fileDupModal","renameBtnAction","renameTextFieldAction","fileDupBtnAction","genBtn","expandBtn","genBtnAction","svSceneBtnAction","pe","ParseEngine","userEditedSceneParam","generatedSceneParam","options","modes","sortObjectKeys","trackFirebaseActiveFile","timestamp","Taskdoc","Imagesdoc","sceneTemplateOptions","templates","text","fieldOfView","near","far","position","x","y","z","targetInches","color","intensity","meshpath","objectdoc","sizeInches","positionInches","rotationDegrees","material","metalness","roughness","reflectivity","opacity","transparent","morphTarget","imagebag","imageidx","taskParamOptions","onClassName","classNameParams","path","schema","EditorParams","response","json","catch","taskParamKeys","parse","properties","json2","assign","fileName","showModal","activeFileName","focus","select","close","srcFileRef","dupFileRef","dupFile","get","uploadBytes","snapshot","fileDupEvent","generateSceneParamModalAction","collapsibles","coll","classList","toggle","content","nextElementSibling","rtSize","sampling","params","n","history","editorParams","values","editable","szDiv","addRowSize","undoSz","addRow","NaN","undo","rtPos","target","posDiv","addRowPos","undoPos","rtDeg","degDiv","addRowDeg","undoDeg","curFileName","oldFileRef","newFileRef","newFile","deleteObject","renameEvent","setDoc","doc","dateToTimestamp","updatedFile","metadata","Agent","date","Date","generateParamObject","modal","modalFilename","now","toLocaleDateString","srcRef","destRef","sceneSrcFileName","sceneSrcDestRef","sceneSrcFile","_dateToTimestamp","dt","isNaN","Number","Timestamp","fromDate","toLowerCase","scene","camera","cameraPos","controls","dirLight","dirLightPos","light","loader","renderer","animationID","active","editorDiv","offsetWidth","height","offsetHeight","resizeCanvasAction","THREE","WebGLRenderer","antialias","setClearColor","physicallyCorrectLights","toneMapping","LinearToneMapping","toneMappingExposure","outputEncoding","GammaEncoding","gammaFactor","Vector3","PerspectiveCamera","set","DirectionalLight","AmbientLight","OrbitControls","domElement","Scene","add","objectMesh","loadMesh","requestAnimationFrame","animate","bind","render","meshUrl","GLTFLoader","resolve","reject","load","gltf","traverse","child","MeshPhongMaterial","morphTargets","needsUpdate","clear","cancelAnimationFrame","imgGallery","getElementById","li","imgDiv","img","imgLabel","innerHTML","src","google","charts","packages","chartDiv","finderDiv","isActive","isBigQuery","plotBtnAction","vizData","visualization","DataTable","addColumn","parseFloat","clientWidth","chart","LineChart","legend","pointSize","draw","eyedataObj","addAxisOption","optionX","optionY","bqQuery","rfidMode","queryParams","queryString","_mkquery","DAY_TO_MS","dateStr","refDate","trim","upperDate","lowerDate","range","substring","getTime","getDocs","querySnapshot","empty","promises","loadData","queryDateLower","queryDateUpper","setDate","getDate","str","obj","scheme","userObj","totalLen","minLen","maxLen","module","parseAndGenerate2","key3","tmp","err","Error","message","genParamObj","hasOwnProperty","vectorize","normal","mu","sigma","u1","math","random","u2","R_sq","multiply","theta","pi","z1","dotMultiply","sqrt","cos","sample","prototype","toString","call","recipe","min","max","start","end","step","toPrecision","linspace","list","parseAndGenerate","tmp2","axis","__webpack_module_cache__","deferred","__webpack_require__","moduleId","cachedModule","undefined","exports","loaded","__webpack_modules__","m","amdD","amdO","O","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","every","splice","r","d","definition","o","defineProperty","enumerable","g","globalThis","Function","prop","Symbol","toStringTag","nmd","paths","children","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","self","__webpack_exports__"],"sourceRoot":""}