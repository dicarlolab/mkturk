{"version":3,"sources":["webpack:///./src/editor-params.ts","webpack:///./src/main.ts","webpack:///./src/mkfinder.ts","webpack:///./src/mkmedia.ts","webpack:///./src/mkquery.ts","webpack:///./src/parser.ts","webpack:///webpack/bootstrap","webpack:///webpack/runtime/chunk loaded","webpack:///webpack/runtime/amd define","webpack:///webpack/runtime/amd options","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/global","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/make namespace object","webpack:///webpack/runtime/node module decorator","webpack:///webpack/runtime/jsonp chunk loading","webpack:///webpack/startup"],"names":["taskParamSchema","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","initializeApp","provider","auth","GoogleAuthProvider","addScope","getRedirectResult","then","result","user","console","log","email","currentUser","signInWithRedirect","functions","db","firestore","storage","storageRef","ref","rootRef","child","isRoot","mkq","Mkquery","mkf","Mkfinder","bqListDatasets","httpsCallable","bqDatasetList","datasetList","bqOptgroup","document","querySelector","data","forEach","dataset","option","createElement","value","textContent","appendChild","rfidToggle","qryLocSelc","fieldSelector","homeLink","paramsLink","paramstorageLink","sceneParamsLink","dailyDataLink","marmosetsLink","window","addEventListener","evt","preventDefault","dispatchEvent","Event","listStorageFiles","ev","decodeQuery","collection","docs","listFirestoreDocs","queryResult","fs","ki0","ki1","ki2","goBtn","plotX","plotY","plotBtn","style","visibility","resetPlaceholder","removeElementsByClassName","nameMarmosets","setAttribute","sexMarmosets","rfidMarmosets","breedingMarmosets","birthdateMarmosets","fieldSelectorMarmosets","agentTypeCurDate","fieldSelectorMkturk","identityObjects","meshObjects","nounObjects","fieldSelectorObjects","nameCurDate","bqAgentDate","field","queryForm","keywordInputs","querySelectorAll","i","length","placeholder","cName","elements","getElementsByClassName","parentNode","removeChild","async","qryLoc","k0","k1","k2","queryParam","queryStr","query","push","keyword","error","alert","mkquery","mkbquery","startsWith","eval","ret","checked","finder","selectRow","mke","displayFirebaseTextFile","getData","test","decodeBigQuery","listBigQueryTable","this","Tabulator","previousPath","selectedImages","backBtn","showImagesBtn","numImgSlider","downloadBtn","pathName","backBtnAction","showImagesBtnAction","numImgSliderAction","downloadBtnAction","refreshStorageTable","mkt","Mkthree","mki","Mkimage","Mkeditor","mkc","Mkchart","dataArr","database","displayFirestoreTable","timestampToDate","makeActiveBtn","display","storeParamBtn","destroy","innerText","index","layout","initialSort","column","dir","columns","title","width","headerSort","selectable","selectableRangeMode","rowClick","event","row","stopPropagation","removeImages","editorDivElement","zIndex","imgCanvasDiv","canvas","populateAxisFields","rowTap","tableBuilt","selectAllBox","deselectRow","visible","_timestampToDate","element","idx","arr","toDate","toJSON","time","key","Object","keys","Array","isArray","isDict","e","key2","isString","isNumber","timeEnd","val","constructor","String","isFinite","fileRef","formatFileSize","size","threshold","Math","abs","units","u","toFixed","disabled","fullPath","paramGenBtnBox","svSceneBtn","updateBtn","btnBoxDiv","gridTemplateAreas","filePromise","pathArr","split","mdArr","fileList","listAll","prefixes","folder","name","contentType","items","map","fileArr","getMetadata","md","timeCreated","Promise","all","displayStorageTable","folderRef","getActiveFile","id","parent","metadataArr","responsiveLayout","resizableColumns","widthGrow","rowDblClick","rowDblTap","includes","displayStorageTextFile","imgRef","imgName","displayImage","meshRef","displayMesh","rowSelectionChanged","rows","imageTypeTest","agent","displayBigqueryTable","displayBigQueryTableRow","dataLoaded","bqPopulateAxisFields","imgCanvas","gridTemplateColumns","getSelectedRows","file","blob","Blob","JSON","stringify","type","saveAs","docName","FirestoreDocRoot","Doctype","docname","Docname","getDownloadURL","url","fetch","editorElement","editor","activeFile","loc","updateBtnAction","makeActiveBtnAction","storeParamBtnAction","fileNameInput","fileRenameBtn","fileDupBtn","fileDupModal","renameBtnAction","renameTextFieldAction","fileDupBtnAction","genBtn","expandBtn","genBtnAction","svSceneBtnAction","pe","ParseEngine","userEditedSceneParam","generatedSceneParam","options","modes","sortObjectKeys","trackFirebaseActiveFile","timestamp","Taskdoc","Imagesdoc","sceneTemplateOptions","templates","text","fieldOfView","near","far","position","x","y","z","targetInches","color","intensity","meshpath","objectdoc","sizeInches","positionInches","rotationDegrees","material","metalness","roughness","reflectivity","opacity","transparent","morphTarget","imagebag","imageidx","taskParamOptions","onClassName","classNameParams","path","schema","EditorParams","fileUrl","catch","response","json","taskParamKeys","parse","properties","json2","assign","fileName","showModal","activeFileName","focus","select","close","srcFileRef","dupFileRef","dupFile","get","put","snapshot","fileDupEvent","collapsibles","coll","classList","toggle","content","nextElementSibling","rtSize","sampling","params","n","history","editorParams","values","editable","szDiv","addRowSize","undoSz","addRow","NaN","undo","rtPos","target","posDiv","addRowPos","undoPos","rtDeg","degDiv","addRowDeg","undoDeg","curFileName","oldFileRef","newFileRef","newFile","delete","renameEvent","doc","set","dateToTimestamp","updatedFile","metadata","Agent","date","Date","generateParamObject","modal","modalFilename","now","toLocaleDateString","srcRef","destRef","sceneSrcFileName","sceneSrcDestRef","sceneSrcFile","sns","_dateToTimestamp","dt","isNaN","Number","Timestamp","fromDate","toLowerCase","scene","camera","cameraPos","controls","dirLight","dirLightPos","light","loader","renderer","animationID","active","editorDiv","offsetWidth","height","offsetHeight","resizeCanvasAction","THREE","WebGLRenderer","antialias","setClearColor","physicallyCorrectLights","toneMapping","LinearToneMapping","toneMappingExposure","outputEncoding","GammaEncoding","gammaFactor","Vector3","PerspectiveCamera","DirectionalLight","AmbientLight","OrbitControls","domElement","Scene","add","objectMesh","loadMesh","requestAnimationFrame","animate","bind","render","meshUrl","GLTFLoader","resolve","reject","load","gltf","traverse","MeshPhongMaterial","morphTargets","needsUpdate","clear","cancelAnimationFrame","imgGallery","getElementById","li","imgDiv","img","imgLabel","innerHTML","src","google","charts","packages","chartDiv","finderDiv","isActive","isBigQuery","plotBtnAction","vizData","visualization","DataTable","addColumn","parseFloat","clientWidth","chart","LineChart","legend","pointSize","draw","eyedataObj","addAxisOption","optionX","optionY","bqQuery","rfidMode","queryParams","queryString","_mkquery","DAY_TO_MS","dateStr","refDate","trim","upperDate","lowerDate","range","substring","getTime","querySnapshot","empty","promises","loadData","queryDateLower","queryDateUpper","setDate","getDate","str","obj","scheme","userObj","totalLen","minLen","maxLen","module","parseAndGenerate2","key3","tmp","err","Error","message","hasOwnProperty","vectorize","mu","sigma","u1","math","random","u2","R_sq","multiply","theta","pi","z1","dotMultiply","sqrt","cos","sample","prototype","toString","call","recipe","normal","min","max","start","end","step","toPrecision","linspace","list","parseAndGenerate","tmp2","axis","__webpack_module_cache__","deferred","__webpack_require__","moduleId","cachedModule","undefined","exports","loaded","__webpack_modules__","m","amdD","amdO","O","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","every","splice","d","definition","o","defineProperty","enumerable","g","globalThis","Function","prop","r","Symbol","toStringTag","nmd","paths","children","installedChunks","179","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","__webpack_exports__"],"mappings":"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","file":"main.bundle.js","sourcesContent":["export const taskParamSchema = {\n  \"title\": \"MkTurk Task Params\",\n  \"description\": \"Object containing MkTurk task parameters\",\n  \"type\": \"object\",\n  \"properties\": {\n    \"Agent\": {\n      \"type\": \"string\"\n    },\n    \"CheckRFID\": {\n      \"type\": \"integer\"\n    },\n    \n    \"Automator\": {\n      \"type\": [\n        \"string\",\n        \"integer\"\n      ]\n    },\n    \"AutomatorFilePath\": {\n      \"type\": \"string\",\n      \"examples\": [\n        \"/mkturkfiles/paramterfiles/automators/touch_m2s_objectome.json\"\n      ]\n    },\n    \"CurrentAutomatorStage\": {\n      \"type\": \"integer\"\n    },\n    \"MinPercentCriterion\": {\n      \"type\": \"integer\"\n    },\n    \"MinTrialsCriterion\": {\n      \"type\": \"integer\"\n    },\n\n\n\n    \"DragtoRespond\": {\n      \"type\": \"integer\",\n    },\n    \"CalibrateEye\": {\n      \"type\": \"integer\",\n    },\n    \"NRSVP\": {\n      \"type\": \"integer\",\n    },\n    \"SameDifferent\": {\n      \"type\": \"integer\",\n    },\n    \"SamplingStrategy\": {\n      \"type\": \"string\"\n    },\n    \"NStickyResponse\": {\n      \"type\": \"integer\"\n    },\n    \"NTrialsPerBagBlock\": {\n      \"type\": \"integer\"\n    },\n\n\n    \"NGridPoints\": {\n      \"type\": \"integer\",\n      \"minimum\": 1\n    },\n    \"GridSpacingInches\": {\n      \"type\": \"number\"\n    },\n    \"GridXOffsetInches\": {\n      \"type\": \"number\"\n    },\n    \"GridYOffsetInches\": {\n      \"type\": \"number\"\n    },\n    \"FixationGridIndex\": {\n      \"type\": \"integer\",\n      \"minimum\": -1\n    },\n    \"SampleGridIndex\": {\n      \"type\": \"integer\",\n      \"minimum\": -1\n    },\n    \"ObjectGridIndex\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"integer\",\n        \"minimum\": 0\n      }\n    },\n    \"ChoiceGridIndex\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"integer\",\n        \"minimum\": 0\n      }\n    },\n    \"TestGridIndex\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"integer\",\n        \"minimum\": 0\n      }\n    },\n\n    \n\n    \"NFixations\": {\n      \"type\": \"integer\",\n      \"minimum\": 1\n    },\n    \"FixationUsesSample\": {\n      \"type\": \"integer\",\n    },\n    \"FixationSizeInches\": {\n      \"type\": \"number\"\n    },\n    \"FixationDuration\": {\n      \"type\": \"integer\"\n    },\n    \"FixationTimeOut\": {\n      \"type\": \"integer\"\n    },\n\n\n    \"FixationWindowSizeInches\": {\n      \"type\": \"number\"\n    },\n    \"FixationDotSizeInches\": {\n      \"type\": \"number\"\n    },\n\n\n    \"ImageBagsSample\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"string\"\n      }\n    },\n    \"KeepSampleON\": {\n      \"type\": \"integer\",\n    },\n    \"SamplePRE\": {\n      \"type\": \"integer\",\n      \"minimum\": 0\n    },\n    \"SampleOFF\": {\n      \"type\": \"integer\",\n      \"minimum\": 0\n    },\n\n    \"ImageBagsTest\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"string\"\n      }\n    },\n    \"KeepTestON\": {\n      \"type\": \"integer\",\n    },\n    \"TestOFF\": {\n      \"type\": \"integer\",\n    },\n    \"HideTestDistractors\": {\n      \"type\": \"integer\",\n    },\n\n    \"ChoiceSizeInches\": {\n      \"type\": \"number\",\n      \"minimum\": 0\n    },\n    \"HideChoiceDistractors\": {\n      \"type\": \"integer\",\n    },\n    \"ChoiceTimeOut\": {\n      \"type\": \"integer\",\n      \"minimum\": 0\n    },\n\n\n    \"RewardStage\": {\n      \"type\": \"integer\",\n    },\n    \"RewardPer1000Trials\": {\n      \"type\": \"integer\",\n    },\n    \"NRewardMax\": {\n      \"type\": \"integer\",\n    },\n    \"NConsecutiveHitsforBonus\": {\n      \"type\": \"integer\",\n    },\n    \"PunishTimeOut\": {\n      \"type\": \"integer\",\n      \"minimum\": 0\n    },\n    \"ConsecutiveHitsITI\": {\n      \"type\": \"integer\",\n      \"minimum\": 0\n    },\n\n\n\n\n\n    \"InterTrialInterval\": {\n      \"type\": \"integer\",\n      \"minimum\": 0\n    },\n    \"BackgroundColor2D\": {\n      \"type\": \"string\",\n    },\n    \"Homecage\": {\n      \"type\": \"integer\",\n    },\n    \"Separated\": {\n      \"type\": \"integer\",\n    },\n    \"Species\": {\n      \"type\": \"string\",\n      \"examples\": [\n        \"human\",\n        \"marmoset\",\n        \"model\"\n      ],\n    },\n    \"Liquid\": {\n      \"type\": \"integer\",\n    },\n  }\n};","import firebase from \"firebase/app\";\nimport \"firebase/firestore\";\nimport \"firebase/storage\";\nimport \"firebase/auth\";\nimport \"firebase/functions\";\nimport './mkfiles.css';\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyA0fbv2VqE-AfF6V_nxSSXCEqaTlBlZnTI\",\n  authDomain: \"sandbox-ce2c5.firebaseapp.com\",\n  databaseURL: \"https://sandbox-ce2c5.firebaseio.com\",\n  projectId: \"sandbox-ce2c5\",\n  storageBucket: \"sandbox-ce2c5.appspot.com\",\n  messagingSenderId: \"1003719887944\"\n};\nfirebase.initializeApp(firebaseConfig);\n\nimport { Mkquery } from \"./mkquery\";\nimport { Mkfinder } from \"./mkfinder\";\n\nlet provider = new firebase.auth.GoogleAuthProvider();\nprovider.addScope(\"https://www.googleapis.com/auth/contacts.readonly\");\nfirebase.auth().getRedirectResult().then(result => {\n  if (result.user) {\n    console.log(\"Sign-In Redirect Result, USER:\", result.user.email, \"is signed in\");\n  } else if (firebase.auth().currentUser) {\n    console.log(\"Sign-In Redirect Result, USER:\", \"is signed in\");\n  } else {\n    firebase.auth().signInWithRedirect(provider);\n  }\n});\n\nconst functions = firebase.functions();\nconst db = firebase.firestore();\nconst storage = firebase.storage();\nconst storageRef = storage.ref(); \nconst rootRef = storageRef.child(\"mkturkfiles/\");\nlet isRoot = true;\n\nlet mkq = new Mkquery();\nlet mkf = new Mkfinder();\n\nlet bqListDatasets = functions.httpsCallable('bqListDatasets');\n\nlet bqDatasetList = bqListDatasets();\nbqDatasetList.then((datasetList: any) => {\n  let bqOptgroup = \n    document.querySelector('#bigquery-optgroup') as HTMLOptGroupElement;\n  datasetList.data.forEach((dataset: any) => {\n    let option = document.createElement('option');\n    option.value = dataset;\n    option.textContent = 'bq/' + dataset;\n    bqOptgroup.appendChild(option);\n  });\n});\n\n\nlet rfidToggle = document.querySelector(\"#rfid-switch\") as HTMLInputElement;\nlet qryLocSelc = document.querySelector(\"#qry-loc-selector\") as HTMLSelectElement;\nlet fieldSelector =\n    document.querySelector(\"#field-selector\") as HTMLSelectElement;\n\n\n/* Quick Links */\nlet homeLink\n  = document.querySelector('#quick-link-home') as HTMLElement;\nlet paramsLink =\n    document.querySelector(\"#quick-link-params\") as HTMLElement;\nlet paramstorageLink\n  = document.querySelector('#quick-link-paramstorage') as HTMLElement;\nlet sceneParamsLink =\n    document.querySelector(\"#quick-link-sceneparams\") as HTMLElement;\nlet dailyDataLink = \n  document.querySelector('#quick-link-dailydata') as HTMLElement;\nlet marmosetsLink = \n    document.querySelector(\"#quick-link-marmosets\") as HTMLElement;\n\n\nwindow.addEventListener('load', (evt: Event) => {\n  evt.preventDefault();\n\n  isRoot = false;\n  qryLocSelc.value = \"mkturkfiles\";\n  qryLocSelc.dispatchEvent(new Event(\"change\"));\n  mkf.listStorageFiles(storageRef.child(\"mkturkfiles\"));\n});\n\n\nmarmosetsLink.addEventListener(\"click\", (ev: Event) => {\n  ev.preventDefault();\n\n  qryLocSelc.value = \"marmosets\";\n  fieldSelector!.value = \"name\";\n  qryLocSelc!.dispatchEvent(new Event(\"change\"));\n  fieldSelector!.dispatchEvent(new Event(\"change\"));\n\n  let ret = mkq.decodeQuery(db.collection(\"marmosets\"));\n  ret.then(docs => {\n    mkf.listFirestoreDocs(docs, \"marmosets\");\n  });\n\n});\n\nparamsLink.addEventListener(\"click\" || \"pointerup\", (ev: Event) => {\n  ev.preventDefault();\n\n  isRoot = false;\n  qryLocSelc.value = \"mkturkfiles\";\n  qryLocSelc.dispatchEvent(new Event(\"change\"));\n  mkf.listStorageFiles(storageRef.child(\"mkturkfiles/parameterfiles/subjects\"));\n\n});\n\nparamstorageLink.addEventListener('click' || 'pointerup', (ev: Event) => {\n  ev.preventDefault();\n\n  isRoot = false;\n  qryLocSelc.value = 'mkturkfiles';\n  qryLocSelc.dispatchEvent(new Event('change'));\n  mkf.listStorageFiles(storageRef.child('mkturkfiles/parameterfiles/params_storage'));\n});\n\nhomeLink.addEventListener(\"click\" || \"pointerup\", (ev: Event) => {\n  ev.preventDefault();\n\n  isRoot = false;\n  qryLocSelc.value = \"mkturkfiles\";\n  qryLocSelc.dispatchEvent(new Event(\"change\"));\n  mkf.listStorageFiles(storageRef.child(\"mkturkfiles\"));\n\n});\n\nsceneParamsLink.addEventListener(\"click\" || \"pointerup\", (ev: Event) => {\n  ev.preventDefault();\n\n  isRoot = false;\n  qryLocSelc.value = \"mkturkfiles\";\n  qryLocSelc.dispatchEvent(new Event(\"change\"));\n  mkf.listStorageFiles(storageRef.child(\"mkturkfiles/scenebags/objectome3d\"));\n\n});\n\ndailyDataLink.addEventListener('click' || 'pointerup', (ev: Event) => {\n  ev.preventDefault();\n  isRoot = false;\n  qryLocSelc.value = \"mkturkfiles\";\n  qryLocSelc.dispatchEvent(new Event('change'));\n  mkf.listStorageFiles(storageRef.child('mkturkfiles/mkdailydata'));\n});\n\nqryLocSelc!.addEventListener(\"change\", ev => {\n\n  let fs = document.querySelector(\"#field-selector\") as HTMLSelectElement;\n  let ki0 = document.querySelector(\"#keyword-input-0\") as HTMLInputElement;\n  let ki1 = document.querySelector(\"#keyword-input-1\") as HTMLInputElement;\n  let ki2 = document.querySelector(\"#keyword-input-2\") as HTMLInputElement;\n  let goBtn = document.querySelector(\"#go-btn\") as HTMLButtonElement;\n  let plotX = document.querySelector(\"#quick-plot-x\") as HTMLSelectElement;\n  let plotY = document.querySelector(\"#quick-plot-y\") as HTMLSelectElement;\n  let plotBtn = document.querySelector(\"#plot-btn\") as HTMLButtonElement;\n  let queryResult: Promise<any[]>;\n  \n  switch(qryLocSelc.value) {\n    case \"marmosets\":\n      \n      fs.style.visibility = \"visible\";\n      ki0.style.visibility = \"visible\";\n      ki1.style.visibility = \"hidden\";\n      ki2.style.visibility = \"hidden\";\n      goBtn.style.visibility = \"visible\";\n\n      resetPlaceholder();\n      removeElementsByClassName(\"field-options\");\n\n      let nameMarmosets = document.createElement(\"option\");\n      nameMarmosets.setAttribute(\"class\", \"field-options\");\n      nameMarmosets.setAttribute(\"value\", \"name\");\n      nameMarmosets.setAttribute(\"selected\", \"true\");\n      nameMarmosets.textContent = \"name\";\n\n      let sexMarmosets = document.createElement(\"option\");\n      sexMarmosets.setAttribute(\"class\", \"field-options\");\n      sexMarmosets.setAttribute(\"value\", \"sex\");\n      sexMarmosets.textContent = \"sex\";\n\n      let rfidMarmosets = document.createElement(\"option\");\n      rfidMarmosets.setAttribute(\"class\", \"field-options\");\n      rfidMarmosets.setAttribute(\"value\", \"rfid\");\n      rfidMarmosets.textContent = \"RFID\";\n\n      let breedingMarmosets = document.createElement(\"option\");\n      breedingMarmosets.setAttribute(\"class\", \"field-options\");\n      breedingMarmosets.setAttribute(\"value\", \"breeding\");\n      breedingMarmosets.textContent = \"breeding\";\n\n      let birthdateMarmosets = document.createElement(\"option\");\n      birthdateMarmosets.setAttribute(\"class\", \"field-options\");\n      birthdateMarmosets.setAttribute(\"value\", \"birthdate\");\n      birthdateMarmosets.textContent = \"birthdate\";\n\n      let fieldSelectorMarmosets\n        = document.querySelector(\"#field-selector\") as HTMLSelectElement;\n      fieldSelectorMarmosets.appendChild(nameMarmosets);\n      fieldSelectorMarmosets.appendChild(sexMarmosets);\n      fieldSelectorMarmosets.appendChild(rfidMarmosets);\n      fieldSelectorMarmosets.appendChild(breedingMarmosets);\n      fieldSelectorMarmosets.appendChild(birthdateMarmosets);\n      fieldSelectorMarmosets.dispatchEvent(new Event(\"change\"));\n  \n      break;\n\n    case \"mkturkdata\":\n      fs.style.visibility = \"visible\";\n      ki0.style.visibility = \"visible\";\n      ki1.style.visibility = \"visible\";\n      ki2.style.visibility = \"visible\";\n      goBtn.style.visibility = \"visible\";\n      plotX.style.visibility = \"hidden\";\n      plotY.style.visibility = \"hidden\";\n      plotBtn.style.visibility = \"hidden\";\n\n      resetPlaceholder();\n      removeElementsByClassName(\"field-options\");\n\n      let agentTypeCurDate = document.createElement(\"option\");\n      agentTypeCurDate.setAttribute(\"class\", \"field-options\");\n      agentTypeCurDate.setAttribute(\"value\", \"agentTypeCurDate\");\n      agentTypeCurDate.setAttribute(\"selected\", \"true\");\n      agentTypeCurDate.textContent = \"Agent & Doctype & CurrentDate\";\n\n      let fieldSelectorMkturk \n        = document.querySelector(\"#field-selector\") as HTMLSelectElement;\n      fieldSelectorMkturk.appendChild(agentTypeCurDate);\n      fieldSelectorMkturk.dispatchEvent(new Event(\"change\"));\n\n      break;\n\n    case \"objects\":\n      fs.style.visibility = \"visible\";\n      ki0.style.visibility = \"visible\";\n      ki1.style.visibility = \"hidden\";\n      ki2.style.visibility = \"hidden\";\n      goBtn.style.visibility = \"visible\";\n      plotX.style.visibility = \"hidden\";\n      plotY.style.visibility = \"hidden\";\n      plotBtn.style.visibility = \"hidden\";\n\n      resetPlaceholder();\n      removeElementsByClassName(\"field-options\");\n\n      let identityObjects = document.createElement(\"option\");\n      identityObjects.setAttribute(\"class\", \"field-options\");\n      identityObjects.setAttribute(\"value\", \"identity\");\n      identityObjects.setAttribute(\"selected\", \"true\");\n      identityObjects.textContent = \"identity\";\n\n      let meshObjects = document.createElement(\"option\");\n      meshObjects.setAttribute(\"class\", \"field-options\");\n      meshObjects.setAttribute(\"value\", \"mesh\");\n      meshObjects.textContent = \"mesh\";\n\n      let nounObjects = document.createElement(\"option\");\n      nounObjects.setAttribute(\"class\", \"field-options\");\n      nounObjects.setAttribute(\"value\", \"noun\");\n      nounObjects.textContent = \"noun\";\n\n      let fieldSelectorObjects\n        = document.querySelector(\"#field-selector\") as HTMLSelectElement;\n      fieldSelectorObjects.appendChild(identityObjects);\n      fieldSelectorObjects.appendChild(meshObjects);\n      fieldSelectorObjects.appendChild(nounObjects);\n      fieldSelectorObjects.dispatchEvent(new Event(\"change\"));\n\n      break;\n\n    case \"mkdailydata\":\n      let ret = mkq.decodeQuery(db.collection('mkdailydata'));\n      ret.then(docs => {\n        mkf.listFirestoreDocs(docs, 'mkdailydata');\n      });\n\n      break;\n\n    case \"mkdailydatatest\":\n      let retTest = mkq.decodeQuery(db.collection('mkdailydatatest'));\n      retTest.then(docs => {\n        mkf.listFirestoreDocs(docs, 'mkdailydatatest');\n      });\n\n      break;\n\n    case \"mkturkfiles\":\n      fs.style.visibility = \"hidden\";\n      ki0.style.visibility = \"hidden\";\n      ki1.style.visibility = \"hidden\";\n      ki2.style.visibility = \"hidden\";\n      goBtn.style.visibility = \"hidden\";\n      plotX.style.visibility = \"hidden\";\n      plotY.style.visibility = \"hidden\";\n      plotBtn.style.visibility = \"hidden\";\n\n      removeElementsByClassName(\"field-options\");\n      if (isRoot) {\n        mkf.listStorageFiles(rootRef);\n      }\n      break;\n\n    case \"devices\":\n      fs.style.visibility = \"hidden\";\n      ki0.style.visibility = \"hidden\";\n      ki1.style.visibility = \"hidden\";\n      ki2.style.visibility = \"hidden\";\n      goBtn.style.visibility = \"hidden\";\n      plotX.style.visibility = \"hidden\";\n      plotY.style.visibility = \"hidden\";\n      plotBtn.style.visibility = \"hidden\";\n\n      resetPlaceholder();\n      removeElementsByClassName(\"field-options\");\n\n      queryResult = mkq.decodeQuery(db.collection(\"devices\"));\n      queryResult.then(docs => {\n        mkf.listFirestoreDocs(docs, \"devices\");\n      });\n\n      break;\n\n    case \"eyecalibrations\":\n      console.log('eye');\n      fs.style.visibility = \"hidden\";\n      ki0.style.visibility = \"hidden\";\n      ki1.style.visibility = \"hidden\";\n      ki2.style.visibility = \"hidden\";\n      goBtn.style.visibility = \"hidden\";\n      plotX.style.visibility = \"hidden\";\n      plotY.style.visibility = \"hidden\";\n      plotBtn.style.visibility = \"hidden\";\n\n      resetPlaceholder();\n      removeElementsByClassName(\"field-options\");\n\n      queryResult = mkq.decodeQuery(db.collection(\"eyecalibrations\"));\n      queryResult.then(docs => {\n        mkf.listFirestoreDocs(docs, \"eyecalibrations\");\n      });\n\n      break;\n\n    case \"mkscale\":\n      fs.style.visibility = \"visible\";\n      ki0.style.visibility = \"visible\";\n      ki1.style.visibility = \"visible\";\n      ki2.style.visibility = \"hidden\";\n      goBtn.style.visibility = \"visible\";\n      plotX.style.visibility = \"visible\";\n      plotY.style.visibility = \"visible\";\n      plotBtn.style.visibility = \"visible\";\n\n      resetPlaceholder();\n      removeElementsByClassName(\"field-options\");\n\n      let nameCurDate = document.createElement(\"option\");\n      nameCurDate.setAttribute(\"class\", \"field-options\");\n      nameCurDate.setAttribute(\"value\", \"nameCurDate\");\n      nameCurDate.setAttribute(\"selected\", \"true\");\n      nameCurDate.textContent = \"Name & CurrentDate\";\n\n      fs.appendChild(nameCurDate);\n      fs.dispatchEvent(new Event(\"change\"));\n\n      break;\n\n    case \"eyedata\":\n      fs.style.visibility = \"visible\";\n      ki0.style.visibility = \"visible\";\n      ki1.style.visibility = \"visible\";\n      ki2.style.visibility = \"hidden\";\n      goBtn.style.visibility = \"visible\";\n      plotX.style.visibility = \"visible\";\n      plotY.style.visibility = \"visible\";\n      plotBtn.style.visibility = \"visible\";\n\n      resetPlaceholder();\n      removeElementsByClassName(\"field-options\");\n\n      let bqAgentDate = document.createElement(\"option\");\n      bqAgentDate.setAttribute(\"class\", \"field-options\");\n      bqAgentDate.setAttribute(\"value\", \"nameCurDate\");\n      bqAgentDate.setAttribute(\"selected\", \"true\");\n      bqAgentDate.textContent = \"Name & CurrentDate\";\n\n      fs.appendChild(bqAgentDate);\n      fs.dispatchEvent(new Event(\"change\"));\n      break;\n  }\n});\n\n\nfieldSelector?.addEventListener(\"change\", ev => {\n  let field = fieldSelector?.value;\n  let ki0 = document.querySelector(\"#keyword-input-0\") as HTMLInputElement;\n  let ki1 = document.querySelector(\"#keyword-input-1\") as HTMLInputElement;\n  let ki2 = document.querySelector(\"#keyword-input-2\") as HTMLInputElement;\n  let plotX = document.querySelector(\"#quick-plot-x\") as HTMLSelectElement;\n  let plotY = document.querySelector(\"#quick-plot-y\") as HTMLSelectElement;\n  let plotBtn = document.querySelector(\"#plot-btn\") as HTMLButtonElement;\n\n\n  switch (field) {\n    case \"name\":\n      resetPlaceholder();\n      ki0.setAttribute(\"placeholder\", \"name\");\n      plotX.style.visibility = \"visible\";\n      plotY.style.visibility = \"visible\";\n      plotBtn.style.visibility = \"visible\";\n      break;\n\n    case \"sex\":\n      resetPlaceholder();\n      ki0.setAttribute(\"placeholder\", \"sex\");\n      plotX.style.visibility = \"hidden\";\n      plotY.style.visibility = \"hidden\";\n      plotBtn.style.visibility = \"hidden\";\n      break;\n\n    case \"rfid\":\n      resetPlaceholder();\n      ki0.setAttribute(\"placeholder\", \"RFID\");\n      plotX.style.visibility = \"visible\";\n      plotY.style.visibility = \"visible\";\n      plotBtn.style.visibility = \"visible\";\n      break;\n\n    case \"breeding\":\n      resetPlaceholder();\n      ki0.setAttribute(\"placeholder\", \"breeding\");\n      plotX.style.visibility = \"hidden\";\n      plotY.style.visibility = \"hidden\";\n      plotBtn.style.visibility = \"hidden\";\n      break;\n\n    case \"birthdate\":\n      resetPlaceholder();\n      ki0.setAttribute(\n        \"placeholder\", \"birthdate (e.g. 04/17/2019; +-7)\"\n      );\n      plotX.style.visibility = \"hidden\";\n      plotY.style.visibility = \"hidden\";\n      plotBtn.style.visibility = \"hidden\";\n      break;\n\n    case \"agentTypeCurDate\":\n      ki0.setAttribute(\"placeholder\", \"Agent\");\n      ki1.setAttribute(\"placeholder\", \"Doctype\");\n      ki2.setAttribute(\n        \"placeholder\", \"CurrentDate (e.g. 04/17/2019; +-7)\"\n      );\n      plotX.style.visibility = \"hidden\";\n      plotY.style.visibility = \"hidden\";\n      plotBtn.style.visibility = \"hidden\";\n      break;\n\n    case \"nameCurDate\":\n      ki0.setAttribute(\"placeholder\", \"Name\");\n      ki1.setAttribute(\n        \"placeholder\", \"CurrentDate (e.g. 04/17/2019; +-7)\"\n      );\n      break;\n    \n    case \"eyedata\":\n      ki0.setAttribute(\"placeholder\", \"Agent\");\n      ki1.setAttribute(\n        \"Placeholder\", \"Date (e.g. 04/17/2019)\"\n      );\n      break;\n  }\n});\n\nlet queryForm = document.querySelector<HTMLFormElement>(\"#mkquery-form\");\nqueryForm?.addEventListener(\"submit\", async ev => {\n  ev.preventDefault();\n  console.log(\"test weird\");\n  let qryLoc = qryLocSelc?.value;\n  let field = fieldSelector?.value;\n  let k0 = document.querySelector<HTMLInputElement>(\"#keyword-input-0\")?.value;\n  let k1 = document.querySelector<HTMLInputElement>(\"#keyword-input-1\")?.value;\n  let k2 = document.querySelector<HTMLInputElement>(\"#keyword-input-2\")?.value;\n\n  let queryParam: { field: string, keyword: string}[] = [];\n  let queryStr: string = \"\";\n  let query: firebase.firestore.Query;\n\n\n  switch(qryLoc) {\n    case \"marmosets\":\n      if (k0) {\n        queryParam.push({ field: field, keyword: k0 });\n      } else {\n        console.error(\"No query arguments!\");\n        alert(\"No query arguments!\");\n      }\n      queryStr = \"db.collection('marmosets')\" + mkq.mkquery(queryParam);\n      break;\n\n    case \"mkturkdata\":\n      if (k0) {\n        queryParam.push({ field: \"Agent\", keyword: k0});\n      }\n      if (k1) {\n        queryParam.push({ field: \"Doctype\", keyword: k1 });\n      }\n      if (k2) {\n        queryParam.push({ field: \"CurrentDate\", keyword: k2 });\n      }\n\n      if (queryParam.length > 0) {\n        queryStr = \"db.collection('mkturkdata')\" + mkq.mkquery(queryParam);\n      } else {\n        console.error(\"No query arguments!\");\n        alert(\"No query arguments!\");\n      }\n      break;\n\n    case \"objects\":\n      if (k0) {\n        queryParam.push({ field: field, keyword: k0 });\n      } else {\n        console.error(\"No query arguments!\");\n        alert(\"No query arguments!\");\n      }\n      queryStr = \"db.collection('objects')\" + mkq.mkquery(queryParam);\n      break;\n\n    case \"mkscale\":\n      if (k0) {\n        queryParam.push({ field: \"Name\", keyword: k0 });\n      }\n      if (k1) {\n        queryParam.push({ field: \"CurrentDate\", keyword: k1 });\n      }\n      \n      if (queryParam.length > 0) {\n        queryStr = \"db.collection('mkscale')\" + mkq.mkquery(queryParam);\n      } else {\n        console.error(\"No query arguments!\");\n        alert(\"No query arguments!\");\n      }\n      break;\n\n    case \"eyedata\":\n      if (k0 && k1) {\n        queryStr = mkq.mkbquery(\"eyedata\", k0, k1);\n      } else {\n        console.error(\"Incorrect query: Need two query arguments!\");\n        alert(\"Incorrect query: Need two query arguments!\");\n      }\n      break;\n  }\n  \n\n  if (queryStr.startsWith('db.collection')) {\n    query = eval(queryStr);\n    let ret = mkq.decodeQuery(query);\n    ret.then(docs => {\n      mkf.listFirestoreDocs(docs, qryLoc!);\n      if (rfidToggle.checked) {\n        mkf.finder.selectRow();\n        mkf.mke.displayFirebaseTextFile(mkf.finder.getData()[0], \"marmosets\");\n      }\n    });\n  }\n\n  else if (queryStr.startsWith('SELECT *')) {\n    let test = mkq.decodeBigQuery(queryStr);\n    console.log(test);\n    test.then(data => {\n      mkf.listBigQueryTable(data.data, qryLoc, k0!);\n    })\n  }\n  \n});\n\nfunction resetPlaceholder() {\n  let keywordInputs = \n    [...document.querySelectorAll<HTMLInputElement>(\".keyword-input\")];\n\n  for (let i = 0; i < keywordInputs.length; i++) {\n    keywordInputs[i].placeholder = \"\";\n    keywordInputs[i].value = \"\";\n  }\n}\n\nfunction removeElementsByClassName(cName: string) {\n  let elements = document.getElementsByClassName(cName);\n  while (elements.length > 0) {\n    elements[0].parentNode?.removeChild(elements[0]);\n  }\n}","import firebase from \"firebase/app\";\nimport \"firebase/firestore\";\ntype Timestamp = firebase.firestore.Timestamp;\nimport { Mkeditor, Mkthree, Mkimage, Mkchart } from \"./mkmedia\";\nimport FileSaver from \"file-saver\";\n\nconst db = firebase.firestore();\n\nexport class Mkfinder {\n  finder: Tabulator;\n  mke: Mkeditor;\n  previousPath: string;\n  storage: firebase.storage.Storage;\n  storageRef: firebase.storage.Reference;\n  backBtn: HTMLButtonElement;\n  downloadBtn: HTMLButtonElement;\n  mkt: Mkthree;\n  mki: Mkimage;\n  mkc: Mkchart;\n  numImgSlider: HTMLInputElement;\n  showImagesBtn: HTMLButtonElement;\n  selectedImages: any[];\n  pathName: HTMLParagraphElement;\n\n\n  constructor() {\n    this.finder = new Tabulator(\"#finder\");\n    this.previousPath = \"\";\n    this.storage = firebase.storage();\n    this.storageRef = this.storage.ref();\n    this.selectedImages = [];\n\n    this.backBtn = document.querySelector(\"#back-btn\") as HTMLButtonElement;\n    this.showImagesBtn = \n    document.querySelector(\"#show-images-btn\") as HTMLButtonElement;\n    this.numImgSlider = \n    document.querySelector(\"#num-image-slider\") as HTMLInputElement;\n    this.downloadBtn =\n    document.querySelector(\"#download-file\") as HTMLButtonElement;\n    this.pathName = \n    document.querySelector(\"#path-name-span\") as HTMLParagraphElement;\n    \n    this.backBtnAction();\n    this.showImagesBtnAction();\n    this.numImgSliderAction();\n    this.downloadBtnAction();\n    this.refreshStorageTable();\n\n    this.mkt = new Mkthree();\n    this.mki = new Mkimage();\n    this.mke = new Mkeditor();\n    this.mkc = new Mkchart();\n\n\n  }\n\n  public listFirestoreDocs(dataArr: any[], database: string) {\n    this.displayFirestoreTable(dataArr, database);\n  }\n\n  private displayFirestoreTable(dataArr: any[], database: string) {\n    \n    dataArr = this.timestampToDate(dataArr);\n    this.mke.makeActiveBtn.style.display = \"none\";\n    this.mke.storeParamBtn.style.display = 'none';\n    \n\n    if (database == \"marmosets\") {\n      this.finder.destroy();\n      this.pathName.innerText = \"marmosets\";\n      this.finder = new Tabulator(\"#finder\", {\n        data: dataArr,\n        index: \"name\",\n        layout: \"fitColumns\",\n        initialSort: [\n          {column: \"name\", dir: \"asc\"}\n        ],\n        columns: [\n          {title: \"<input id='select-all' type='checkbox'/>\", width: 15, headerSort: false},\n          {title: \"Name\", field: \"name\"},\n          {title: \"Sex\", field: \"sex\"},\n          {title: \"DOB\", field: \"birthdate\"},\n          {title: \"RFID\", field: \"rfid\"},\n        ],\n        selectable: true,\n        selectableRangeMode: \"click\",\n        rowClick: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n          this.mkc.removeElementsByClassName(\"axis-options\");\n          this.mkc.populateAxisFields(row.getData());\n\n        },\n        rowTap: (event, row) => {\n          event.stopPropagation();\n\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n          this.mkc.removeElementsByClassName(\"axis-options\");\n          this.mkc.populateAxisFields(row.getData());\n\n        },\n        tableBuilt: () => {\n          /* selectAllBox function */\n          let selectAllBox \n            = document.querySelector(\"#select-all\") as HTMLInputElement;\n          selectAllBox.addEventListener(\"change\", ev => {\n            if (selectAllBox.checked == true) {\n              this.finder.selectRow();\n            } else {\n              this.finder.deselectRow();\n            }\n          });\n        }\n      });\n    }\n    else if (database == \"mkturkdata\") {\n      this.finder.destroy();\n      this.pathName.innerText = \"mkturkdata\";\n      this.finder = new Tabulator(\"#finder\", {\n        data: dataArr,\n        index: \"index\",\n        layout: \"fitColumns\",\n        initialSort: [\n          {column: \"Agent\", dir: \"asc\"}\n        ],\n        columns: [\n          {title: \"<input id='select-all' type='checkbox'/>\", width: 15, headerSort: false},\n          {title: \"Agent\", field: \"Agent\"},\n          {title: \"Doctype\", field: \"Doctype\"},\n          {title: \"CurrentDate\", field: \"CurrentDate\"},\n          {title: \"FirestoreDocRoot\", field: \"FirestoreDocRoot\", visible: false},\n        ],\n        selectable: true,\n        selectableRangeMode: \"click\",\n        rowClick: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n          \n        },\n        rowTap: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n        },\n        tableBuilt: () => {          \n          /* selectAllBox function */\n          let selectAllBox \n            = document.querySelector(\"#select-all\") as HTMLInputElement;\n          selectAllBox.addEventListener(\"change\", ev => {\n            if (selectAllBox.checked == true) {\n              this.finder.selectRow();\n            } else {\n              this.finder.deselectRow();\n            }\n          });\n        }\n      });\n    }\n\n    else if (database == \"mkdailydata\") {\n      this.finder.destroy();\n      this.pathName.innerText = \"mkdailydata\";\n      this.finder = new Tabulator(\"#finder\", {\n        data: dataArr,\n        index: \"index\",\n        layout: \"fitColumns\",\n        initialSort: [\n          {column: \"agent\", dir: \"asc\"}\n        ],\n        columns: [\n          {title: \"<input id='select-all' type='checkbox'/>\", width: 15, headerSort: false},\n          {title: \"Agent\", field: \"agent\"},\n        ],\n        selectable: true,\n        selectableRangeMode: \"click\",\n        rowClick: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n          \n        },\n        rowTap: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n        },\n        tableBuilt: () => {          \n          /* selectAllBox function */\n          let selectAllBox \n            = document.querySelector(\"#select-all\") as HTMLInputElement;\n          selectAllBox.addEventListener(\"change\", ev => {\n            if (selectAllBox.checked == true) {\n              this.finder.selectRow();\n            } else {\n              this.finder.deselectRow();\n            }\n          });\n        }\n      });\n    }\n\n    else if (database == \"mkdailydatatest\") {\n      this.finder.destroy();\n      this.pathName.innerText = \"mkdailydatatest\";\n      this.finder = new Tabulator(\"#finder\", {\n        data: dataArr,\n        index: \"index\",\n        layout: \"fitColumns\",\n        initialSort: [\n          {column: \"agent\", dir: \"asc\"}\n        ],\n        columns: [\n          {title: \"<input id='select-all' type='checkbox'/>\", width: 15, headerSort: false},\n          {title: \"Agent\", field: \"agent\"},\n        ],\n        selectable: true,\n        selectableRangeMode: \"click\",\n        rowClick: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n          \n        },\n        rowTap: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n        },\n        tableBuilt: () => {          \n          /* selectAllBox function */\n          let selectAllBox \n            = document.querySelector(\"#select-all\") as HTMLInputElement;\n          selectAllBox.addEventListener(\"change\", ev => {\n            if (selectAllBox.checked == true) {\n              this.finder.selectRow();\n            } else {\n              this.finder.deselectRow();\n            }\n          });\n        }\n      });\n    }\n\n    else if (database == \"objects\") {\n      this.finder.destroy();\n      this.pathName.innerText = \"objects\";\n      this.finder = new Tabulator(\"#finder\", {\n        data: dataArr,\n        index: \"docname\",\n        layout: \"fitColumns\",\n        initialSort: [\n          {column: \"identity\", dir: \"asc\"}\n        ],\n        columns: [\n          {title: \"<input id='select-all' type='checkbox'/>\", width: 15, headerSort: false},\n          {title: \"Identity\", field: \"identity\"},\n          {title: \"Mesh\", field: \"mesh\"},\n          {title: \"Noun\", field: \"noun\"},\n          {title: \"Meshfile\", field: \"meshfile\"},\n          {title: \"MeshfilePath\", field: \"meshfilepath\"},\n        ],\n        selectable: true,\n        selectableRangeMode: \"click\",\n        rowClick: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n          \n        },\n        rowTap: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n        },\n        tableBuilt: () => {          \n          /* selectAllBox function */\n          let selectAllBox \n            = document.querySelector(\"#select-all\") as HTMLInputElement;\n          selectAllBox.addEventListener(\"change\", ev => {\n            if (selectAllBox.checked == true) {\n              this.finder.selectRow();\n            } else {\n              this.finder.deselectRow();\n            }\n          });\n        }\n      });\n    }\n\n    else if (database == \"devices\") {\n      this.finder.destroy();\n      this.pathName.innerText = \"devices\";\n      this.finder = new Tabulator(\"#finder\", {\n        data: dataArr,\n        index: \"docname\",\n        layout: \"fitColumns\",\n        initialSort: [\n          {column: \"model\", dir: \"asc\"}\n        ],\n        columns: [\n          {title: \"<input id='select-all' type='checkbox'/>\", width: 15, headerSort: false},\n          {title: \"Model\", field: \"model\"},\n          {title: \"Brand\", field: \"brand\"},\n          {title: \"Type\", field: \"type\"},\n          {title: \"PPI\", field: \"ppi\"},\n        ],\n        selectable: true,\n        selectableRangeMode: \"click\",\n        rowClick: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n          \n        },\n        rowTap: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n        },\n        tableBuilt: () => {          \n          /* selectAllBox function */\n          let selectAllBox \n            = document.querySelector(\"#select-all\") as HTMLInputElement;\n          selectAllBox.addEventListener(\"change\", ev => {\n            if (selectAllBox.checked == true) {\n              this.finder.selectRow();\n            } else {\n              this.finder.deselectRow();\n            }\n          });\n        }\n      });\n    }\n\n    else if (database == \"eyecalibrations\") {\n      this.finder.destroy();\n      this.pathName.innerText = \"eyecalibrations\";\n      this.finder = new Tabulator(\"#finder\", {\n        data: dataArr,\n        index: \"Taskdoc\",\n        layout: \"fitColumns\",\n        initialSort: [\n          {column: \"Agent\", dir: \"asc\"}\n        ],\n        columns: [\n          {title: \"<input id='select-all' type='checkbox'/>\", width: 15, headerSort: false},\n          {title: \"Agent\", field: \"Agent\"},\n          {title: \"CurrentDate\", field: \"CurrentDate\"},\n        ],\n        selectable: true,\n        selectableRangeMode: \"click\",\n        rowClick: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n          \n        },\n        rowTap: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n        },\n        tableBuilt: () => {          \n          /* selectAllBox function */\n          let selectAllBox \n            = document.querySelector(\"#select-all\") as HTMLInputElement;\n          selectAllBox.addEventListener(\"change\", ev => {\n            if (selectAllBox.checked == true) {\n              this.finder.selectRow();\n            } else {\n              this.finder.deselectRow();\n            }\n          });\n        }\n      });\n    }\n\n    else if (database == \"mkscale\") {\n      this.finder.destroy();\n      this.pathName.innerText = \"mkscale\";\n      this.finder = new Tabulator(\"#finder\", {\n        data: dataArr,\n        index: \"Docname\",\n        layout: \"fitColumns\",\n        initialSort: [\n          {column: \"CurrentDate\", dir: \"asc\"}\n        ],\n        columns: [\n          {title: \"<input id='select-all' type='checkbox'/>\", width: 15, headerSort: false},\n          {title: \"Name\", field: \"Name\"},\n          {title: \"CurrentDate\", field: \"CurrentDate\"},\n        ],\n        selectable: true,\n        selectableRangeMode: \"click\",\n        rowClick: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n          this.mkc.populateAxisFields(row.getData());\n          \n        },\n        rowTap: (event, row) => {\n          event.stopPropagation();\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n          this.mke.displayFirebaseTextFile(row.getData(), database);\n          this.mkc.populateAxisFields(row.getData());\n        },\n        tableBuilt: () => {          \n          /* selectAllBox function */\n          let selectAllBox \n            = document.querySelector(\"#select-all\") as HTMLInputElement;\n          selectAllBox.addEventListener(\"change\", ev => {\n            if (selectAllBox.checked == true) {\n              this.finder.selectRow();\n            } else {\n              this.finder.deselectRow();\n            }\n          });\n        }\n      });\n    }\n\n    else {\n      console.error(\"Wrong or Invalid database trying to be tabularized\");\n    }\n  }\n  \n  private timestampToDate(dataArr: any[]) {\n    function _timestampToDate(element: Timestamp, idx: number, arr: any[]) {\n      try {\n        arr[idx] = element.toDate().toJSON();\n      } catch {\n\n      }\n    }\n\n    console.time(\"Timestamp Conversion\");\n    dataArr.forEach(data => {\n      for (let key of Object.keys(data)) {\n        if (Array.isArray(data[key])) {\n          data[key].forEach(_timestampToDate);\n        }\n  \n        else if (this.isDict(data[key])) {\n          try {\n            data[key] = data[key].toDate().toJSON();\n            continue;\n          } catch (e) {\n            // console.log(e);\n          }\n  \n          for (let key2 of Object.keys(data[key])) {\n            try {\n              data[key][key2] = data[key][key2].toDate().toJSON();\n            } catch {\n              // console.log(\"Not Timestamp Object\");\n            }\n          }\n        }\n        else if (!this.isString(data[key]) && !this.isNumber(data[key])) {\n          try {\n            data[key] = data[key].toDate().toJSON();\n          } catch {\n            // console.log(\"Not Timestamp Object\");\n          }\n        }\n      }\n    });\n    console.timeEnd(\"Timestamp Conversion\");\n\n    return dataArr;\n  }\n\n  private isDict(val: any) {\n    return val && typeof val === \"object\" && val.constructor === Object;\n  }\n\n  private isString(val: any) {\n    return typeof val === \"string\" || val.constructor === String;\n  }\n\n  private isNumber(val: any) {\n    return typeof val === \"number\" && isFinite(val);\n  }\n\n  public async listStorageFiles(fileRef: firebase.storage.Reference) {\n\n    function formatFileSize(size: number) {\n      let threshold = 1000;\n      if (Math.abs(size) < threshold) {\n        return size + \" B\";\n      }\n\n      let units = [\"kB\", \"MB\", \"GB\", \"TB\"];\n      let u = -1;\n\n      do {\n        size /= threshold;\n        ++u;\n      } while (Math.abs(size) >= threshold && u < units.length -1);\n      return size.toFixed(1) + \" \" + units[u]; \n    }\n    \n    async function loadMetadata(fileArr: any) {\n      await fileArr.getMetadata().then((md: any) => {\n        mdArr.push({\n          name: md.name,\n          contentType: md.contentType,\n          fullPath: md.fullPath,\n          size: formatFileSize(md.size),\n          timeCreated: md.timeCreated\n        });\n      });\n    }\n\n    this.backBtn.disabled = (fileRef.fullPath == \"mkturkfiles\") ? true: false;\n\n    if (fileRef.fullPath == \"mkturkfiles/parameterfiles/params_storage\") {\n      this.mke.storeParamBtn.style.display = 'none';\n      // this.mke.genBtn.style.display = 'none';\n      this.mke.paramGenBtnBox.style.display = 'none';\n      // this.mke.genSceneParamBtn.style.display = 'none';\n      this.mke.svSceneBtn.style.display = 'none';\n      this.mke.makeActiveBtn.style.display = 'inline-block';\n      this.mke.updateBtn.style.display = 'inline-block';\n      this.mke.btnBoxDiv.style.gridTemplateAreas = '\"update-btn active-btn\"';\n    } else if (fileRef.fullPath == 'mkturkfiles/parameterfiles/subjects') {\n      this.mke.makeActiveBtn.style.display = 'none';\n      // this.mke.genBtn.style.display = 'none';\n      this.mke.paramGenBtnBox.style.display = 'none';\n      this.mke.svSceneBtn.style.display = 'none';\n      this.mke.updateBtn.style.display = 'inline-block';\n      this.mke.storeParamBtn.style.display = 'inline-block';\n      this.mke.btnBoxDiv.style.gridTemplateAreas = '\"update-btn store-param-btn\"';\n    } else if (fileRef.fullPath == 'mkturkfiles/scenebags/objectome3d/templates') {\n      this.mke.makeActiveBtn.style.display = 'none';\n      this.mke.storeParamBtn.style.display = 'none';\n      this.mke.svSceneBtn.style.display = 'none';\n      // this.mke.genBtn.style.display = 'inline-block';\n      this.mke.paramGenBtnBox.style.display = 'inline-block';\n      this.mke.updateBtn.style.display = 'inline-block';\n      this.mke.btnBoxDiv.style.gridTemplateAreas = '\"param-gen-btn-box update-btn\"';\n    } else {\n      this.mke.makeActiveBtn.style.display = 'none';\n      this.mke.storeParamBtn.style.display = 'none';\n      // this.mke.genBtn.style.display = 'none';\n      this.mke.paramGenBtnBox.style.display = 'none';\n      this.mke.svSceneBtn.style.display = 'none';\n      this.mke.updateBtn.style.display = 'inline-block';\n      this.mke.btnBoxDiv.style.gridTemplateAreas = '\"update-btn update-btn\"';\n    }\n\n    this.pathName.innerText = fileRef.fullPath;\n\n    let pathArr: string[] = fileRef.fullPath.split(\"/\");\n    let mdArr = new Array();\n    let fileList = await fileRef.listAll();\n    let filePromise: any;\n\n    /* Resolve previous path */\n    this.previousPath = \"\";\n    for (let i = 0; i < pathArr.length -1; i++) {\n      this.previousPath += pathArr[i] + \"/\";\n    }\n\n    /* Resolve metadata of all folders */\n    fileList.prefixes.forEach(folder => {\n      mdArr.push({\n        name: folder.name,\n        contentType: \"folder\",\n        fullPath: folder.fullPath,\n        size: \"N/A\"\n      });\n    });\n\n    /* Resolve metadata of all files */\n    filePromise = fileList.items.map(loadMetadata);\n    await Promise.all(filePromise);\n\n    this.displayStorageTable(mdArr);\n  }\n\n  private refreshStorageTable() {\n    document.addEventListener('storageFileChanged', (ev: Event) => {\n      let folderRef = this.mke.getActiveFile().id as firebase.storage.Reference;\n      this.listStorageFiles(folderRef.parent!);\n    });\n  }\n\n  private displayStorageTable(metadataArr: any[]) {\n    this.finder.destroy();\n    this.finder = new Tabulator(\"#finder\", {\n      data: metadataArr,\n      index: \"name\",\n      responsiveLayout: true,\n      layout: \"fitColumns\",\n      resizableColumns: true,\n      initialSort: [\n        { column: \"name\", dir: \"asc\" }\n      ],\n      columns: [\n        { title: \"<input id='select-all' type='checkbox'/>\", width: 15, headerSort: false },\n        { title: \"Name\", field: \"name\", widthGrow: 3 },\n        { title: \"Type\", field: \"contentType\" },\n        { title: \"Path\", field: \"fullPath\" },\n        { title: \"Size\", field: \"size\" },\n      ],\n      selectable: true,\n      selectableRangeMode: \"click\",\n      rowDblClick: (ev, row) => {\n        ev.preventDefault();\n        ev.stopPropagation();\n        if (row.getData().contentType === \"folder\") {\n          console.log(\"rowDblClick\", row.getData().fullPath);\n          this.listStorageFiles(this.storageRef.child(row.getData().fullPath));\n        }\n      },\n      rowDblTap: (ev, row) => {\n        ev.preventDefault();\n        ev.stopPropagation();\n        if (row.getData().contentType === \"folder\") {\n          console.log(row.getData().fullPath);\n          this.listStorageFiles(this.storageRef.child(row.getData().fullPath));\n        }\n      },\n      rowClick: async (ev, row) => {\n        ev.stopPropagation();\n        if (row.getData().contentType === \"folder\") {\n          console.log(\"rowClick\", row.getData().fullPath);\n        }\n\n        else if (row.getData().contentType.includes(\"text\") ||\n                 row.getData().contentType.includes(\"json\")) {\n\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mke.editorDivElement.style.zIndex = \"3\";\n          this.mki.imgCanvasDiv.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n\n          let fileRef = this.storageRef.child(row.getData().fullPath);\n          this.mke.displayStorageTextFile(fileRef);\n        }\n\n        else if (row.getData().contentType.includes(\"image\")) {\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mki.imgCanvasDiv.style.zIndex = \"3\";\n          this.mke.editorDivElement.style.zIndex = \"2\";\n          this.mkt.canvas.style.zIndex = \"1\";\n\n          let imgRef = this.storageRef.child(row.getData().fullPath);\n          let imgName = row.getData().name;\n          this.mki.displayImage(imgRef, imgName);\n        }\n\n        else if (row.getData().contentType === \"application/octet-stream\" && row.getData().name.includes(\".glb\")) {\n          this.mkt.destroy();\n          this.mki.removeImages();\n\n          this.mkt.canvas.style.zIndex = \"3\";\n          this.mke.editorDivElement.style.zIndex = \"2\";\n          this.mki.imgCanvasDiv.style.zIndex = \"1\";\n\n          let meshRef = this.storageRef.child(row.getData().fullPath);\n          this.mkt.displayMesh(meshRef);\n        }\n      },\n      rowSelectionChanged: (data, rows) => {\n        this.showImagesBtn.disabled = !this.imageTypeTest(data);\n        if (this.imageTypeTest(data)) {\n          this.selectedImages = data;\n        }\n      },\n\n      tableBuilt: () => {\n        let selectAllBox = \n          document.querySelector('#select-all') as HTMLInputElement;\n        selectAllBox.addEventListener('change', ev => {\n          if (selectAllBox.checked == true) {\n            this.finder.selectRow();\n          } else {\n            this.finder.deselectRow();\n          }\n        });\n      }\n    });\n  }\n\n  public listBigQueryTable(dataArr: any[], dataset: string, agent: string) {\n    this.displayBigqueryTable(dataArr);\n    this.pathName.innerText = `${dataset}.${agent}`;\n  }\n\n  private displayBigqueryTable(dataArr: any[]) {\n    this.finder.destroy();\n    this.finder = new Tabulator(\"#finder\", {\n      data: dataArr,\n      index: \"timestamp.value\",\n      responsiveLayout: true,\n      layout: \"fitColumns\",\n      resizableColumns: true,\n      initialSort: [\n        { column: \"timestamp.value\", dir: \"asc\" }\n      ],\n      columns: [\n        { title: \"<input id='select-all' type='checkbox'/>\", width: 15, headerSort: false },\n        { title: \"Timestamp\", field: \"timestamp.value\" },\n      ],\n      selectable: true,\n      selectableRangeMode: \"click\",\n      rowClick: async (ev, row) => {\n        ev.stopPropagation();\n        this.mke.displayBigQueryTableRow(row.getData());\n      },\n      rowTap: (ev, row) => {\n        ev.stopPropagation();\n        this.mke.displayBigQueryTableRow(row.getData());\n      },\n      dataLoaded: (data) => {\n        console.log(\"table data\", data);\n        this.mkc.removeElementsByClassName('axis-options');\n        this.mkc.bqPopulateAxisFields(data, 'eyedata');\n      }\n    });\n  }\n\n  /* Mkfinder controls */\n  private backBtnAction() {\n    this.backBtn.addEventListener(\"click\" || \"pointerup\", (ev: Event) => {\n      ev.preventDefault();\n      ev.stopPropagation();\n      console.log(\"[backBtn Pressed]: previousPath:\", this.previousPath);\n      this.listStorageFiles(this.storageRef.child(this.previousPath));\n    });\n  }\n\n  private numImgSliderAction() {\n    this.numImgSlider.addEventListener(\"change\", (ev: Event) => {\n      console.log(this.numImgSlider.value);\n      this.mki.imgCanvas.style.gridTemplateColumns =\n      \"repeat(\" + String(this.numImgSlider.value) + \", minmax(0,1fr))\";\n    });\n  }\n\n  private showImagesBtnAction() {\n    this.showImagesBtn.addEventListener(\"click\" || \"pointerup\", async (ev: Event) => {\n      this.mkt.destroy();\n      this.mki.removeImages();\n\n      this.mki.imgCanvasDiv.style.zIndex = \"3\";\n      this.mke.editorDivElement.style.zIndex = \"2\";\n      this.mkt.canvas.style.zIndex = \"1\";\n\n      for (let i = 0; i < this.selectedImages.length; i++) {\n        let imgRef = this.storageRef.child(this.selectedImages[i].fullPath);\n        let imgName = this.selectedImages[i].name;\n        await this.mki.displayImage(imgRef, imgName);\n      }\n    });\n  }\n\n  private imageTypeTest(data: any[]) {\n    if (data.length == 0 || data.length == 1) {\n      return false;\n    } else {\n      for (var i = 0; i < data.length; i++) {\n        if (!data[i].contentType.includes(\"image\")) {\n          return false;\n        }\n      }\n      return true;\n    }\n  }\n\n  private downloadBtnAction() {\n    this.downloadBtn.addEventListener(\"click\" || \"pointerup\", \n    async (ev: Event) => {\n      let row = this.finder.getSelectedRows();\n      let qryLoc = \n      document.querySelector(\"#qry-loc-selector\") as HTMLSelectElement;\n\n      if (qryLoc.value == \"mkturkfiles\" && \n          !row[0].getData().contentType.includes(\"folder\")) {\n        for (let i = 0; i < row.length; i++) {\n          this.storageRef.child(row[i].getData().fullPath).getDownloadURL()\n          .then(async (url: string) => {\n            let file = await (await fetch(url)).blob();\n            FileSaver.saveAs(file, row[i].getData().name);\n          });\n        }\n      }\n\n      else if (qryLoc.value == \"marmosets\") {\n        for (let i = 0; i < row.length; i++) {\n          let file = row[i].getData();\n          let blob = new Blob(\n            [ JSON.stringify(file, null, 1) ],\n            { type: \"application/json; charset=utf-8\" }\n          );\n          FileSaver.saveAs(blob, file.name + \".json\");\n        }\n      }\n\n      else if (qryLoc.value == \"mkdailydatatest\") {\n        for (let i = 0; i < row.length; i++) {\n          let file = row[i].getData();\n          let blob = new Blob(\n            [ JSON.stringify(file, null, 1) ],\n            { type: \"application/json; charset=utf-8\" }\n          );\n          FileSaver.saveAs(blob, file.agent + \".json\");\n        }\n      }\n\n      else if (qryLoc.value == \"mkdailydata\") {\n        for (let i = 0; i < row.length; i++) {\n          let file = row[i].getData();\n          let blob = new Blob(\n            [ JSON.stringify(file, null, 1) ],\n            { type: \"application/json; charset=utf-8\" }\n          );\n          FileSaver.saveAs(blob, file.agent + \".json\");\n        }\n      }\n\n      else if (qryLoc.value == \"mkturkdata\") {\n        for (let i = 0; i < row.length; i++) {\n          let docName = row[i].getData().FirestoreDocRoot + \"_\" +\n              row[i].getData().Doctype;\n          let file = row[i].getData();\n          let blob = new Blob(\n            [ JSON.stringify(file, null, 1) ],\n            { type: \"application/json; charset=utf-8\" }\n          );\n          FileSaver.saveAs(blob, docName + \".json\");\n        }\n      }\n\n      else if (qryLoc.value == \"devices\") {\n        for (let i = 0; i < row.length; i++) {\n          let file = row[i].getData();\n          let blob = new Blob(\n            [ JSON.stringify(file, null, 1) ],\n            { type: \"application/json; charset=utf-8\" }\n          );\n          FileSaver.saveAs(blob, file.docname + \".json\");\n        }\n      }\n\n      else if (qryLoc.value == \"eyecalibration\") {\n        for (let i = 0; i < row.length; i++) {\n          let file = row[i].getData();\n          let blob = new Blob(\n            [ JSON.stringify(file, null, 1) ],\n            { type: \"application/json; charset=utf-8\" }\n          );\n          FileSaver.saveAs(blob, file.Docname + \".json\");\n        }\n      }\n\n      else if (qryLoc.value == \"mkscale\") {\n        for (let i = 0; i < row.length; i++) {\n          let file = row[i].getData();\n          let blob = new Blob(\n            [ JSON.stringify(file, null, 1) ],\n            { type: \"application/json; charset=utf-8\" }\n          );\n          FileSaver.saveAs(blob, file.Docname + \".json\");\n        }\n      }\n\n      else if (qryLoc.value == \"objects\") {\n        for (let i = 0; i < row.length; i++) {\n          let file = row[i].getData();\n          let blob = new Blob(\n            [ JSON.stringify(file, null, 1) ],\n            { type: \"application/json; charset=utf-8\" }\n          );\n          FileSaver.saveAs(blob, file.docname + \".json\");\n        }\n      }\n    });\n  }\n\n\n}","import firebase from \"firebase/app\";\nimport \"firebase/firestore\";\nimport \"firebase/storage\";\nimport JSONEditor from \"jsoneditor\";\nimport Viewer from \"viewerjs\";\nimport * as EditorParams from \"./editor-params\";\n\nimport * as THREE from \"three\";\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls\";\nimport { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader\";\nimport { BufferGeometryLoader } from \"three\";\nimport {ParseEngine} from './parser'\n\n\ntype FileRef = firebase.storage.Reference;\nconst db = firebase.firestore();\nconst storage = firebase.storage();\n\nexport class Mkeditor {\n  public editorDivElement: HTMLDivElement;\n  private editorElement: HTMLDivElement;\n  private editor: JSONEditor;\n  public updateBtn: HTMLButtonElement;\n  public btnBoxDiv: HTMLDivElement;\n  public makeActiveBtn: HTMLButtonElement;\n  public storeParamBtn: HTMLButtonElement;\n  private activeFile: \n    { loc: string, id: string | FileRef };\n  \n  public fileNameInput: HTMLInputElement;\n  private fileRenameBtn: HTMLButtonElement;\n  private fileDupBtn: HTMLButtonElement;\n  private fileDupModal: HTMLDialogElement;\n  // public genSceneParamBtn: HTMLButtonElement;\n  // private genSceneParamModal: HTMLDivElement;\n  public genBtn: HTMLButtonElement;\n  public paramGenBtnBox: HTMLDivElement;\n\n  public expandBtn: HTMLButtonElement;\n  public svSceneBtn: HTMLButtonElement;\n  private pe: ParseEngine;\n  private userEditedSceneParam: Object;\n  private generatedSceneParam: Object;\n\n\n  constructor() {\n    this.editorDivElement \n      = document.querySelector(\"#editor-div\") as HTMLDivElement;\n    this.editorElement = document.querySelector(\"#editor\") as HTMLDivElement;\n    this.editor = new JSONEditor(this.editorElement);\n    this.updateBtn = document.querySelector(\"#update-btn\") as HTMLButtonElement;\n    this.btnBoxDiv = document.querySelector(\"#button-box\") as HTMLDivElement;\n    this.paramGenBtnBox = document.querySelector('#param-gen-btn-box') as HTMLDivElement;\n    this.makeActiveBtn = document.querySelector(\"#active-btn\") as HTMLButtonElement;\n    this.storeParamBtn \n      = document.querySelector('#store-param-btn') as HTMLButtonElement;\n    this.activeFile = { loc: \"\", id: \"\" };\n    this.updateBtnAction();\n    this.makeActiveBtnAction();\n    this.storeParamBtnAction();\n    this.fileNameInput\n      = document.querySelector(\"#file-name-input\") as HTMLInputElement;\n    this.fileRenameBtn\n      = document.querySelector('#file-rename-btn') as HTMLButtonElement;\n    this.fileDupBtn\n      = document.querySelector('#file-dup-btn') as HTMLButtonElement;\n    this.fileDupModal\n      = document.querySelector('#file-dup-modal') as HTMLDialogElement;\n    this.renameBtnAction();\n    this.renameTextFieldAction();\n    this.getActiveFile();\n    this.fileDupBtnAction();\n\n\n    // this.genSceneParamBtn\n    //   = document.querySelector('#gen-scene-param-btn') as HTMLButtonElement;\n    // this.genSceneParamModal\n    //   = document.querySelector('#gen-scene-param-modal') as HTMLDivElement;\n    // this.generateSceneParamModalAction()\n    \n    \n    this.genBtn = document.querySelector('#generate-btn') as HTMLButtonElement;\n    this.expandBtn = document.querySelector('#expand-btn') as HTMLButtonElement;\n    this.svSceneBtn = document.querySelector('#save-scene-param-btn') as HTMLButtonElement;\n    this.genBtnAction();\n    this.svSceneBtnAction();\n    \n    this.pe = new ParseEngine();\n    this.userEditedSceneParam = {};\n    this.generatedSceneParam = {};\n\n  }\n\n  public getActiveFile() {\n    return this.activeFile;\n  }\n\n  public displayFirebaseTextFile(file: Object, loc: string) {\n    this.fileRenameBtn.style.display = 'none';\n    this.fileDupBtn.style.display = 'none';\n    // this.genSceneParamBtn.style.display = 'none';\n    this.storeParamBtn.style.display = 'none';\n    this.updateBtn.style.display = 'inline-block';\n    this.btnBoxDiv.style.gridTemplateAreas = '\"update-btn update-btn\"'\n    this.fileNameInput.value = '';\n    this.fileNameInput.disabled = true;\n\n    try {\n      let options = {\n        modes: ['tree' as 'tree', 'code' as 'code'],\n        sortObjectKeys: true,\n      };\n      this.editor.destroy();\n      this.editor = new JSONEditor(this.editorElement, options, file);\n      this.trackFirebaseActiveFile(loc, file);\n    } catch (error) {\n      console.error(\"JSONEditor Error:\", error);\n    }\n  }\n\n  public displayBigQueryTableRow(data: any) {\n    this.btnBoxDiv.style.display = 'none';\n    try {\n      this.editor.destroy();\n      let options = {\n        modes: ['tree' as 'tree', 'code' as 'code']\n      };\n      this.editor = new JSONEditor(this.editorElement, options, data);\n      this.fileNameInput.placeholder = data.timestamp.value;\n      // console.log(\"displayBigQueryTableRow\", data);\n    } catch (error) {\n      console.error(\"JSONEditor Error:\", error);\n    }\n  }\n\n  private trackFirebaseActiveFile(loc: string, file: any) {\n\n    if (loc === \"marmosets\") {\n      this.activeFile = { loc: loc, id: file.name };\n      this.fileNameInput.placeholder = String(this.activeFile.id);\n    }\n\n    else if (loc === \"mkturkdata\") {\n      if (file.Doctype === \"task\") {\n        this.activeFile = { loc: loc, id: file.Taskdoc };\n        this.fileNameInput.placeholder = String(this.activeFile.id);\n      } else if (file.Doctype === \"images\") {\n        this.activeFile = { loc: loc, id: file.Imagesdoc};\n        this.fileNameInput.placeholder = String(this.activeFile.id);\n      }\n    }\n\n    else if (loc === 'mkdailydata') {\n      this.activeFile = { loc: loc, id: file.agent };\n      this.fileNameInput.placeholder = String(this.activeFile.id);\n    }\n\n    else if (loc === 'mkdailydatatest') {\n      this.activeFile = { loc: loc, id: file.agent };\n      this.fileNameInput.placeholder = String(this.activeFile.id);\n    }\n\n    else if (loc === \"objects\") {\n      this.activeFile = { loc: loc, id: file.docname };\n      this.fileNameInput.placeholder = String(this.activeFile.id);\n    }\n\n    else if (loc === \"eyecalibrations\") {\n      this.activeFile = { loc: loc, id: file.Docname };\n      this.fileNameInput.placeholder = String(this.activeFile.id);\n    }\n\n    else if (loc === \"devices\") {\n      this.activeFile = { loc: loc, id: file.docname };\n      this.fileNameInput.placeholder = String(this.activeFile.id);\n    }\n\n    else if (loc === \"mkscale\") {\n      this.activeFile = { loc: loc, id: file.Docname };\n      this.fileNameInput.placeholder = String(this.activeFile.id);\n    }\n\n    console.log(\"activeFile\", this.activeFile);\n  }\n\n  public async displayStorageTextFile(fileRef: FileRef) {\n    console.log('diplayStorageTextFile FILEREF', fileRef);\n    this.fileNameInput.disabled = false;\n    this.fileRenameBtn.style.display = 'inline-block';\n    this.fileNameInput.value = '';\n\n    const sceneParamPath = 'mkturkfiles/scenebags/objectome3d';\n    const taskParamPath = 'mkturkfiles/parameterfiles';\n\n    function onClassName(classNameParams: {path: ReadonlyArray<string>; field: string; value: string;}) {\n      console.log(`onClassName path=${classNameParams.path}, field=${classNameParams.field}, value=${classNameParams.value}`);\n\n      const bioKeys = ['Agent', 'CheckRFID'];\n      const automatorKeys = [\n        'Automator', 'AutomatorFilePath', 'CurrentAutomatorStage',\n        'MinPercentCriterion', 'MinTrialsCriterion'\n      ];\n      const generalKeys = [\n        'DragtoRespond', 'CalibrateEye', 'NRSVP', 'NRSVPMax', 'SameDifferent',\n        'SamplingStrategy', 'NStickyResponse', 'NTrialsPerBagBlock'\n      ];\n      const gridKeys = [\n        'NGridPoints', 'GridSpacingInches', 'GridXOffsetInches',\n        'GridYOffsetInches', 'FixationGridIndex', 'SampleGridIndex',\n        'ObjectGridIndex', 'ChoiceGridIndex', 'TestGridIndex',\n      ];\n      const fixationKeys = [\n        'NFixations', 'FixationUsesSample', 'FixationSizeInches',\n        'FixationDuration', 'FixationTimeOut',\n      ];\n      const fixationConfigKeys = [\n        'FixationWindowSizeInches',\n        'FixationDotSizeInches',\n      ];\n      const sampleKeys = [\n        'ImageBagsSample', 'KeepSampleON',\n        'SamplePRE', 'SampleOFF',\n      ];\n      const testKeys = [\n        'ImageBagsTest', 'KeepTestON',\n        'TestOFF', 'HideTestDistractors',\n      ];\n      const choiceKeys = [\n        'ChoiceSizeInches', 'HideChoiceDistractors',\n        'ChoiceTimeOut',\n      ];\n      const rewardKeys = [\n        'RewardStage', 'RewardPer1000Trials',\n        'NRewardMax', 'NConsecutiveHitsforBonus',\n        'PunishTimeOut', 'ConsecutiveHitsITI',\n      ];\n      \n      if (bioKeys.includes(classNameParams.field)) {\n        return 'color-node-bio';\n      } else if (automatorKeys.includes(classNameParams.field)) {\n        return 'color-node-automator';\n      } else if (generalKeys.includes(classNameParams.field)) {\n        return 'color-node-general';\n      } else if (gridKeys.includes(classNameParams.field)) {\n        return 'color-node-grid';\n      } else if (fixationKeys.includes(classNameParams.field)) {\n        return 'color-node-fixation';\n      } else if (fixationConfigKeys.includes(classNameParams.field)) {\n        return 'color-node-fixation-config';\n      } else if (sampleKeys.includes(classNameParams.field)) {\n        return 'color-node-sample';\n      } else if (testKeys.includes(classNameParams.field)) {\n        return 'color-node-test';\n      } else if (choiceKeys.includes(classNameParams.field)) {\n        return 'color-node-choice';\n      } else if (rewardKeys.includes(classNameParams.field)) {\n        return 'color-node-reward';\n      } else {\n        return 'color-node-nuisance';\n      }\n    }\n\n    let sceneTemplateOptions = {\n      modes: ['tree' as 'tree', 'code' as 'code'],\n      templates: [\n        {\n          text: 'Camera',\n          title: 'Insert a Camera node',\n          field: 'CameraTemplate',\n          value: {\n            type: 'PerspectiveCamera',\n            fieldOfView: 45,\n            near: 0.1,\n            far: 2000,\n            position: {\n              x: [0],\n              y: [0],\n              z: [0]\n            },\n            targetInches: {\n              x: [0],\n              y: [0],\n              z: [0]\n            },\n            visible: [1]\n          }\n        },\n        {\n          text: 'Light',\n          title: 'Insert a Light node',\n          field: 'LightTemplate',\n          value: {\n            type: 'DirectionalLight',\n            color: '0xffffff',\n            intensity: [5],\n            position: {\n              x: [0],\n              y: [0],\n              z: [0]\n            },\n            visible: [1]\n          }\n        },\n        {\n          text: 'Object',\n          title: 'Insert an Object node',\n          field: 'ObjectTemplate',\n          value: {\n            meshpath: '',\n            objectdoc: '',\n            sizeInches: [0.5],\n            positionInches: {\n              x: [0],\n              y: [0],\n              z: [0]\n            },\n            rotationDegrees: {\n              x: [0],\n              y: [0],\n              z: [0]\n            },\n            material: {\n              type: 'MeshPhysicalMaterial',\n              color: '#7F7F7F',\n              metalness: 0.25,\n              roughness: 0.65,\n              reflectivity: 0.5,\n              opacity: [1],\n              transparent: false\n            },\n            visible: [1],\n            morphTarget: []\n          }\n        },\n        {\n          text: 'Background',\n          title: 'Insert a Background node',\n          field: 'ImagesTemplate',\n          value: {\n            imagebag: '',\n            imageidx: []\n          }\n        }\n      ]\n    }\n\n    let options = {\n      modes: ['tree' as 'tree', 'code' as 'code']\n    }\n\n    let taskParamOptions = {\n      modes: ['tree' as 'tree', 'code' as 'code'],\n      onClassName: onClassName,\n      schema: EditorParams.taskParamSchema\n    };\n\n    let fileUrl = await fileRef.getDownloadURL().catch(e => {\n      console.error(\"Error getting download URL\", e);\n    });\n    let response = await fetch(fileUrl);\n    let file = await response.json();\n\n    if (fileRef.fullPath.includes(sceneParamPath)) {\n      if (fileRef.fullPath.includes('template')) {\n        this.fileDupBtn.style.display = 'inline-block';\n        // this.genSceneParamBtn.style.display = 'inline-block';\n        options = sceneTemplateOptions;\n      } else {\n        this.fileDupBtn.style.display = 'inline-block';\n        // this.genSceneParamBtn.style.display = 'none';\n      }\n    } else if (fileRef.fullPath.includes(taskParamPath)) {\n      this.fileDupBtn.style.display = 'inline-block';\n      options = taskParamOptions;\n      let taskParamKeys = Object.keys(JSON.parse(JSON.stringify(EditorParams.taskParamSchema, null, 1)).properties);\n      let json = JSON.parse(JSON.stringify(file, taskParamKeys, 1));\n      let json2: any = {};\n      Object.keys(file).forEach(key => {\n        if (!(key in json)) {\n          json2[key] = file[key];\n        }\n      });\n      file = Object.assign(json, json2);\n      // this.genSceneParamBtn.style.display = 'none';\n    } else {\n      this.fileDupBtn.style.display = 'none';\n      // this.genSceneParamBtn.style.display = 'none';\n    }\n\n    this.editor.destroy();\n    this.editor = new JSONEditor(this.editorElement, options, file);\n    this.activeFile = { loc: \"mkturkfiles\", id: fileRef };\n    console.log(\"activeFile\", this.activeFile);\n    this.fileNameInput.placeholder = fileRef.name;\n  }\n\n  private fileDupBtnAction() {\n    let fileName\n      = this.fileDupModal.querySelector('#dup-file-name') as HTMLInputElement;\n    \n    this.fileDupBtn.addEventListener('click', (ev: Event) => {\n      ev.preventDefault();\n      this.fileDupModal.showModal();\n      let activeFileName = this.activeFile.id as FileRef;\n      fileName.value = 'Copy of ' + activeFileName.name;\n      fileName.focus();\n      fileName.select();\n    });\n\n    this.fileDupModal.querySelector('.close')?.addEventListener('click', () => {\n      this.fileDupModal.close();\n    });\n\n    this.fileDupModal.querySelector('.save')?.addEventListener('click', () => {\n      let srcFileRef = this.activeFile.id as FileRef;\n      let dupFileRef = srcFileRef.parent?.child(fileName.value);\n      let dupFile = new Blob([JSON.stringify(this.editor.get(), null, 1)]);\n      let md = {\n        contentType: 'application/json'\n      };\n\n      dupFileRef?.put(dupFile, md).then(async (snapshot) => {\n        console.log('[DOCUMENT DUPLICATED]', snapshot);\n        alert('Document Duplicated');\n        let fileDupEvent = new Event('storageFileChanged');\n        this.fileNameInput.value = '';\n        this.displayStorageTextFile(dupFileRef!);\n        document.dispatchEvent(fileDupEvent);\n      }).catch(e => {\n        console.error('[DOCUMENT DUPLICATE FAILED]:', e);\n        console.error('srcFile', srcFileRef, 'dupFile', dupFileRef);\n        alert('Document Dup Failed');\n      });\n\n      this.fileDupModal.close();\n    });\n  }\n\n  private generateSceneParamModalAction() {\n\n    let collapsibles = document.getElementsByClassName('collapsible') as HTMLCollectionOf<HTMLButtonElement>;\n    for (let i = 0; i < collapsibles.length; i++) {\n      let coll = collapsibles[i];\n      coll.addEventListener('click', (ev: Event) => {\n        ev.preventDefault();\n        coll.classList.toggle('active');\n        let content = coll.nextElementSibling as HTMLButtonElement;\n        if (content.style.display === 'block') {\n          content.style.display = 'none';\n        } else {\n          content.style.display = 'block';\n        }\n      })\n    }\n\n    let initDataSize = [\n      {sampling: 'gaussian', params: '0, 1', n: 5}\n    ];\n\n    let rtSize = new Tabulator('#size-inches-table', {\n      data: initDataSize,\n      layout: 'fitColumns',\n      history: true,\n      columns: [\n        {title: 'Sampling', field: 'sampling', editor: 'select', editorParams: {values: ['gaussian', 'uniform', 'range']}},\n        {title: 'Params', field: 'params', editor: 'input', editable: true},\n        {title: 'n || step size', field: 'n', editor: 'input', editable: true}\n      ]\n    });\n\n    let szDiv = document.querySelector('.size-inches') as HTMLDivElement;\n    let addRowSize = szDiv.querySelector('.add-rule-btn') as HTMLButtonElement;\n    let undoSz = szDiv.querySelector('.undo-edit-btn') as HTMLButtonElement\n\n    addRowSize.addEventListener('click', (ev: Event) => {\n      ev.preventDefault();\n      rtSize.addRow({sampling: '', params: '', n: NaN}, false);\n    });\n\n    undoSz.addEventListener('click', (ev: Event) => {\n      rtSize.undo();\n    });\n\n    let initDataPos = [\n      {target: 'x', sampling: 'gaussian', params: '0, 1', n: 5}\n    ];\n\n    let rtPos = new Tabulator('#position-inches-table', {\n      data: initDataPos,\n      layout: 'fitColumns',\n      history: true,\n      columns: [\n        {title: 'Target', field: 'target', editor: 'select', editorParams: {values: ['x', 'y', 'z']}},\n        {title: 'Sampling', field: 'sampling', editor: 'select', editorParams: {values: ['gaussian', 'uniform', 'range']}},\n        {title: 'Params', field: 'params', editor: 'input', editable: true},\n        {title: 'n || step size', field: 'n', editor: 'input', editable: true}\n      ]\n    });\n\n    let posDiv = document.querySelector('.position-inches') as HTMLDivElement;\n    let addRowPos = posDiv.querySelector('.add-rule-btn') as HTMLButtonElement;\n    let undoPos = posDiv.querySelector('.undo-edit-btn') as HTMLButtonElement\n\n    addRowPos.addEventListener('click', (ev: Event) => {\n      ev.preventDefault();\n      rtPos.addRow({target: '', sampling: '', params: '', n: NaN});\n    });\n\n    undoPos.addEventListener('click', (ev: Event) => {\n      rtPos.undo();\n    });\n\n    let initDataDeg = [\n      {target: 'x', sampling: 'gaussian', params: '0, 1', n: 5}\n    ];\n\n    let rtDeg = new Tabulator('#rotation-degrees-table', {\n      data: initDataDeg,\n      layout: 'fitColumns',\n      history: true,\n      columns: [\n        {title: 'Target', field: 'target', editor: 'select', editorParams: {values: ['x', 'y', 'z']}},\n        {title: 'Sampling', field: 'sampling', editor: 'select', editorParams: {values: ['gaussian', 'uniform', 'range']}},\n        {title: 'Params', field: 'params', editor: 'input', editable: true},\n        {title: 'n || step size', field: 'n', editor: 'input', editable: true}\n      ]\n    });\n\n    let degDiv = document.querySelector('.rotation-degrees') as HTMLDivElement;\n    let addRowDeg = degDiv.querySelector('.add-rule-btn') as HTMLButtonElement;\n    let undoDeg = degDiv.querySelector('.undo-edit-btn') as HTMLButtonElement\n\n    addRowDeg.addEventListener('click', (ev: Event) => {\n      ev.preventDefault();\n      rtDeg.addRow({target: '', sampling: '', params: '', n: NaN});\n    });\n\n    undoDeg.addEventListener('click', (ev: Event) => {\n      rtDeg.undo();\n    });\n\n  }\n\n  private renameTextFieldAction() {\n    this.fileNameInput.addEventListener('click', (ev: Event) => {\n      let tmpName = this.activeFile.id as FileRef;\n      let curFileName = tmpName.name;\n      this.fileNameInput.value = curFileName;\n      this.fileNameInput.focus();\n      this.fileNameInput.select();\n    });\n  }\n\n  private renameBtnAction() {\n    this.fileRenameBtn.addEventListener('click', (ev: Event) => {\n      if (this.fileNameInput.value) {\n        let oldFileRef = this.activeFile.id as FileRef;\n        let newFileRef = oldFileRef.parent?.child(this.fileNameInput.value);\n        let newFile = new Blob([JSON.stringify(this.editor.get(), null, 1)]);\n        let md = {\n          contentType: 'application/json'\n        };\n\n        newFileRef?.put(newFile, md).then(async (snapshot) => {\n          await oldFileRef.delete();\n          console.log('[DOCUMENT RENAMED]', snapshot);\n          alert('Document Renamed');\n          let renameEvent = new Event('storageFileChanged');\n          this.fileNameInput.value = '';\n          this.displayStorageTextFile(newFileRef!);\n          document.dispatchEvent(renameEvent);\n        }).catch(e => {\n          console.error('[DOCUMENT RENAME FAILED]:', e);\n          console.error('oldFile', oldFileRef, 'newFile', newFileRef);\n          alert('Document Rename Failed');\n        });\n        \n\n      } else {\n        console.log('file name input field is null');\n      }\n    });\n  }\n\n  private updateBtnAction() {\n    this.updateBtn.addEventListener(\"click\" || \"pointerup\", (ev: Event) => {\n      ev.preventDefault();\n      ev.stopPropagation();\n      let loc = this.activeFile.loc;\n\n      if (loc === \"marmosets\" || loc === \"mkturkdata\" || loc === \"devices\"\n        || loc === \"mkscale\" || loc === \"eyecalibrations\" || loc === 'mkdailydata'\n        || loc === \"mkdailydatatest\") {\n        // handle marmosets && mkturkdata\n        let id = this.activeFile.id as string;\n        db.collection(loc).doc(id).set(\n          this.dateToTimestamp(this.editor.get())\n        ).then(() => {\n          console.log(\"[DOCUMENT UPDATED]:\", id);\n          alert(\"Document Updated\");\n        }).catch(e => {\n          console.error(\"[DOCUMENT UPDATE FAILED]\", \"FILE:\", id, \"ERROR:\", e);\n          alert(\"Document Update Failed\");\n        });\n      }\n\n      else if (this.activeFile.loc === \"mkturkfiles\") {\n        // handle mkturkfiles\n        let id = this.activeFile.id as FileRef;\n        let updatedFile = new Blob([ JSON.stringify(this.editor.get(), null, 1) ]);\n        let metadata = {\n          contentType: \"application/json\"\n        };\n        id.put(updatedFile, metadata).then(snapshot => {\n          console.log(\"[DOCUMENT UPDATED]:\", snapshot.metadata.name);\n          alert(\"Document Updated\");\n          document.dispatchEvent(new Event('storageFileChanged'));\n        }).catch(e => {\n          console.error(\"[DOCUMENT UPDATE FAILED]\", \"FILE:\", id, \"ERROR:\", e);\n          alert(\"Document Update Failed\");\n        });\n      }\n\n      else {\n        console.error(\"[DOCUMENT UPDATE FAILED] ERROR: Location Error\");\n      }\n    });\n  }\n\n  private makeActiveBtnAction() {\n    this.makeActiveBtn.addEventListener('click' || 'pointerup', (ev: Event) => {\n      ev.preventDefault();\n      ev.stopPropagation();\n      console.log(this.activeFile);\n      let storageRef = storage.ref();\n      let file = this.editor.get();\n      let fileName = \"mkturkfiles/parameterfiles/subjects/\" + file.Agent + \"_params.json\";\n      let fileRef = storageRef.child(fileName);\n      file = new Blob([ JSON.stringify(file, null, 1) ]);\n      let metadata = {\n        contentType: \"application/json\"\n      };\n      fileRef.put(file, metadata).then(snapshot => {\n        console.log(\"[PARAM MADE ACTIVE]:\", snapshot.metadata.name);\n        alert(\"Param Active\");\n      }).catch(e => {\n        console.error(\"[PARAM ACTIVATION FAILED]\", \"FILE:\", fileRef, \"ERROR\", e);\n        alert(\"Param Activation Failed\");\n      });\n    });\n  }\n\n  private storeParamBtnAction() {\n    this.storeParamBtn.addEventListener('click' || 'pointerup', (ev: Event) => {\n      ev.preventDefault();\n      ev.stopPropagation();\n      console.log(this.activeFile);\n      let storageRef = storage.ref();\n      let file = this.editor.get();\n      let date = new Date();\n      let fileName = 'mkturkfiles/parameterfiles/params_storage/'\n        + file.Agent + \"_params_\" + date.toJSON().split('T')[0]\n        + '.json';\n      \n      let fileRef = storageRef.child(fileName);\n      file = new Blob([ JSON.stringify(file, null, 1) ]);\n      let metadata = {\n        contentType: 'application/json'\n      };\n\n      fileRef.put(file, metadata).then(snapshot => {\n        console.log('[PARAM STORED]:', snapshot.metadata.name);\n        alert('Param stored');\n      }).catch(e => {\n        console.error('[PARAM STORAGE FAILED]', 'FILE:', fileRef, 'ERROR', e);\n        alert('Param Storage Failed');\n      });\n    });\n  }\n\n  private genBtnAction() {\n    this.genBtn.addEventListener('click', (ev: Event) => {\n      if (this.genBtn.value == 'generate') {\n        this.userEditedSceneParam = this.editor.get();\n        this.generatedSceneParam = (\n          this.pe.generateParamObject(this.userEditedSceneParam, 'vectorize')\n        );\n        this.editor.destroy();\n        let options = {\n          modes: ['tree' as 'tree', 'code' as 'code']\n        };\n        this.editor = new JSONEditor(this.editorElement, options, this.generatedSceneParam);\n        this.genBtn.value = 'revert';\n        this.genBtn.textContent = 'Revert';\n        this.updateBtn.style.display = 'none';\n        this.svSceneBtn.style.display = 'inline-block';\n        this.btnBoxDiv.style.gridTemplateAreas = '\"param-gen-btn-box sv-scene-param-btn\"';\n      } else if (this.genBtn.value == 'revert') {\n        this.editor.destroy();\n        this.generatedSceneParam = {};\n        let options = {\n          modes: ['tree' as 'tree', 'code' as 'code']\n        };\n        this.editor = new JSONEditor(this.editorElement, options, this.userEditedSceneParam);\n        this.genBtn.value = 'generate';\n        this.genBtn.textContent = 'Vectorize Param';\n        this.svSceneBtn.style.display = 'none';\n        this.updateBtn.style.display = 'inline-block';\n        this.btnBoxDiv.style.gridTemplateAreas = '\"param-gen-btn-box update-btn\"';\n      }\n    });\n\n    this.expandBtn.addEventListener('click', (ev: Event) => {\n      if (this.expandBtn.value == 'expand') {\n        this.userEditedSceneParam = this.editor.get();\n        this.generatedSceneParam = (\n          this.pe.generateParamObject(this.userEditedSceneParam, 'expand')\n        );\n        this.editor.destroy();\n        let options = {\n          modes: ['tree' as 'tree', 'code' as 'code']\n        };\n        this.editor = new JSONEditor(this.editorElement, options, this.generatedSceneParam);\n        this.expandBtn.value = 'revert';\n        this.expandBtn.textContent = 'Revert';\n        this.updateBtn.style.display = 'none';\n        this.svSceneBtn.style.display = 'inline-block';\n        this.btnBoxDiv.style.gridTemplateAreas = '\"param-gen-btn-box sv-scene-param-btn\"';\n      } else if (this.expandBtn.value == 'revert') {\n        this.editor.destroy();\n        this.generatedSceneParam = {};\n        let options = {\n          modes: ['tree' as 'tree', 'code' as 'code']\n        };\n        this.editor = new JSONEditor(this.editorElement, options, this.userEditedSceneParam);\n        this.expandBtn.value = 'expand';\n        this.expandBtn.textContent = 'Expand Param';\n        this.svSceneBtn.style.display = 'none';\n        this.updateBtn.style.display = 'inline-block';\n        this.btnBoxDiv.style.gridTemplateAreas = '\"param-gen-btn-box update-btn\"';\n      }\n    });\n  }\n\n  private svSceneBtnAction() {\n    let modal = document.querySelector('#filename-modal') as HTMLDialogElement;\n    let modalFilename = modal.querySelector('.filename-input') as HTMLInputElement;\n\n    this.svSceneBtn.addEventListener('click', (ev: Event) => {\n      ev.preventDefault();\n      modal.showModal();\n      let activeFileName = this.activeFile.id as FileRef;\n      let now = new Date();\n      modalFilename.value = now.toLocaleDateString('en-CA') + '_' + activeFileName.name;\n      modalFilename.focus();\n      modalFilename.select();\n    });\n\n    modal.querySelector('.cl')?.addEventListener('click', () => {\n      modal.close();\n    });\n\n    modal.querySelector('.sv')?.addEventListener('click', () => {\n      let srcRef = this.activeFile.id as FileRef;\n      let destRef = srcRef.parent?.parent?.child('generatedParams').child(modalFilename.value);\n      let sceneSrcFileName = (\n        modalFilename.value.split('.')[0] + '_source.' + modalFilename.value.split('.')[1]\n      ); \n      let sceneSrcDestRef = srcRef.parent?.parent?.child('generatedParams').child(sceneSrcFileName);\n      let file = new Blob([JSON.stringify(this.generatedSceneParam, null, 1)]);\n      let sceneSrcFile = new Blob([JSON.stringify(this.userEditedSceneParam, null, 1)]);\n      let md = {\n        contentType: 'application/json'\n      };\n\n      destRef?.put(file, md).then(async (sns) => {\n        alert('Generated param file was saved');\n        this.generatedSceneParam = {};\n        this.userEditedSceneParam = {};\n        this.displayStorageTextFile(srcRef);\n      }).catch(e => {\n        console.error('Param Generation Failed');\n        alert('Generated param file was NOT saved');\n      });\n      sceneSrcDestRef?.put(sceneSrcFile, md);\n      modal.close();\n    });\n  }\n\n  private dateToTimestamp(data: any) {\n    function _dateToTimestamp(element: string, idx: number, arr: any[]) {\n      let dt = new Date(element);\n      if (!isNaN(Number(dt)) && dt instanceof Date && typeof element === \"string\") {\n        arr[idx] = firebase.firestore.Timestamp.fromDate(dt);\n      }\n    }\n\n    for (let key of Object.keys(data)) {\n      if (Array.isArray(data[key]) \n        && (key.toLowerCase().includes('time') || key.toLowerCase().includes('dates'))) {\n        console.log(\"ARRAY \" + \"data[\" + key + \"]\" + \"=\" + data[key]);\n        data[key].forEach(_dateToTimestamp);\n      }\n\n      else if (this.isDict(data[key])) {\n        for (let key2 of Object.keys(data[key])) {\n          let dt = new Date(data[key][key2]);\n          if (!isNaN(Number(dt)) && dt instanceof Date && this.isString(data[key][key2])) {\n            console.log(\"Dictionary \" + \"data[\" + key + \"]\" + \"=\" + data[key]);\n            data[key][key2] = firebase.firestore.Timestamp.fromDate(dt);\n          }\n        }\n      }\n\n      else if (this.isString(data[key])\n        && (key.toLowerCase().includes('date') || key.toLowerCase().includes('time'))) {\n        \n        let dt = new Date(data[key]);\n        if (!isNaN(Number(dt)) && dt instanceof Date) {\n          data[key] = firebase.firestore.Timestamp.fromDate(dt);\n        }\n      }\n    }\n    return data;\n  }\n\n  private isDict(val: any) {\n    return val && typeof val === \"object\" && val.constructor === Object;\n  }\n\n  private isString(val: any) {\n    return typeof val === \"string\" || val.constructor === String;\n  }\n  \n}\n\nexport class Mkthree {\n\n  /* THREE.js member variables */\n  private scene: THREE.Scene | null;\n  private camera: THREE.PerspectiveCamera | null;\n  private cameraPos: THREE.Vector3 | null;\n  private controls: OrbitControls | null;\n  private dirLight: THREE.DirectionalLight | null;\n  private dirLightPos: THREE.Vector3 | null;\n  private light: THREE.AmbientLight | null;\n  private loader: GLTFLoader | null;\n  private renderer: THREE.WebGLRenderer | null;\n  public animationID: number;\n  public active: boolean;\n\n  public canvas: HTMLCanvasElement;\n  \n  /* constructor */\n  constructor() {\n    this.scene = null;\n    this.camera = null;\n    this.cameraPos = null;\n    this.controls = null;\n    this.dirLight = null;\n    this.dirLightPos = null;\n    this.light = null;\n    this.loader = null;\n    this.renderer = null;\n    this.animationID = -1;\n    this.active = false;\n    this.canvas = document.querySelector(\"#three-canvas\") as HTMLCanvasElement;\n    let editorDiv = document.querySelector(\"#editor-div\") as HTMLDivElement;\n    this.canvas.width = editorDiv.offsetWidth;\n    this.canvas.height = editorDiv.offsetHeight;\n    this.canvas.style.width = String(editorDiv.offsetWidth);\n    this.canvas.style.height = String(editorDiv.offsetHeight);\n    this.resizeCanvasAction();\n  }\n\n  /**\n   * Public function to display mesh specified by filepath to a canvas\n   * specified by canvas\n   * \n   * @param {string} filePath\n   * @param {HTMLCanvasElement} canvas\n   * @public\n   */\n  public async displayMesh(meshRef: firebase.storage.Reference) {\n    console.time(\"displayMesh()\");\n\n    if (this.active) {\n      this.destroy();\n    }\n\n    /* renderer setup */\n    this.renderer = new THREE.WebGLRenderer({ canvas: this.canvas, antialias: true });\n    this.renderer.setClearColor( 0xFFFFFF );\n    this.renderer.physicallyCorrectLights = true;\n    this.renderer.toneMapping = THREE.LinearToneMapping;\n    this.renderer.toneMappingExposure = 10;\n    this.renderer.outputEncoding = THREE.GammaEncoding;\n    this.renderer.gammaFactor = 2.2;\n\n    /* camera setup */\n    this.cameraPos = new THREE.Vector3( 0, 0, 10 );\n    this.camera = \n      new THREE.PerspectiveCamera( 45, this.canvas.width / this.canvas.height, 0.1, 2000 );\n    this.camera.position.set( this.cameraPos.x, this.cameraPos.y, this.cameraPos.z );\n\n    /* light setup */\n    this.dirLightPos = new THREE.Vector3( 0, 2, 0 );\n    this.dirLight = new THREE.DirectionalLight( 0xFFFFFF, 0.5);\n    this.dirLight.position.set( this.dirLightPos.x, this.dirLightPos.y, this.dirLightPos.z )\n    this.light = new THREE.AmbientLight( 0x404040, 0.05 ); // (0x404040, 0.1)\n\n    /* control setup */\n    this.controls = new OrbitControls( this.camera, this.renderer.domElement );\n    this.controls.target = new THREE.Vector3( 0, 0, 0);\n\n    /* scene setup */\n    this.scene = new THREE.Scene();\n    this.scene.add(this.camera);\n    this.scene.add(this.dirLight);\n    this.scene.add(this.light);\n\n    /* load mesh */\n    let objectMesh: any = await this.loadMesh(meshRef);\n\n    /* add loaded mesh to scene */\n    this.scene.add(objectMesh.scene)\n    requestAnimationFrame(this.animate.bind(this));\n    this.renderer.render(this.scene, this.camera);\n    this.active = true;\n\n    console.timeEnd(\"displayMesh()\")\n  }\n\n  /**\n   * Private function to load and return mesh specified by filepath \n   * \n   * @param {string} filePath\n   * @returns {Promise}\n   * @private\n   */\n  private async loadMesh(meshRef: firebase.storage.Reference) {\n    \n    try {\n      let meshUrl = await meshRef.getDownloadURL().catch(e => {\n        console.error(\"Error:\", e);\n      });\n\n      this.loader = new GLTFLoader();\n\n      return new Promise((resolve, reject) => {\n        try {\n          this.loader?.load(meshUrl, function(gltf) {\n            gltf.scene.traverse((child: any) => {\n              if (child.material) {\n                let material = new THREE.MeshPhongMaterial({ color: \"#FFE0BD\" })\n                if (\"morphTargetInfluences\" in child) {\n                  material.morphTargets = true;\n                }\n                child.material = material;\n                child.material.needsUpdate = true;\n              }\n            });\n            resolve(gltf);\n          });\n        } catch (error) {\n          console.error(\"Error:\", error);\n        }\n      });\n    } catch (error) {\n      console.error(\"Error:\", error);\n    }\n  }\n\n  private animate() {\n    this.animationID = requestAnimationFrame(this.animate.bind(this));\n    if (this.scene && this.camera) {\n      this.renderer?.render(this.scene, this.camera);\n    }\n  }\n\n  public destroy() {\n    try {\n      this.scene = null;\n      this.camera = null;\n      this.cameraPos = null;\n      this.controls = null;\n      this.dirLight = null;\n      this.dirLightPos = null;\n      this.light = null;\n      this.loader = null;\n      this.renderer?.clear();\n      this.renderer = null;\n      this.animationID = -1;\n      this.active = false;\n      cancelAnimationFrame(this.animationID);\n    } catch (error) {\n      console.error(\"Error destroying THREE Objects:\", error);\n    }\n  }\n\n  private resizeCanvasAction() {\n    window.addEventListener(\"resize\", (ev: Event) => {\n      let editorDiv = document.querySelector(\"#editor-div\") as HTMLDivElement;\n      this.canvas.width = editorDiv.offsetWidth;\n      this.canvas.height = editorDiv.offsetHeight;\n      this.canvas.style.width = String(editorDiv.offsetWidth);\n      this.canvas.style.height = String(editorDiv.offsetHeight);\n    });\n  }\n}\n\nexport class Mkimage {\n  imgCanvasDiv: HTMLDivElement;\n  imgCanvas: HTMLElement;\n  imgGallery: Viewer;\n\n  constructor() {\n    this.imgCanvasDiv = \n    document.querySelector(\"#image-canvas-div\") as HTMLDivElement;\n\n    this.imgCanvas =\n    document.querySelector(\"#image-canvas\") as HTMLElement;\n\n    this.imgGallery = \n    new Viewer(document.getElementById(\"image-canvas\")!);\n  }\n\n  public async displayImage(fileRef: FileRef, fileName: string) {\n    let li = document.createElement(\"li\");\n    li.setAttribute(\"class\", \"imageList\");\n    let imgDiv = document.createElement(\"div\");\n    let img = document.createElement(\"img\");\n    let imgLabel = document.createElement(\"p\");\n    imgLabel.innerHTML = fileName;\n    await fileRef.getDownloadURL().then(url => {\n      img.src = url;\n    });\n\n    imgDiv.appendChild(img);\n    imgDiv.appendChild(imgLabel);\n    li.appendChild(imgDiv);\n    this.imgCanvas.appendChild(li);\n    this.imgGallery.destroy();\n    this.imgGallery = new Viewer(document.getElementById(\"image-canvas\")!);\n  }\n\n  public removeImages() {\n    let elements = document.getElementsByClassName(\"imageList\");\n    while (elements.length > 0) {\n      elements[0].parentNode?.removeChild(elements[0]);\n    }\n    \n  }\n}\n\nexport class Mkchart {\n  chartDiv: HTMLDivElement;\n  plotX: HTMLSelectElement;\n  plotY: HTMLSelectElement;\n  plotBtn: HTMLButtonElement;\n  finderDiv: HTMLDivElement;\n  chart: any;\n  data: any;\n  isActive: boolean;\n  isBigQuery: boolean;\n\n  constructor() {\n    google.charts.load('current', { packages: ['corechart'] });\n    this.chartDiv = document.querySelector(\"#chart-div\") as HTMLDivElement;\n    this.finderDiv = document.querySelector(\"#finder-div\") as HTMLDivElement;\n    this.plotX = document.querySelector(\"#quick-plot-x\") as HTMLSelectElement;\n    this.plotY = document.querySelector(\"#quick-plot-y\") as HTMLSelectElement;\n    this.plotBtn = document.querySelector(\"#plot-btn\") as HTMLButtonElement;\n    this.isActive = false;\n    this.isBigQuery = false;\n    \n    this.data = null;\n    console.log(this.chartDiv);\n    \n    this.plotBtnAction();\n    \n  }\n\n  public plotBtnAction() {\n    this.plotBtn.addEventListener('click', (ev: Event) => {\n      ev.preventDefault();\n      this.isActive = !this.isActive;\n      if (this.isBigQuery == false) {\n        if (this.isActive) {\n          this.plotBtn.textContent = \"Close Quick Plot\";\n          this.chartDiv.style.zIndex = \"2\";\n          this.finderDiv.style.zIndex = \"1\";\n          let vizData = new google.visualization.DataTable();\n          vizData.addColumn('datetime', this.plotX.value);\n          vizData.addColumn('number', this.plotY.value);\n          \n          for (let i = 0; i < this.data[this.plotX.value].length; i++) {\n            vizData.addRow([ new Date(this.data[this.plotX.value][i]), parseFloat(this.data[this.plotY.value][i]) ]);\n          }\n  \n          console.log(this.chartDiv.clientWidth);\n          let chart = new google.visualization.LineChart(this.chartDiv);\n          let options = {\n            title: this.plotY.value,\n            width: this.chartDiv.offsetWidth,\n            height: this.chartDiv.offsetHeight,\n            legend: 'none' as 'none',\n            pointSize: 10\n          };\n          chart.draw(vizData, options);\n          \n        } else {\n          this.plotBtn.textContent = \"Quick Plot\";\n          this.finderDiv.style.zIndex = \"2\";\n          this.chartDiv.style.zIndex = \"1\";\n        }\n      }\n      else if (this.isBigQuery == true) {\n        if (this.isActive) {\n          this.plotBtn.textContent = \"Close Quick Plot\";\n          this.chartDiv.style.zIndex = \"2\";\n          this.finderDiv.style.zIndex = \"1\";\n\n          let vizData = new google.visualization.DataTable();\n          if (this.plotX.value === 'timestamp') {\n            vizData.addColumn('datetime', this.plotX.value);\n          } else {\n            vizData.addColumn('number', this.plotX.value);\n          }\n\n          if (this.plotY.value === 'timestamp') {\n            vizData.addColumn('datetime', this.plotY.value);\n          } else {\n            vizData.addColumn('number', this.plotY.value);\n          }\n\n          for (let i = 0; i < this.data[this.plotX.value]. length; i++) {\n            vizData.addRow([this.data[this.plotX.value][i], this.data[this.plotY.value][i]]);\n          }\n          let chart = new google.visualization.LineChart(this.chartDiv);\n          let options = {\n            title: this.plotY.value,\n            width: this.chartDiv.offsetWidth,\n            height: this.chartDiv.offsetHeight,\n            legend: 'none' as 'none',\n            pointSize: 10\n          };\n          chart.draw(vizData, options);\n        } else {\n          this.plotBtn.textContent = \"Quick Plot\";\n          this.finderDiv.style.zIndex = \"2\";\n          this.chartDiv.style.zIndex = \"1\";\n        }\n      }\n    });\n\n    \n  }\n\n  public populateAxisFields(data: any) {\n    this.data = data;\n    this.isBigQuery = false;\n    for (let key of Object.keys(data)) {\n      if (Array.isArray(data[key]) \n        && (key.includes(\"_dates\") || key.toLowerCase().includes('times'))) {\n        let option = document.createElement(\"option\");\n        option.setAttribute(\"class\", \"axis-options\");\n        option.setAttribute(\"value\", key);\n        option.textContent = key;\n        this.plotX.appendChild(option);\n      }\n      else if (Array.isArray(data[key]) \n        && (key.includes(\"_values\")) || key.toLowerCase().includes('values')) {\n        let option = document.createElement(\"option\");\n        option.setAttribute(\"class\", \"axis-options\");\n        option.setAttribute(\"value\", key);\n        option.textContent = key;\n        this.plotY.appendChild(option);\n      }\n    }\n  }\n\n  public bqPopulateAxisFields(dataArr: any, dataset: string) {\n    this.isBigQuery = true;\n    if (dataset === \"eyedata\") {\n      let eyedataObj: any = {};\n      //console.log('bqpopulate axis dataArr', dataArr);\n      dataArr.forEach((data: any) => {\n        // console.log('data in dataArr', data);\n        for (let key of Object.keys(data)) {\n          //console.log('key', key);\n          if (key === \"timestamp\") {\n            try {\n              eyedataObj[key].push(new Date(data[key].value));\n            } catch {\n              eyedataObj[key] = [];\n              eyedataObj[key].push(new Date(data[key].value));\n              this.addAxisOption(key);\n            }\n          } else {\n            try {\n              eyedataObj[key].push(parseFloat(data[key]));\n            } catch {\n              eyedataObj[key] = [];\n              eyedataObj[key].push(parseFloat(data[key]));\n              this.addAxisOption(key);\n            }\n          }\n        }\n      });\n      this.data = eyedataObj;\n    }\n\n  }\n\n  private addAxisOption(key: string) {\n    let optionX = document.createElement('option');\n    optionX.setAttribute('class', 'axis-options');\n    optionX.setAttribute('value', key);\n    optionX.textContent = key;\n    let optionY = document.createElement('option');\n    optionY.setAttribute('class', 'axis-options');\n    optionY.setAttribute('value', key);\n    optionY.textContent = key;\n    this.plotX.appendChild(optionX);\n    this.plotY.appendChild(optionY);\n  }\n\n  public removeElementsByClassName(cName: string) {\n    let elements = document.getElementsByClassName(cName);\n    while (elements.length > 0) {\n      elements[0].parentNode?.removeChild(elements[0]);\n    }\n  }\n}","import firebase from \"firebase/app\";\nimport \"firebase/functions\";\n\nconst functions = firebase.functions();\nconst listTables = functions.httpsCallable('listTables');\nconst bqQuery = functions.httpsCallable('bqQuery');\n\nexport class Mkquery {\n  public rfidMode: boolean;\n  \n  constructor() {\n    this.rfidMode = false;\n\n  };\n  /**\n   * Connects and returns query strings\n   * \n   * @param {{field: string, keyword: string}[]} queryParams\n   * @returns {string} returns a string of connected query strings\n   */\n  public mkquery(queryParams: {field: string, keyword: string}[]) {\n    let queryString: string;\n    \n    queryString = \"\";\n    queryParams.forEach(queryParam => {\n      queryString += this._mkquery(queryParam.field, queryParam.keyword);\n    });\n\n    return queryString;\n  }\n  \n  /**\n   * Generates and returns individual query string for a given field and keyword\n   * \n   * @param {string} field\n   * @param {string} keyword\n   * @returns {string} returns generated query string\n   * @private\n   */\n  private _mkquery(field: string, keyword: string) {\n    if (field.toLowerCase().includes(\"date\")) {\n      const DAY_TO_MS: number = 86400000;\n      let dateStr: string[];\n      let refDate: Date;\n\n      dateStr = keyword.split(\";\");\n      dateStr.length === 2 ? dateStr[1] = dateStr[1].trim() : dateStr[1] = \"\";\n      refDate = new Date(dateStr[0]);\n\n      if (dateStr[1].includes(\"+-\")) {\n        let upperDate: Date;\n        let lowerDate: Date;\n        let range: number;\n        let queryStr: string;\n\n        range = Number(dateStr[1].substring(2, dateStr[1].length));\n        upperDate = new Date(refDate.getTime() + range * DAY_TO_MS);\n        lowerDate = new Date(refDate.getTime() - range * DAY_TO_MS);\n        queryStr = \".where(\" + `\"${field}\"` + \", '>=', \" + \"new Date(\"\n          + String(lowerDate.getTime()) + \")).where(\" + `\"${field}\"`\n          + \", '<=', \" + \"new Date(\" + String(upperDate.getTime()) + \"))\";\n\n        return queryStr;\n      }\n\n      else if (dateStr[1].includes(\"+\") && !dateStr[1].includes(\"-\")) {\n        let upperDate: Date;\n        let range: number;\n        let queryStr: string;\n\n        range = Number(dateStr[1].substring(1, dateStr[1].length));\n        upperDate = new Date(refDate.getTime() + range * DAY_TO_MS);\n        queryStr = \".where(\" + `\"${field}\"` + \", '>=', \" + \"new Date(\"\n          + String(refDate.getTime()) + \")).where(\" + `\"${field}\"`\n          + \", '<=', \" + \"new Date(\" + String(upperDate.getTime()) + \"))\";\n\n        return queryStr;\n      }\n\n      else if (dateStr[1].includes(\"-\") && !dateStr[1].includes(\"+\")) {\n        let lowerDate: Date;\n        let range: number;\n        let queryStr: string;\n\n        range = Number(dateStr[1].substring(1, dateStr[1].length));\n        lowerDate = new Date(refDate.getTime() + range * DAY_TO_MS);\n        queryStr = \".where(\" + `\"${field}\"` + \", '>=', \" + \"new Date(\"\n          + String(lowerDate.getTime()) + \")).where(\" + `\"${field}\"`\n          + \", '<=', \" + \"new Date(\" + String(refDate.getTime()) + \"))\";\n\n        return queryStr;\n      }\n\n      else if ( !(dateStr[1].includes(\"+\") || dateStr[1].includes(\"-\")) ) {\n        let upperDate: Date;\n        let queryStr: string;\n        \n        upperDate = new Date(refDate.getTime() + DAY_TO_MS);\n        queryStr = \".where(\" + `\"${field}\"` + \", '>=', \" + \"new Date(\"\n          + String(refDate.getTime()) + \")).where(\" + `\"${field}\"` + \", '<=', \"\n          + \"new Date(\" + String(upperDate.getTime()) + \"))\";\n\n        return queryStr;\n      }\n    }\n    else {\n      let queryStr: string;\n\n      queryStr = \".where(\" + `\"${field}\"` + \", '==', \" + `\"${keyword}\"` + \")\";\n\n      return queryStr;\n    }\n  }\n\n\n\n  public async decodeQuery(query: firebase.firestore.Query) {\n    async function loadData(doc: any, arr: any[]) {\n      await arr.push(doc.data());\n    }\n\n    let arr = new Array();\n\n    await query.get().then(async querySnapshot => {\n      if (!querySnapshot.empty) {\n        let promises = querySnapshot.docs.map(doc => loadData(doc, arr));\n        await Promise.all(promises);\n      }\n      \n      else {\n        console.log(\"Found No Documents\");\n        alert(\"Found No Documents\");\n      }\n    }).catch(e => {\n      console.error(\"Error getting documents:\", e);\n    });\n\n    return arr;\n  }\n  \n  public mkbquery(dataset: string, agent: string, date: string) {\n    let queryDateLower: string | Date = new Date(date);\n    let queryDateUpper: string | Date = new Date(date);\n    queryDateUpper.setDate(queryDateUpper.getDate() + 1);\n    queryDateLower = queryDateLower.toJSON().split('T')[0];\n    queryDateUpper = queryDateUpper.toJSON().split('T')[0];\n\n    let str = `SELECT *\n              FROM \\`sandbox-ce2c5.${dataset}.${agent}\\`\n              WHERE timestamp BETWEEN '${queryDateLower}' AND '${queryDateUpper}'\n              ORDER BY timestamp ASC`;\n    console.log(\"querystr\", str);\n    return str;\n  }\n\n  public async decodeBigQuery(queryStr: string) {\n    let test = await bqQuery(queryStr);\n    return test;\n  }\n  \n}","import * as math from 'mathjs';\nimport cloneDeep from 'lodash.clonedeep';\nimport isPlainObject from 'lodash/isPlainObject';\nimport isArray from 'lodash/isArray';\n\nexport class ParseEngine {\n\n  constructor() {\n\n  }\n\n  public generateParamObject(obj: any, scheme: string) {\n    \n    let userObj = cloneDeep(obj);\n    console.log(userObj);\n    let totalLen = 1;\n    let minLen = 1;\n    let maxLen = 1;\n    let path = [\n      'CAMERAS', 'LIGHTS',\n      'OBJECTS', 'IMAGES',\n      'durationMS', 'IMAGEFILTERS',\n      'OBJECTFILTERS'\n    ];\n\n    // Parse and generate based on smart text\n    path.forEach((module, index) => {\n      if (isArray(userObj[module]) && userObj[module].length > 0) {\n        userObj[module] = this.parseAndGenerate2(userObj[module]);\n        totalLen *= userObj[module].length;\n        minLen = (userObj[module].length > minLen) ? minLen : userObj[module].length;\n        maxLen = (maxLen > userObj[module].length) ? maxLen : userObj[module].length;\n      } else if (isPlainObject(userObj[module])) {\n        for (let key in userObj[module]) {\n          if (isArray(userObj[module][key]) && userObj[module][key].length > 0) {\n            userObj[module][key] = this.parseAndGenerate2(userObj[module][key]);\n            totalLen *= userObj[module][key].length;\n            minLen = (userObj[module][key].length > minLen) ? minLen : userObj[module][key].length;\n            maxLen = (maxLen > userObj[module][key].length) ? maxLen : userObj[module][key].length;\n          } else if (isPlainObject(userObj[module][key])) {\n            for (let key2 in userObj[module][key]) {\n              if (isArray(userObj[module][key][key2]) && userObj[module][key][key2].length > 0) {\n                userObj[module][key][key2] = this.parseAndGenerate2(userObj[module][key][key2]);\n                totalLen *= userObj[module][key][key2].length;\n                minLen = (userObj[module][key][key2].length > minLen) ? minLen : userObj[module][key][key2].length;\n                maxLen = (maxLen > userObj[module][key][key2].length) ? maxLen : userObj[module][key][key2].length;\n              } else if (isPlainObject(userObj[module][key][key2])) {\n                for (let key3 in userObj[module][key][key2]) {\n                  if (isArray(userObj[module][key][key2][key3]) && userObj[module][key][key2][key3].length > 0) {\n                    userObj[module][key][key2][key3] = this.parseAndGenerate2(userObj[module][key][key2][key3]);\n                    totalLen *= userObj[module][key][key2][key3].length;\n                    minLen = (userObj[module][key][key2][key3].length > minLen) ? minLen : userObj[module][key][key2][key3].length;\n                    maxLen = (maxLen > userObj[module][key][key2][key3].length) ? maxLen : userObj[module][key][key2][key3].length;\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    });\n\n    if (scheme == 'vectorize') {\n      path.forEach((module, index) => {\n        if (isArray(userObj[module]) && userObj[module].length > 1) {\n          let tmp = [];\n          for (let i = 0; i < totalLen; i++) {\n            tmp.push(userObj[module][i % userObj[module].length]);\n          }\n          userObj[module] = tmp;\n        } else if (isPlainObject(userObj[module])) {\n          for (let key in userObj[module]) {\n            if (isArray(userObj[module][key]) && userObj[module][key].length > 1) {\n              let tmp = [];\n              for (let i = 0; i < totalLen; i++) {\n                tmp.push(userObj[module][key][i % userObj[module][key].length]);\n              }\n              userObj[module][key] = tmp;\n            } else if (isPlainObject(userObj[module][key])) {\n              for (let key2 in userObj[module][key]) {\n                if (isArray(userObj[module][key][key2]) && userObj[module][key][key2].length > 1) {\n                  let tmp = [];\n                  for (let i = 0; i < totalLen; i++) {\n                    tmp.push(userObj[module][key][key2][i % userObj[module][key][key2].length]);\n                  }\n                  userObj[module][key][key2] = tmp;\n                } else if (isPlainObject(userObj[module][key][key2])) {\n                  for (let key3 in userObj[module][key][key2]) {\n                    if (isArray(userObj[module][key][key2][key3]) && userObj[module][key][key2][key3].length > 1) {\n                      let tmp = [];\n                      for (let i = 0; i < totalLen; i++) {\n                        tmp.push(userObj[module][key][key2][key3][i % userObj[module][key][key2][key3].length]);\n                      }\n                      userObj[module][key][key2][key3] = tmp;\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      });  \n    } else if (scheme == 'expand') {\n      path.forEach((module, index) => {\n        if (\n          isArray(userObj[module])\n          && userObj[module].length > 1\n          && userObj[module].length != maxLen\n        ) {\n          let err = new Error(`Length Mismatch: ${module}.length=${userObj[module].length} != maxLen=${maxLen}`);\n          alert(err.message);\n          throw err;\n          \n        } else if (isPlainObject(userObj[module])) {\n          for (let key in userObj[module]) {\n            if (\n              isArray(userObj[module][key])\n              && userObj[module][key].length > 1\n              && userObj[module][key].length != maxLen\n            ) {\n              let err = new Error(`Length Mismatch: ${module}[${key}].length=${userObj[module][key].length} != maxLen=${maxLen}`);\n              alert(err.message);\n              throw err;\n            } else if (isPlainObject(userObj[module][key])) {\n              for (let key2 in userObj[module][key]) {\n                if (\n                  isArray(userObj[module][key][key2])\n                  && userObj[module][key][key2].length > 1\n                  && userObj[module][key][key2].length != maxLen\n                ) {\n                  let err = new Error(`Length Mismatch: ${module}[${key}][${key2}].length=${userObj[module][key][key2].length} != maxLen=${maxLen}`);\n                  alert(err.message);\n                  throw err;\n                } else if (isPlainObject(userObj[module][key][key2])) {\n                  for (let key3 in userObj[module][key][key2]) {\n                    if (\n                      isArray(userObj[module][key][key2][key3])\n                      && userObj[module][key][key2][key3].length > 1\n                      && userObj[module][key][key2][key3].length != maxLen\n                    ) {\n                      let err = new Error(`Length Mismatch: ${module}[${key}][${key2}][${key3}].length=${userObj[module][key][key2][key3].length} != maxLen=${maxLen}`);\n                      alert(err.message);\n                      throw err;\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      });\n    }\n\n    console.log('userObj', userObj, 'totalLen:', totalLen);\n    return userObj;\n  }\n\n  private genParamObj(type: string, obj: any) {\n    \n    if (type == 'CAMERAS') {\n      for (let key in obj) {\n        if (obj.hasOwnProperty(key)) {\n          obj[key].position = this.vectorize(obj[key].position, 'cartesianObj');\n          obj[key].targetInches = this.vectorize(obj[key].targetInches, 'cartesianObj');\n          obj[key].visible = this.vectorize(obj[key].visible, 'array');\n        }\n      }\n    } else if (type == 'LIGHTS') {\n      for (let key in obj) {\n        if (obj.hasOwnProperty(key)) {\n          obj[key].position = this.vectorize(obj[key].position, 'cartesianObj');\n          obj[key].intensity = this.vectorize(obj[key].intensity, 'array');\n          obj[key].visible = this.vectorize(obj[key].visible, 'array');\n        }\n      }\n    } else if (type == 'OBJECTS') {\n      for (let key in obj) {\n        if (obj.hasOwnProperty(key)) {\n          obj[key].positionInches = this.vectorize(obj[key].positionInches, 'cartesianObj');\n          obj[key].rotationDegrees = this.vectorize(obj[key].rotationDegrees, 'cartesianObj');\n          obj[key].sizeInches = this.vectorize(obj[key].sizeInches, 'array');\n          obj[key].material.opacity = this.vectorize(obj[key].material.opacity, 'array');\n          obj[key].visible = this.vectorize(obj[key].visible, 'array');\n        }\n      }\n    } else if (type == 'IMAGES') {\n      obj.imageidx = this.vectorize(obj.imageidx, 'array');\n    }\n  }\n\n  private normal(mu: number, sigma: number, n: number) {\n    let u1 = math.random([n]);\n    let u2 = math.random([n]);\n\n    let R_sq = math.multiply(-2, math.log(u1));\n    let theta = math.multiply(2 * math.pi, u2);\n\n    let z1 = math.dotMultiply(math.sqrt(R_sq as math.Matrix), math.cos(theta as math.Matrix));\n    let sample = math.add(mu, math.multiply(z1, sigma));\n\n    return sample;\n  }\n\n  private parseAndGenerate2 (row: any[]) {\n    let sample: any;\n    \n    if (Object.prototype.toString.call(row[0]) === '[object String]') {\n      let recipe = row[0].split('/');\n      if (recipe[0] == 'normal' || recipe[0] == 'n') {\n        console.log('row:', row);\n        console.log('recipe:', recipe);\n        let mu = Number(recipe[1].split(',')[0]);\n        let sigma = Number (recipe[1].split(',')[1]);\n        let n = Number(recipe[2]);\n        sample = this.normal(mu, sigma, n) as number[];\n        console.log(sample);\n      } else if (recipe[0] == 'uniform' || recipe[0] == 'u') {\n        let min = Number(recipe[1].split(',')[0]);\n        let max = Number(recipe[1].split(',')[1]);\n        let size = [Number(recipe[2])];\n        sample = math.random(size, min, max);\n      } else if (recipe[0] == 'range' || recipe[0] == 'r') {\n        let start = Number(recipe[1].split(',')[0]);\n        let end = Number(recipe[1].split(',')[1]);\n        let step = Number(recipe[2]);\n        let range = math.range(start, end, step);\n        sample = [];\n        range.forEach(value => {\n          sample.push(Number(parseFloat(value).toPrecision(4)));\n        });\n      } else if (recipe[0] == 'linspace' || recipe[0] == 'l') {\n        let start = Number(recipe[1].split(',')[0]);\n        let end = Number(recipe[1].split(',')[1]);\n        let num = Number(recipe[2]);\n        let step = (end - start) / (num - 1);\n        let linspace = math.range(start, end, step, true);\n        sample = [];\n        linspace.forEach(value => {\n          sample.push(Number(parseFloat(value).toPrecision(4)));\n        });\n      } else if (recipe[0] == 'movie' || recipe[0] == 'm') {\n        let list = recipe[1].split(',');\n        let tmp: any[] = [];\n        list.forEach((value: string) => {\n          tmp.push(Number(parseFloat(value).toPrecision(4)));\n        });\n        sample = [];\n        sample.push(tmp);\n      } else {\n        let list = recipe[0].split(',');\n        sample = [];\n        list.forEach((value: string) => {\n          sample.push(Number(parseFloat(value).toPrecision(4)));\n        });\n      }\n    } else {\n      return row;\n    }\n    // else {\n    //   if (isNaN(row[0]) == false) {\n    //     console.log('single number', row);\n    //     sample = [];\n    //     sample.push(row);\n    //   }\n    // }\n\n    return sample;\n  }\n\n  private parseAndGenerate(row: any) {\n    let sample: any;\n    if (Object.prototype.toString.call(row) === '[object String]') {\n      let recipe = row.split('/');\n      if (recipe[0] == 'normal' || recipe[0] == 'n') {\n        console.log('row:', row);\n        let mu = Number(recipe[1].split(',')[0]);\n        let sigma = Number (recipe[1].split(',')[1]);\n        let n = Number(recipe[2]);\n        sample = this.normal(mu, sigma, n) as number[];\n      } else if (recipe[0] == 'uniform' || recipe[0] == 'u') {\n        let min = Number(recipe[1].split(',')[0]);\n        let max = Number(recipe[1].split(',')[1]);\n        let size = [Number(recipe[2])];\n        sample = math.random(size, min, max);\n      } else if (recipe[0] == 'range' || recipe[0] == 'r') {\n        let start = Number(recipe[1].split(',')[0]);\n        let end = Number(recipe[1].split(',')[1]);\n        let step = Number(recipe[2]);\n        let range = math.range(start, end, step);\n        sample = [];\n        range.forEach(value => {\n          sample.push(Number(parseFloat(value).toPrecision(4)));\n        });\n      } else if (recipe[0] == 'linspace' || recipe[0] == 'l') {\n        let start = Number(recipe[1].split(',')[0]);\n        let end = Number(recipe[1].split(',')[1]);\n        let num = Number(recipe[2]);\n        let step = (end - start) / (num - 1);\n        let linspace = math.range(start, end, step, true);\n        sample = [];\n        linspace.forEach(value => {\n          sample.push(Number(parseFloat(value).toPrecision(4)));\n        });\n      } else if (recipe[0] == 'movie' || recipe[0] == 'm') {\n        let list = recipe[1].split(',');\n        let tmp: any[] = [];\n        list.forEach((value: string) => {\n          tmp.push(Number(parseFloat(value).toPrecision(4)));\n        });\n        sample = [];\n        sample.push(tmp);\n      } else {\n        let list = recipe[0].split(',');\n        sample = [];\n        list.forEach((value: string) => {\n          sample.push(Number(parseFloat(value).toPrecision(4)));\n        });\n      }\n    } else {\n      if (isNaN(row) == false) {\n        console.log('single number', row);\n        sample = [];\n        sample.push(row);\n      }\n    }\n\n    return sample;\n  }\n\n  private vectorize(obj: any, type: string) {\n    let tmp: any;\n    if (type == 'array') {\n      tmp = [];\n      obj.forEach((row: any) => {\n        tmp.push(...this.parseAndGenerate(row));\n      });\n    } else if (type == 'cartesianObj') {\n      \n      tmp = {x: [], y: [], z: []};\n\n      let tmp2: any = {x: [], y: [], z: []};\n\n      for (let axis in obj) {\n        if (obj.hasOwnProperty(axis)) {\n          obj[axis].forEach((row: any) => {\n            tmp2[axis].push(...this.parseAndGenerate(row));\n          });\n        }\n      }\n\n      if (!(tmp2.x.length == tmp2.y.length && tmp2.y.length == tmp2.z.length)) {\n        tmp2.x.forEach((x: number) => {\n          tmp2.y.forEach((y: number) => {\n            tmp2.z.forEach((z: number) => {\n              tmp.x.push(x);\n              tmp.y.push(y);\n              tmp.z.push(z);\n            });\n          });\n        });\n      } else {\n        tmp.x = tmp2.x;\n        tmp.y = tmp2.y;\n        tmp.z = tmp2.z;\n      }\n    }\n    return tmp;\n  }\n}\n\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tresult = fn();\n\t\t}\n\t}\n\treturn result;\n};","__webpack_require__.amdD = function () {\n\tthrow new Error('define cannot be used indirect');\n};","__webpack_require__.amdO = {};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t179: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tfor(moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkIds[i]] = 0;\n\t}\n\t__webpack_require__.O();\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkmkturk\"] = self[\"webpackChunkmkturk\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [990], () => (__webpack_require__(48519)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"sourceRoot":""}